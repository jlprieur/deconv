%!PS-Adobe-2.0
%%Creator: dvips 5.47 Copyright 1986-91 Radical Eye Software
%%Pages: 24 1
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Helvetica-Bold Times-Roman Helvetica-Oblique Times-Italic
%%+ Courier-BoldOblique
%%EndComments
%%BeginProcSet: tex.pro
/TeXDict 200 dict def TeXDict begin /N /def load def /B{bind def}N /S /exch
load def /X{S N}B /TR /translate load N /isls false N /vsize 10 N /@rigin{
isls{[0 1 -1 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
Resolution VResolution vsize neg mul TR matrix currentmatrix dup dup 4 get
round 4 exch put dup dup 5 get round 5 exch put setmatrix}N /@letter{/vsize 10
N}B /@landscape{/isls true N /vsize -1 N}B /@a4{/vsize 10.6929133858 N}B /@a3{
/vsize 15.5531 N}B /@ledger{/vsize 16 N}B /@legal{/vsize 13 N}B /@manualfeed{
statusdict /manualfeed true put}B /@copies{/#copies X}B /FMat[1 0 0 -1 0 0]N
/FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{/nn 8 dict N nn begin
/FontType 3 N /FontMatrix fntrx N /FontBBox FBB N string /base X array
/BitMaps X /BuildChar{CharBuilder}N /Encoding IE N end dup{/foo setfont}2
array copy cvx N load 0 nn put /ctr 0 N[}B /df{/sf 1 N /fntrx FMat N df-tail}
B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]N df-tail}B /E{pop nn dup definefont
setfont}B /ch-width{ch-data dup length 5 sub get}B /ch-height{ch-data dup
length 4 sub get}B /ch-xoff{128 ch-data dup length 3 sub get sub}B /ch-yoff{
ch-data dup length 2 sub get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B
/ch-image{ch-data dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0
N /rw 0 N /rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S
dup /base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx 0
ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff setcachedevice
ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff .1 add]{ch-image}
imagemask restore}B /D{/cc X dup type /stringtype ne{]}if nn /base get cc ctr
put nn /BitMaps get S ctr S sf 1 ne{dup dup length 1 sub dup 2 index S get sf
div put}if put /ctr ctr 1 add N}B /I{cc 1 add D}B /bop{userdict /bop-hook
known{bop-hook}if /SI save N @rigin 0 0 moveto}N /eop{clear SI restore
showpage userdict /eop-hook known{eop-hook}if}N /@start{userdict /start-hook
known{start-hook}if /VResolution X /Resolution X 1000 div /DVImag X /IE 256
array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for}N /p /show load N
/RMat[1 0 0 -1 0 0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X
/rulex X V}B /V statusdict begin /product where{pop product dup length 7 ge{0
7 getinterval(Display)eq}{pop false}ifelse}{false}ifelse end{{gsave TR -.1 -.1
TR 1 1 scale rulex ruley false RMat{BDot}imagemask grestore}}{{gsave TR -.1
-.1 TR rulex ruley scale 1 1 false RMat{BDot}imagemask grestore}}ifelse B /a{
moveto}B /delta 0 N /tail{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{
S p tail}B /c{-4 M}B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B
/j{3 M}B /k{4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w
}B /q{p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{clear SS restore}B end
%%EndProcSet
%%BeginProcSet: texps.pro
TeXDict begin /rf{655360 div mul Resolution mul 7227 div /PixPerEm X findfont
dup length 1 add dict /nn X{1 index /FID ne{nn 3 1 roll put}{pop pop}ifelse}
forall 256 dict begin nn /Encoding get 0 1 255{2 copy get 3 index 2 index get
1000 mul PixPerEm div def pop}for pop pop nn /Metrics currentdict put end
/fontname X /nn dup nn definefont[PixPerEm 0 0 PixPerEm neg 0 0]makefont N
fontname{/foo setfont}2 array copy cvx N fontname load 0 nn put}N
/ObliqueSlant{dup sin S cos div neg}B
/SlantFont{/foo X[1 0 foo 1 0 0] TransFont}N
/ExtendFont{/foo X 3 2 roll[S{foo div}forall]3 1 roll[foo 0 0 1 0 0]
TransFont}N
/ExpandFont{/foo X 3 2 roll[S{foo div}forall]3 1 roll[foo 0 0 foo 0 0]
TransFont}N
/TransFont{S findfont S makefont dup length dict /nn X{1 index
/FID ne{nn 3 1 roll put}{pop pop}ifelse}forall dup nn definefont pop}N end
%%EndProcSet
%%BeginProcSet: special.pro
TeXDict begin /SDict 200 dict N SDict begin /@SpecialDefaults{/hs 612 N /vs
792 N /ho 0 N /vo 0 N /hsc 1 N /vsc 1 N /ang 0 N /CLIP false N /BBcalc false N
/p 3 def}B /@scaleunit 100 N /@hscale{@scaleunit div /hsc X}B /@vscale{
@scaleunit div /vsc X}B /@hsize{/hs X /CLIP true N}B /@vsize{/vs X /CLIP true
N}B /@hoffset{/ho X}B /@voffset{/vo X}B /@angle{/ang X}B /@rwi{10 div /rwi X}
B /@llx{/llx X}B /@lly{/lly X}B /@urx{/urx X}B /@ury{/ury X /BBcalc true N}B
/magscale true def end /@MacSetUp{userdict /md known{userdict /md get type
/dicttype eq{md begin /letter{}N /note{}N /legal{}N /od{txpose 1 0 mtx
defaultmatrix dtransform S atan/pa X newpath clippath mark{transform{
itransform moveto}}{transform{itransform lineto}}{6 -2 roll transform 6 -2
roll transform 6 -2 roll transform{itransform 6 2 roll itransform 6 2 roll
itransform 6 2 roll curveto}}{{closepath}}pathforall newpath counttomark array
astore /gc xdf pop ct 39 0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{
PaintBlack}if}N /txpose{pxs pys scale ppr aload pop por{noflips{pop S neg S TR
pop 1 -1 scale}if xflip yflip and{pop S neg S TR 180 rotate 1 -1 scale ppr 3
get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip yflip
not and{pop S neg S TR pop 180 rotate ppr 3 get ppr 1 get neg sub neg 0 TR}if
yflip xflip not and{ppr 1 get neg ppr 0 get neg TR}if}{noflips{TR pop pop 270
rotate 1 -1 scale}if xflip yflip and{TR pop pop 90 rotate 1 -1 scale ppr 3 get
ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip yflip not
and{TR pop pop 90 rotate ppr 3 get ppr 1 get neg sub neg 0 TR}if yflip xflip
not and{TR pop pop 270 rotate ppr 2 get ppr 0 get neg sub neg 0 S TR}if}
ifelse scaleby96{ppr aload pop 4 -1 roll add 2 div 3 1 roll add 2 div 2 copy
TR .96 dup scale neg S neg S TR}if}N /cp{pop pop showpage pm restore}N end}if}
if}N /normalscale{Resolution 72 div VResolution 72 div neg scale magscale{
DVImag dup scale}if}N /psfts{S 65536 div N}N /startTexFig{/psf$SavedState save
N userdict maxlength dict begin /magscale false def normalscale currentpoint
TR /psf$ury psfts /psf$urx psfts /psf$lly psfts /psf$llx psfts /psf$y psfts
/psf$x psfts currentpoint /psf$cy X /psf$cx X /psf$sx psf$x psf$urx psf$llx
sub div N /psf$sy psf$y psf$ury psf$lly sub div N psf$sx psf$sy scale psf$cx
psf$sx div psf$llx sub psf$cy psf$sy div psf$ury sub TR /showpage{}N
/erasepage{}N /copypage{}N /p 3 def @MacSetUp}N /doclip{psf$llx psf$lly
psf$urx psf$ury currentpoint 6 2 roll newpath 4 copy 4 2 roll moveto 6 -1 roll
S lineto S lineto S lineto closepath clip newpath moveto}N /endTexFig{end
psf$SavedState restore}N /@beginspecial{SDict begin /SpecialSave save N gsave
normalscale currentpoint TR @SpecialDefaults}N /@setspecial{CLIP{newpath 0 0
moveto hs 0 rlineto 0 vs rlineto hs neg 0 rlineto closepath clip}if ho vo TR
hsc vsc scale ang rotate BBcalc{rwi urx llx sub div dup scale llx neg lly neg
TR}if /showpage{}N /erasepage{}N /copypage{}N newpath}N /@endspecial{grestore
clear SpecialSave restore end}N /@defspecial{SDict begin}N /@fedspecial{end}B
/li{lineto}B /rl{rlineto}B /rc{rcurveto}B /np{/SaveX currentpoint /SaveY X N 1
setlinecap newpath}N /st{stroke SaveX SaveY moveto}N /fil{fill SaveX SaveY
moveto}N /ellipse{/endangle X /startangle X /yrad X /xrad X /savematrix matrix
currentmatrix N TR xrad yrad scale 0 0 1 startangle endangle arc savematrix
setmatrix}N end
%%EndProcSet
TeXDict begin 1000 300 300 @start /Fa [ 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 8 11 14 17 17 28
26 11 11 11 17 22 8 11 8 9 17 17 17 17 17 17 17 17 17 17 11
11 22 22 22 17 31 20 20 22 24 20 20 24 24 11 15 22 18 28 22
24 20 24 20 17 18 24 20 28 20 18 18 13 9 13 14 17 11 17 17
15 17 15 9 17 17 9 9 15 9 24 17 17 17 17 13 13 9 17 15 22 15
15 13 13 9 13 18 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 13 17 17 6 17 17 17 17 7 18 17 11
11 17 17 0 17 17 17 8 0 17 12 11 18 18 17 30 33 0 17 0 11 11
11 11 11 11 11 11 0 11 11 0 11 11 11 30 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 30 0 9 0 0 0 0 18 24 31 10 0 0 0 0 0 22 0 0 0 9
0 0 9 17 22 17 0 0 0 0 ] /Times-Italic 1000 524288 rf /Fb 1
106 df<040C0000000000705898983030606464683006127E910B>105 D
E /Fc [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20
20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20
20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20
20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20
20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 20 20 20 20 20 20 20 20 20 20 20 20 20 0 0 0 20 20 20
20 0 20 20 20 20 20 20 20 0 0 20 0 20 20 20 20 20 20 20 20
0 20 20 0 20 20 20 20 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 20
0 0 0 0 20 20 0 20 0 0 0 0 0 0 0 0 0 20 0 0 20 20 0 20 0 0
0 0 ] /Courier-BoldOblique 1000 524288 rf /Fd 1 121 df<1F00308070406060E0E0E0
E0E040E00060007000300018001C003300718061C0E0C0E0E0E0E0E0E060E070C031C019800700
0300018001C000C000E040E0E0E0E0E0C0C041C021801F000B257D9C12>120
D E /Fe [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 10 14 17 21 21 35 32 14 14 14 21 28 10 14 10
12 21 21 21 21 21 21 21 21 21 21 14 14 28 28 28 21 38 25 25
28 30 25 25 30 30 14 18 28 23 35 28 30 25 30 25 21 23 30 25
35 25 23 23 16 12 16 18 21 14 21 21 18 21 18 12 21 21 12 12
18 12 30 21 21 21 21 16 16 12 21 18 28 18 18 16 17 11 17 22
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 16 21 21 7 21 21 21 21 9 23 21 14 14 21 21 0 21 21
21 10 0 22 15 14 23 23 21 37 42 0 21 0 14 14 14 14 14 14 14
14 0 14 14 0 14 14 14 37 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 37
0 11 0 0 0 0 23 30 39 13 0 0 0 0 0 28 0 0 0 12 0 0 12 21 28
21 0 0 0 0 ] /Times-Italic 1000 655360 rf /Ff 2 3 df<FFFFF0FFFFF014027D881B>0
D<C003E007700E381C18381C300E7007E003C003C007E00E701C301838381C700EE007C0031012
7B901B>2 D E /Fg 7 62 df<001800001800003C00003C00004E00004E000087000087000103
800303C00201C00601E00400E00C00F008007010007810003820003C20001C40001E7FFFFEFFFF
FFFFFFFF18177E961D>1 D<0102040C1818303070606060E0E0E0E0E0E0E0E0E0E06060607030
3018180C04020108227D980E>40 D<8040203018180C0C0E060606070707070707070707070606
060E0C0C18183020408008227E980E>I<00300000300000300000300000300000300000300000
3000003000003000003000FFFFFCFFFFFC00300000300000300000300000300000300000300000
300000300000300000300016187E931B>43 D<03000700FF000700070007000700070007000700
07000700070007000700070007000700070007007FF00C157E9412>49 D<0F8030E040708030C0
38E0384038003800700070006000C00180030006000C08080810183FF07FF0FFF00D157E9412>
I<FFFFFCFFFFFC000000000000000000000000000000000000FFFFFCFFFFFC160A7E8C1B>61
D E /Fh 1 64 df<002000002000002000002000002000002000007000C070187C71F00FFF8003
FE0000F80000F80001DC00018C000306000202000603000C01800800801514809315>63
D E /Fi 34 122 df<01800380038007800F807F80FF8073800380038003800380038003800380
03800380038003800380038003807FF87FFC7FF80E197C9816>49 D<00E00001F00001F00001B0
0001B00003B80003B80003B800031800071C00071C00071C00071C00071C000E0E000E0E000FFE
000FFE001FFF001C07001C07001C07007F1FC0FF1FE07F1FC013197F9816>65
D<01F18007FF800FFF801F0F803C0780780780780380700380F00000E00000E00000E00000E000
00E00000E00000E00000F000007003807803807803803C07801F0F000FFE0007FC0001F0001119
7E9816>67 D<7FFFC0FFFFC07FFFC01C01C01C01C01C01C01C01C01C00001C00001C1C001C1C00
1FFC001FFC001FFC001C1C001C1C001C00001C00E01C00E01C00E01C00E01C00E07FFFE0FFFFE0
7FFFE013197F9816>69 D<FFFEFFFEFFFE03800380038003800380038003800380038003800380
03800380038003800380038003800380FFFEFFFEFFFE0F197D9816>73 D<7E1FC0FF3FE07F1FC0
1D07001D87001D87001D87001DC7001DC7001CC7001CC7001CE7001CE7001CE7001C67001C6700
1C77001C77001C37001C37001C37001C17007F1F00FF9F007F0F0013197F9816>78
D<1FFC003FFE007FFF00780F00F00780E00380E00380E00380E00380E00380E00380E00380E003
80E00380E00380E00380E00380E00380E00380F00780F00780780F007FFF003FFE001FFC001119
7E9816>I<07E3001FFF007FFF00781F00F00F00E00700E00700E00000F000007800007F80001F
F00007FC0000FE00000F00000780000380000380E00380E00380F00780F80F00FFFE00FFFC00C7
F00011197E9816>83 D<7FFFE0FFFFE0FFFFE0E0E0E0E0E0E0E0E0E0E0E0E000E00000E00000E0
0000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00007FC
000FFE0007FC0013197F9816>I<7F07F0FF8FF87F07F01C01C01C01C01C01C01C01C01C01C01C
01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C00E03800E038007
070007FF0003FE0000F8001519809816>I<1FE0007FF8007FFC00783C00301E00000E00000E00
03FE001FFE007E0E00F00E00E00E00E00E00F01E00F83E007FFFE03FE7E00F83E013127E9116>
97 D<7E0000FE00007E00000E00000E00000E00000E00000E3E000EFF800FFFC00F83E00F01E0
0E00F00E00F00E00700E00700E00700E00700E00F00F00E00F01E00F83C00FFFC00EFF00063C00
1419809816>I<03F80FFE1FFE3C1E780C7000F000E000E000E000E000F000700778073E0F1FFE
0FFC03F010127D9116>I<003F00007F00003F0000070000070000070000070003C7000FF7003F
FF003C1F00780F00F00700F00700E00700E00700E00700E00700F00700F00F00781F007C3F003F
FFE01FF7F007C7E014197F9816>I<03E00FF81FFC3C1E780E7007E007FFFFFFFFFFFFE000E000
700778073C0F1FFE0FFC03F010127D9116>I<001F00007F8000FF8001E78001C30001C00001C0
007FFF00FFFF00FFFF0001C00001C00001C00001C00001C00001C00001C00001C00001C00001C0
0001C00001C0003FFE007FFF003FFE0011197F9816>I<03E3C00FFFE01FFFE01E3CC03C1E0038
0E00380E00380E003C1E001E3C001FFC001FF8003BE0003800003800001FFC001FFF003FFFC078
03C0F001E0E000E0E000E0E000E0F001E07C07C03FFF800FFE0003F800131C7F9116>I<7E0000
FE00007E00000E00000E00000E00000E00000E3C000EFF000FFF800F87800F03800F03800E0380
0E03800E03800E03800E03800E03800E03800E03800E03807FC7F0FFE7F87FC7F01519809816>
I<018003C003C0018000000000000000007FC07FC07FC001C001C001C001C001C001C001C001C0
01C001C001C001C07FFFFFFF7FFF101A7D9916>I<003000780078003000000000000000001FF8
1FF81FF80038003800380038003800380038003800380038003800380038003800380038003800
3800386070F0F0FFE07FC03F800D237E9916>I<7E0000FE00007E00000E00000E00000E00000E
00000E7FE00E7FE00E7FE00E0F000E1E000E3C000E78000EF0000FF0000FF8000FBC000F1E000E
0E000E07000E07807F87F0FFCFF07F87F01419809816>I<FFC000FFC000FFC00001C00001C000
01C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C000
01C00001C00001C00001C000FFFF80FFFF80FFFF8011197E9816>I<F9C380FFEFC0FFFFE03E7C
E03C78E03870E03870E03870E03870E03870E03870E03870E03870E03870E03870E0FE7CF8FE7C
F8FE3C781512809116>I<7E3C00FEFF007FFF800F87800F03800F03800E03800E03800E03800E
03800E03800E03800E03800E03800E03807FC7F0FFE7F87FC7F01512809116>I<03E0000FF800
1FFC003C1E00780F00700700E00380E00380E00380E00380E00380F00780700700780F003C1E00
1FFC000FF80003E00011127E9116>I<7E3E00FEFF807FFFC00F83E00F01E00E00F00E00F00E00
700E00700E00700E00700E00F00F00E00F01E00F83C00FFFC00EFF000E3C000E00000E00000E00
000E00000E00000E00007FC000FFE0007FC000141B809116>I<FF0FC0FF3FE0FF7FE007F04007
E00007C000078000078000070000070000070000070000070000070000070000FFFC00FFFC00FF
FC0013127F9116>114 D<0FEC3FFC7FFCF03CE01CE01CF0007F801FF007FC003EE00EE00EF00E
F81EFFFCFFF8C7E00F127D9116>I<0300000700000700000700000700007FFF00FFFF00FFFF00
07000007000007000007000007000007000007000007010007038007038007078007878003FF00
03FE0000F80011177F9616>I<7E1F80FE3F807E1F800E03800E03800E03800E03800E03800E03
800E03800E03800E03800E03800E07800F0F800FFFF007FFF803E3F01512809116>I<7F1FC0FF
1FE07F1FC01C07001E0F000E0E000E0E000E0E00071C00071C00071C00071C0003B80003B80003
B80001F00001F00000E00013127F9116>I<FF1FE0FFBFE0FF1FE0380380380380380380380380
38E38019F30019F30019B3001DB7001DB7001DB7001DB7000F1E000F1E000F1E0013127F9116>
I<7F1FC07F3FC07F1FC00F1C00073C0003B80003F00001F00000E00001E00001F00003B800073C
00071C000E0E007F1FC0FF3FE07F1FC013127F9116>I<7F1FC0FF9FE07F1FC01C07000E07000E
0E000E0E00070E00071C00071C00039C00039C0003980001B80001B80000F00000F00000F00000
E00000E00000E00001C00079C0007BC0007F80003F00003C0000131B7F9116>I
E /Fj [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 10 10 13 21 21 33 25 8 12 12 15 22 10 12 10 10
21 21 21 21 21 21 21 21 21 21 10 10 22 22 22 21 38 25 25 27
27 25 23 29 27 10 19 25 21 31 27 29 25 29 27 25 23 27 25 35
25 25 23 10 10 10 18 21 8 21 21 19 21 21 10 21 21 8 8 19 8
31 21 21 21 21 12 19 10 21 19 27 19 19 19 12 10 12 22 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 12 21 21 6 21 21 21 21 7 12 21 12 12 19 19 0 21 21 21 10
0 20 13 8 12 12 21 37 37 0 23 0 12 12 12 12 12 12 12 12 0 12
12 0 12 12 12 37 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 37 0 14 0
0 0 0 21 29 37 14 0 0 0 0 0 33 0 0 0 10 0 0 8 23 35 23 0 0
0 0 ] /Helvetica-Oblique 1000 589824 rf /Fk [ 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 10 14 17
21 21 35 32 14 14 14 21 23 10 14 10 12 21 21 21 21 21 21 21
21 21 21 12 12 23 23 23 18 38 30 28 28 30 25 23 30 30 14 16
30 25 37 30 30 23 30 28 23 25 30 30 39 30 30 25 14 12 14 19
21 14 18 21 18 21 18 14 21 21 12 12 21 12 32 21 21 21 21 14
16 12 21 21 30 21 21 18 20 8 20 22 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 14 21 21 7 21 21
21 21 7 18 21 14 14 23 23 0 21 21 21 10 0 19 15 14 18 18 21
42 42 0 18 0 14 14 14 14 14 14 14 14 0 14 14 0 14 14 14 42
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 37 0 11 0 0 0 0 25 30 37 13
0 0 0 0 0 28 0 0 0 12 0 0 12 21 30 21 0 0 0 0 ] /Times-Roman
1000 655360 rf /Fl 9 121 df<60F0F06004047D830A>58 D<60F0F070101020204040040A7D
830A>I<07F0000FE000F0001E0000B8001E0000B8002E0000B8004E000138005C000138009C00
0138011C00011C011C00021C023800021C043800021C043800021C083800041C107000040E1070
00040E207000040E407000080E40E000080E80E000080F00E000080700E000180601C000FE040F
F80023177F9622>77 D<07F007F800F000C000B8008000B80080009C0080011C0100011E010001
0E0100010E0100020702000207020002038200020382000401C4000401C4000400E4000400E400
0800780008007800080038000800380018001000FE0010001D177F961C>I<071018F030706070
6060C060C060C06080C080C480C4C1C446C838700F0E7E8D13>97 D<7C00180018001800180030
00300030003000678068C070406060C060C060C060C06080C080C08180C10046003C000C177E96
0F>I<07C00C20107020706000C000C000C00080008000C010C02060C03F000C0E7E8D0F>I<1C02
00260600460600460600860C000C0C000C0C000C0C001818001818801818801838800C5900078E
00110E7F8D14>117 D<0F1F0011A18020C38020C3004180000180000180000180000300000302
00C30200E70400C5080078F000110E7F8D14>120 D E /Fm 50 123 df<00C003C007800F001E
001C003800780070007000F000E000E000E000E000E000E000E000F00070007000780038001C00
1E000F00078003C000C00A1D7A9914>40 D<C000F00078003C001E000E00070007800380038003
C001C001C001C001C001C001C001C003C003800380078007000E001E003C007800F000C0000A1D
7D9914>I<FFFEFFFEFFFE0F037E8C14>45 D<70F8F8F8700505798414>I<0006000E000E001C00
1C003800380070007000E000E001C001C0038003800380070007000E000E001C001C0038003800
70007000E000E000C0000F1D7E9914>I<07C00FE01C7038383018701C701CE00EE00EE00EE00E
E00EE00EE00EE00EE00E701C701C383838381C700FE007C00F177E9614>I<0300070007000F00
3F00F700470007000700070007000700070007000700070007000700070007000700FFF0FFF00C
177C9614>I<0FC03FF07838701CE01EE00EE00E400E000E001E001C003C007800F001E003C007
800F001E003C0E700EFFFEFFFE0F177E9614>I<0FC03FF07878703C701C201C001C003C003800
7807E007F00038001C001E000E400EE00EE01EF01C78383FF00FC00F177E9614>I<00780000F8
0001B80001B8000338000338000638000E38000C38001C3800383800303800703800E03800FFFF
80FFFF8000380000380000380000380000380003FF8003FF8011177F9614>I<7FFC7FFC700070
007000700070007000700077C07FF07838701C001E000E000EE00EE00EE01EF03C78783FF00FC0
0F177E9614>I<01F007F80E1C1C1C381C78007000F000E000E7C0FFF0FC38F01CF01EE00EF00E
F00E700E701E381C3C381FF007C00F177E9614>I<000E003E007C00F003E007C01F003E00F800
F000F8003E001F0007C003E000F0007C003E000E0F137E9414>60 D<FFFF80FFFF807FFF800000
000000000000007FFF80FFFF80FFFF8011097F8F14>I<4000E000F8007C001E000F8007C001F0
00F8003E001E003E00F801F007C00F801E007C00F800E00040000F157E9514>I<01C00003E000
03E0000360000360000770000770000770000770000630000E38000E38000E38000E38000E3800
1FFC001FFC001C1C001C1C003C1E00380E00FE3F80FE3F8011177F9614>65
D<FFE000FFF800383C00381E00380E003807003807003807003803803803803803803803803803
80380380380380380380380700380700380E00381E00383C00FFF800FFE00011177F9614>68
D<FFFF80FFFF801C03801C03801C03801C03801C00001C00001C38001C38001FF8001FF8001C38
001C38001C00001C00001C00001C01C01C01C01C01C01C01C0FFFFC0FFFFC01217809614>I<03
C6000FFE001C3E003C1E00381E00700E00700E00F00E00E00000E00000E00000E00000E07F80E0
7F80E00E00F00E00700E00701E00381E003C1E001C3E000FFE0003CE0011177F9614>71
D<FFFEFFFE03800380038003800380038003800380038003800380038003800380038003800380
03800380FFFEFFFE0F177E9614>73 D<FFC000FFC0001C00001C00001C00001C00001C00001C00
001C00001C00001C00001C00001C00001C00001C00001C00001C00001C03801C03801C03801C03
80FFFF80FFFF8011177F9614>76 D<FE0FE0FE0FE03E0F803B1B803B1B803B1B803B1B803BBB80
3BBB8039B38039B38039B38039F38038E38038E380380380380380380380380380380380380380
FE0FE0FE0FE01317809614>I<1FF07FFC783C701CE00EE00EE00EE00EE00EE00EE00EE00EE00E
E00EE00EE00EE00EE00EE00E701C783C7FFC1FF00F177E9614>79 D<FFF800FFFE001C0F001C07
001C03801C03801C03801C03801C03801C07001C0F001FFE001FF8001C00001C00001C00001C00
001C00001C00001C00001C0000FF8000FF80001117809614>I<0FCC3FFC787CF03CE03CE01CE0
1CF000F0007E003FE00FF801FC003C001E000EE00EE00EE00EF01CF83CFFF8C7E00F177E9614>
83 D<FFFF80FFFF80E1C380E1C380E1C380E1C38001C00001C00001C00001C00001C00001C000
01C00001C00001C00001C00001C00001C00001C00001C00001C0000FF8000FF80011177F9614>
I<FE7F00FE7F001C38001E38000E78000F700007F00007E00003E00003C00001C00003C00003E0
0003E0000770000770000E78000E38001C3C001C1C003C1E00FE3F80FE3F8011177F9614>88
D<1FC0007FF000707800203C00001C00001C0007FC001FFC007C1C00F01C00E01C00E01C00E01C
00707C003FFF800F8F8011107E8F14>97 D<FC0000FC00001C00001C00001C00001C00001C0000
1CF8001FFE001F0F001E07801C03801C03C01C01C01C01C01C01C01C01C01C03C01E03801E0780
1F0F001FFE001CF8001217809614>I<03F80FFC3C1C78087000F000E000E000E000E000F00070
00780E3C1E0FFC03F00F107E8F14>I<007E00007E00000E00000E00000E00000E00000E0007CE
001FFE003C3E00781E00700E00F00E00E00E00E00E00E00E00E00E00F00E00701E00781E003C3E
001FFFC007CFC012177F9614>I<07E01FF83C3C781C701EF00EE00EFFFEFFFEE000F000700078
0E3C1E0FFC03F00F107E8F14>I<007C01FE03CE0384038003800380FFFEFFFE03800380038003
80038003800380038003800380038003807FFC7FFC0F177F9614>I<07CF001FFF803C7B80783C
00701C00701C00701C00783C003C78003FF00077C0007000007000003FF8003FFE003FFF00700F
80F00780E00380E00380E003807007007C1F001FFC0007F00011197F8F14>I<FC0000FC00001C
00001C00001C00001C00001C00001C78001DFE001F8F001E07001E07001C07001C07001C07001C
07001C07001C07001C07001C07001C0700FF9FE0FF9FE01317809614>I<030007800780030000
00000000000000FF80FF80038003800380038003800380038003800380038003800380FFFEFFFE
0F187D9714>I<FC0000FC00001C00001C00001C00001C00001C00001DFF801DFF801C3C001C78
001CF0001DE0001FC0001FE0001FE0001EF0001C70001C78001C3C001C1C00FF3F80FF3F801117
7F9614>107 D<FF80FF8003800380038003800380038003800380038003800380038003800380
03800380038003800380FFFEFFFE0F177E9614>I<FB8E00FFFF803EFB803CF38038E38038E380
38E38038E38038E38038E38038E38038E38038E38038E380FEFBE0FEFBE01310808F14>I<FC78
00FDFE001F8F001E07001E07001C07001C07001C07001C07001C07001C07001C07001C07001C07
00FF9FE0FF9FE01310808F14>I<07C01FF03C78701C701CE00EE00EE00EE00EE00EE00E701C78
3C3C781FF007C00F107E8F14>I<FCF800FFFE001F0F001E07801C03801C03C01C01C01C01C01C
01C01C01C01C03C01E03801E07801F0F001FFE001CF8001C00001C00001C00001C00001C00001C
0000FF8000FF80001218808F14>I<FF0F80FF3FC007F1C007C08007C000078000070000070000
070000070000070000070000070000070000FFFC00FFFC001210808F14>114
D<0FD87FF8E078C038C038F0007F803FF007FC001EE00EE006F006F81CFFF8CFE00F107E8F14>
I<07000700070007000700FFFCFFFC07000700070007000700070007000700070E070E070E079E
03FC00F00F157F9414>I<FC3F00FC3F001C07001C07001C07001C07001C07001C07001C07001C
07001C07001C07001C0F001E1F000FFFE003E7E01310808F14>I<FF7F80FF7F801C1C001C1C00
1C1C001C1C000E38000E38000E380006300007700007700007700003E00003E00003E00011107F
8F14>I<FE7F80FE7F801E38000E780007700007E00003E00001C00003C00003E0000770000E78
000E38001C1C00FF7F80FF7F8011107F8F14>120 D<FF3F80FF3F801C1C001C1C001C1C000E1C
000E38000E380007380007300007300003700003700001E00001E00001E00001C00001C00001C0
000380007380007700007E00003C000011187F8F14>I<7FFF7FFF700E701C7038007000E001C0
038007000E001C0738077007FFFFFFFF10107F8F14>I E /Fn 68 123 df<03F0F807F1F80E13
081C07001C07001C07001C07001C0700FF87E0FF87E01C07001C07001C07001C07001C07001C07
001C07001C07001C07001C07001C07001C07001C07001517809615>11 D<000703C70FC70C401C
001C001C001C001C00FFC7FFC71C071C071C071C071C071C071C071C071C071C071C071C071C07
1018809713>I<03C70FC70C471C071C071C071C071C07FFC7FFC71C071C071C071C071C071C07
1C071C071C071C071C071C071C071017809613>I<000001C003E0F1C007E3F1C00C2310001C07
00001C0700001C0700001C0700001C070000FFC7F1C0FFC7F1C01C0701C01C0701C01C0701C01C
0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C0
1A1880971D>I<E0E0E0E0E0E0E0E0E0E0E0E0E0E0E04000000000E0E0E003177C960B>33
D<E1C0E1C0E1C060C040804080C1800A077F9612>I<E0E0E0604040C003077D960A>39
D<0180030006000C001C001800380030007000700070006000E000E000E000E000E000E000E000
E000E000E00060007000700070003000380018001C000C0006000300018009227E980E>I<C000
6000300018001C000C000E00060007000700070003000380038003800380038003800380038003
800380030007000700070006000E000C001C00180030006000C00009227E980E>I<E0E0E06040
40C003077D820A>44 D<FF80FF80090280880C>I<E0E0E003037D820A>I<07C01FF03C78701C70
1C600CE00EE00EE00EE00EE00EE00EE00EE00EE00EE00E701C701C783C3C781FF007C00F167F95
12>48 D<01000700FF00FF00070007000700070007000700070007000700070007000700070007
00070007007FF07FF00C167E9512>I<E0E0E0000000000000000000E0E0E0030F7D8E0A>58
D<E0E0E0000000000000000000E0E0E0604040C003137D8E0A>I<1F807FC0E0E0C07040700070
00E001E00380030006000600060006000E00040000000000000000000E000E000E000C177E9611
>63 D<00700000F80000F80001DC00019C00018C00038E00038E000306000707000707000E0380
0E03800C03801FFFC01FFFC03801E03800E03800E0700070700070600070E0003815177F9618>
65 D<FFF000FFFC00E01E00E00700E00380E00380E00380E00380E00700E01E00FFFC00FFFC00
E01F00E00780E00180E001C0E001C0E001C0E001C0E00380E00F00FFFE00FFF80012177D9618>
I<00FF0003FFC00F83C01E00C01C0000380000700000700000E00000E00000E00000E00000E000
00E00000E000007000007000003800001C00401E00C00F81C003FF8000FE0012177E9617>I<FF
F000FFFC00E01E00E00700E00380E00380E001C0E001C0E000E0E000E0E000E0E000E0E000E0E0
00E0E000E0E000C0E001C0E001C0E00380E00700E01E00FFFC00FFF00013177D9619>I<FFFEFF
FEE000E000E000E000E000E000E000E000FFFCFFFCE000E000E000E000E000E000E000E000E000
FFFFFFFF10177D9615>I<FFFEFFFEE000E000E000E000E000E000E000E000FFF8FFF8E000E000
E000E000E000E000E000E000E000E000E0000F177D9614>I<00FE0003FF800783C01E00C01C00
C0380000700000700000E00000E00000E00000E00000E01FE0E01FE0E000E07000E07000E03800
E01C00E01E00E00781E003FFC000FE0013177E9618>I<E001C0E001C0E001C0E001C0E001C0E0
01C0E001C0E001C0E001C0E001C0FFFFC0FFFFC0E001C0E001C0E001C0E001C0E001C0E001C0E0
01C0E001C0E001C0E001C0E001C012177D9619>I<E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0
E0E0E0E0E003177D960A>I<E001C0E00380E00700E00E00E01C00E03800E07000E0E000E1C000
E3C000E7E000EEF000FC7000F83800F03C00E01E00E00E00E00700E00780E00380E001C0E000E0
E000F014177D9619>75 D<E000E000E000E000E000E000E000E000E000E000E000E000E000E000
E000E000E000E000E000E000E000FFFCFFFC0E177D9613>I<F8001FF8001FE80017EC0037EC00
37EE0077E60067E60067E700E7E300C7E381C7E381C7E18187E1C387E1C387E0C307E0E707E0E7
07E06607E06607E03C07E03C07E03C0718177D961F>I<F801C0F801C0EC01C0EC01C0E601C0E6
01C0E701C0E301C0E381C0E181C0E1C1C0E0C1C0E0E1C0E061C0E071C0E031C0E039C0E019C0E0
19C0E00DC0E00DC0E007C0E007C012177D9619>I<01FC0007FF000F07801C01C03800E03800E0
700070700070E00038E00038E00038E00038E00038E00038E000387000707000703800E03800E0
1C01C00F078007FF0001FC0015177E961A>I<FFF000FFFC00E01E00E00700E00380E00380E003
80E00380E00380E00700E01E00FFFC00FFF000E00000E00000E00000E00000E00000E00000E000
00E00000E00000E0000011177D9617>I<FFF000FFFC00E01E00E00700E00380E00380E00380E0
0380E00700E01E00FFFC00FFF000E07000E03000E03800E01C00E01C00E00E00E00E00E00700E0
0380E00380E001C012177D9617>82 D<07E01FF8383C600CC00CC000C000E00070007E003FE00F
F001F8001C000E000600060006C006E00CF8387FF00FC00F177E9614>I<FFFFF8FFFFF8007000
007000007000007000007000007000007000007000007000007000007000007000007000007000
00700000700000700000700000700000700000700015177F9618>I<E00380E00380E00380E003
80E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380E003
80E00380700700780F003C1E001FFC0007F00011177D9618>I<E00038E00038F0003870007070
00703800E03800E01C00C01C01C01C01C00E03800E0380070300070700070700038E00038E0001
8C0001DC0001DC0000F80000F80000700016177F9618>I<E00FC01CE00FC01CE00DC01CE00CC0
1C701CE038701CE0387018E03830386030383870703838707038307070187030601C7038E01C60
38E01C6018E00C6018C00EE01CC00EC01DC006C00D8006C00D8007C00F8007800F80038007001F
177F9621>I<F0001E78003C3800381C00701E00F00F00E00701C007838003C38001C70000EE00
00FE00007C00003800003800003800003800003800003800003800003800003800003800171780
9618>89 D<FCFCE0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0FCFC06
217D980A>91 D<60C040804080C180E1C0E1C0E1C00A077A9612>I<FCFC1C1C1C1C1C1C1C1C1C
1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1CFCFC062180980A>I<1FC07FE0707040380038
003801F81FF87E38F038E038E038F0787FF83FB80D0F7F8E11>97 D<E000E000E000E000E000E0
00E000E000E7C0FFE0F870E038E038E01CE01CE01CE01CE01CE038E038F0F0FFE0E7800E177E96
12>I<07E01FF8381870007000E000E000E000E000E0007000700838381FF807E00D0F7F8E10>I<
001C001C001C001C001C001C001C001C079C1FFC3C3C701C701CE01CE01CE01CE01CE01C701C70
3C387C1FFC0F9C0E177F9612>I<0F801FE0387070306038E018FFF8FFF8E000E0006000700038
181FF807E00D0F7F8E10>I<03E007E00C201C001C001C001C001C00FF80FF801C001C001C001C
001C001C001C001C001C001C001C001C001C000B1780960B>I<0F9F1FFF38F070707070707070
7038E03FC06F80600070007FF03FF87FFC701EE00EE00EE00E783C3FF80FE010167F8E12>I<E0
00E000E000E000E000E000E000E000E7E0EFF0F878F038E038E038E038E038E038E038E038E038
E038E038E0380D177E9612>I<E0E0E0000000000000E0E0E0E0E0E0E0E0E0E0E0E0E0E0E00318
7E9708>I<070707000000000000070707070707070707070707070707070707CFFE7C081E8297
09>I<E000E000E000E000E000E000E000E000E0F8E1F0E3E0E3C0E780EF00FE00FF00FF80F380
E1C0E1E0E0E0E0F0E0780D177E9611>I<E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0
E003177E9608>I<E7E1F8EFF3FCF87E1EF03C0EE0380EE0380EE0380EE0380EE0380EE0380EE0
380EE0380EE0380EE0380EE0380E170F7E8E1C>I<E7E0EFF0F878F038E038E038E038E038E038
E038E038E038E038E038E0380D0F7E8E12>I<07C01FF03838701C701CE00EE00EE00EE00EE00E
701C701C3C781FF007C00F0F7F8E12>I<E7C0FFE0F870E038E038E01CE01CE01CE01CE01CE038
E038F0F0FFE0E780E000E000E000E000E000E0000E157E8E12>I<079C1FFC3C7C703C701CE01C
E01CE01CE01CE01C701C701C387C1FFC0F9C001C001C001C001C001C001C0E157F8E12>I<E380
EF80FC00F800F000F000E000E000E000E000E000E000E000E000E000090F7E8E0C>I<1F007FC0
E0C0E000E000F0007F003F800FC001E080E0C0E0E1C07FC01F000B0F7F8E0E>I<380038003800
3800FF80FF80380038003800380038003800380038003800380038401FC01F000A137F920D>I<
E038E038E038E038E038E038E038E038E038E038E038E038E0F87FF83F380D0F7E8E12>I<E038
E038E03870707070707038E038E038E01CC01DC00D800D800F8007000E0F7F8E10>I<E0F038E0
F838E0D838E09838719C70719C70718C70310C603B0CE03B0EE03B06E01A06C01A06C01E07C00E
0380160F7F8E18>I<701C783838701C700EE007C00380038007C00EE00C601C703838701CF01E
0F0F808E10>I<E038E038703870707070386038E018E01CC01CC00DC00D800580070007000700
060006008C00FC00F8000E157F8E10>I<FFE0FFE001C001C00380070007000E001C001C003800
70007000FFF0FFF00C0F7F8E0F>I E /Fo 72 123 df<60F0F0F0F0F0F0F0F0F0F0F000000000
60F0F0600414799312>33 D<0F001F8039C039C039C039C03BBE3BBE3F781E701C703EF07EE0EF
E0E7C0E7C4E3CEF7EE7FFC3C380F147F9312>38 D<307C7C3C0C0C0C1C3830F0C0060C7A9312>
I<018007800F001E003C00380078007000F000E000E000E000E000E000E000E000F00070007800
38003C001E000F000780018009197B9612>I<C000F00078003C001E000E000F00070007800380
038003800380038003800380078007000F000E001E003C007800F000C00009197D9612>I<0700
07000700E738FFF87FF01FC01FC07FF0FFF8E7380700070007000D0E7E9012>I<038003800380
038003800380FFFEFFFEFFFE0380038003800380038003800F0F7F9112>I<307C7C3C0C1C38F0
E006097A8312>I<FFF8FFF8FFF80D037E8B12>I<60F0F0600404798312>I<0018003800380070
007000E000E001C001C001C003800380070007000E000E001C001C001C003800380070007000E0
00E000C0000D1A7E9612>I<07C00FE01C703838701C701CE00EE00EE00EE00EE00EE00EE00EE0
1E701C701C38381C700FE007C00F147F9312>I<030007000F001F00FF00F70007000700070007
00070007000700070007000700070007007FF07FF00C147E9312>I<0F803FE070F0F078E038E0
38403800380078007000F001E003C007800F001E0038387038FFF8FFF80D147E9312>I<0FE03F
F0783C701C701C001C003C007807F007F0003C001C000E000EE00EE00EE01CF83C3FF00FC00F14
7F9312>I<00F001F00370037006700E700C701C70387038707070E070FFFEFFFE007000700070
007003FE03FE0F147F9312>I<7FF07FF07000700070007000700070007F807FE060F000780038
4038E038E038E07070F03FC01F000D147E9312>I<01F007F81E3C3C1C781C7000F000E7C0FFF0
F83CF01CF01EE00EE00EF00E701E781C3C3C1FF007C00F147F9312>I<07C01FF03C78783C701C
701C701C38380FE007C03C78701CE00EE00EE00EE00E701C783C1FF00FE00F147F9312>56
D<07C01FF07878703CE01CE01EE01EE01EF01E783E3FFE0FCE000E001E001C703C707878F03FE0
0F800F147F9312>I<60F0F06000000000000060F0F060040E798D12>I<30787830000000000000
30787838183830F0C005137A8D12>I<0038007801F003E00F801F003C00F800F000F8003C001F
000F8003E001F0007800380D117E9212>I<FFFEFFFE7FFE0000000000007FFEFFFEFFFE0F097F
8E12>I<4000E000F0007C003E000F8007C001E000F8007800F801E007C00F803E007C00F000E0
0040000D137E9312>I<038007C007C006C006C00EE00EE00EE00EE00C601C701C701C701FF01F
F0383838383838FEFEFEFE0F147F9312>65 D<FFE0FFF03838381C381C381C381C383838783FF0
3FF8381C380E380E380E380E381E383CFFF8FFF00F147F9312>I<03E60FFE1C3E381E781E700E
F00EE000E000E000E000E000E000F00E700E780E381E1C3C0FF803E00F147F9312>I<FFC0FFF0
38783838381C381C381E380E380E380E380E380E380E380E381C381C38383878FFF0FFC00F147F
9312>I<FFFEFFFE380E380E380E3800380038E038E03FE03FE038E038E03800380E380E380E38
0EFFFEFFFE0F147F9312>I<FFFEFFFE380E380E380E3800380038E038E03FE03FE038E038E038
003800380038003800FF00FF000F147F9312>I<07981FF83CF8387870387038F038E000E000E0
00E1FEE1FEE038F0387038707838783CF81FF807B80F147F9312>I<FFF8FFF807000700070007
00070007000700070007000700070007000700070007000700FFF8FFF80D147E9312>73
D<FF80FF801C001C001C001C001C001C001C001C001C001C001C001C001C021C071C071C07FFFF
FFFF1014809312>76 D<FE3F80FE3F803A2E003A2E003B6E003B6E003B6E003B6E003B6E003B6E
003BEE0039CE0039CE00380E00380E00380E00380E00380E00FE3F80FE3F801114809312>I<FE
FEFEFE3A383A383B383B383B383B383B383B3839B839B839B839B839B839B838B838B8FEF8FEF8
0F147F9312>I<3FE07FF07070E038E038E038E038E038E038E038E038E038E038E038E038E038
E03870707FF03FE00D147E9312>I<FFE0FFF8383C381C380E380E380E380E381C383C3FF83FE0
380038003800380038003800FE00FE000F147F9312>I<FF80FFE038F038783838383838383878
38F03FE03FE038F0387038703870387038773877FE3FFE1C10147F9312>82
D<1F303FF070F0E0F0E070E070F000F0007F003FE00FF000F000780038E038E038F078F070FFE0
CF800D147E9312>I<FFFEFFFEE38EE38EE38E0380038003800380038003800380038003800380
0380038003801FF01FF00F147F9312>I<FE3F80FE3F80380E00380E00380E00380E00380E0038
0E00380E00380E00380E00380E00380E00380E00380E003C1E001C1C001E3C000FF80003E00011
14809312>I<FCFCFCFC1C701CE00EE00FE00FC007C007800380078007C00FC00EE01EE01C701C
703838FEFEFEFE0F147F9312>88 D<FC7EFC7E383838381C701C700EE00EE00EE007C007C00380
0380038003800380038003800FE00FE00F147F9312>I<FFF8FFF8E078E070E0E001E001C003C0
038007800F000E001E001C003C1C381C701CF01CFFFCFFFC0E147E9312>I<FFF8FFF8FFF80D03
7E7F12>95 D<3F807FE070F0207000700FF03FF07870F070E070E070F0F07FFE1F3E0F0E7E8D12
>97 D<FC00FC001C001C001C001C001DF01FF81F1E1E0E1C0F1C071C071C071C071C0F1E0E1F1C
1FF81DE01014809312>I<07F01FF838387010F000E000E000E000E000F000703838781FF007E0
0D0E7E8D12>I<01F801F8003800380038003807B81FF838787078F038E038E038E038E038F038
707878F81FFF0FBF10147F9312>I<07801FE038F07078F038E038FFF8FFF8E000F00070383878
1FF007C00D0E7E8D12>I<007E01FF03C7038203800380FFFEFFFE038003800380038003800380
03800380038003807FFC7FFC1014809312>I<0F9E1FFF38E7707070707070707038E03FC07F80
70003FE03FF87FFCF01EE00EE00EE00EF01E783C3FF80FE010167F8D12>I<FC0000FC00001C00
001C00001C00001C00001CF0001FF8001F1C001E1C001C1C001C1C001C1C001C1C001C1C001C1C
001C1C001C1C00FF9F80FF9F801114809312>I<06000F000F000600000000000000FF00FF0007
00070007000700070007000700070007000700FFF8FFF80D157D9412>I<00C001E001E000C000
00000000003FE03FE000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E0
41E0E1C0FF807E000B1C7E9412>I<FC0000FC00001C00001C00001C00001C00001FFF001FFF00
1C78001CF0001DE0001FC0001FE0001FE0001EF0001C78001C3C001C3C00FF3F80FF3F80111480
9312>I<FF80FF8003800380038003800380038003800380038003800380038003800380038003
80FFFEFFFE0F147F9312>I<FB8E00FFFF803EFB803CF38038E38038E38038E38038E38038E380
38E38038E38038E380FEFBE0FEFBE0130E818D12>I<FCF000FFF8001F1C001E1C001C1C001C1C
001C1C001C1C001C1C001C1C001C1C001C1C00FF9F80FF9F80110E808D12>I<0F803FE038E070
70E038E038E038E038E038F078707038E03FE00F800D0E7E8D12>I<FDF0FFF81F1E1E0E1C0F1C
071C071C071C071C0F1E0E1F1C1FF81DE01C001C001C001C001C00FF80FF801015808D12>I<07
9C001FFC00387C00703C00F01C00E01C00E01C00E01C00E01C00F01C00703C00387C001FFC0007
9C00001C00001C00001C00001C00001C0000FF8000FF8011157F8D12>I<FE7CFEFE0FCE0F840F
000E000E000E000E000E000E000E00FFF0FFF00F0E7F8D12>I<1FF07FF0E070C070E000FF003F
E00FF00078E018E018F038FFF0DFC00D0E7E8D12>I<0E000E000E000E00FFF8FFF80E000E000E
000E000E000E000E000E380E380E7807F003C00D127F9112>I<FCFC00FCFC001C1C001C1C001C
1C001C1C001C1C001C1C001C1C001C1C001C1C001C3C000FFF8007DF80110E808D12>I<FEFEFE
FE38383C781C701C701C700EE00EE00EE006C007C007C003800F0E7F8D12>I<FEFEFEFE701C70
1C301838383BB83FF83FF83AB838B81CF01CF01CF00F0E7F8D12>I<FCFEFCFE1CF00EE00FC007
C00380078007C00EE01EF01C70FEFEFEFE0F0E7F8D12>I<FEFEFEFE3C381C381C701C700E700E
600E6006E006E003C003C003C0038003800380778077007E003C000F157F8D12>I<7FFC7FFC70
38707000E001C0038007000E001C1C381C701CFFFCFFFC0E0E7F8D12>I
E /Fp [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 21 25 35 42 42 66 54 21 25 25 29 44 21 25 21 21
42 42 42 42 42 42 42 42 42 42 25 25 44 44 44 46 73 54 54 54
54 50 46 58 54 21 42 54 46 62 54 58 50 58 54 50 46 54 50 71
50 50 46 25 21 25 44 42 21 42 46 42 46 42 25 46 46 21 21 42
21 66 46 46 46 46 29 42 25 46 42 58 42 42 37 29 21 29 44 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 25 42 42 12 42 42 42 42 18 37 42 25 25 46 46 0 42 42
42 21 0 42 26 21 37 37 42 75 75 0 46 0 25 25 25 25 25 25 25
25 0 25 25 0 25 25 25 75 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 75
0 28 0 0 0 0 46 58 75 27 0 0 0 0 0 66 0 0 0 21 0 0 21 46 71
46 0 0 0 0 ] /Helvetica-Bold 1000 1179648 rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300
TeXDict begin 
%%EndSetup
%%Page: 1201 1
bop 0 0 a @beginspecial @setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 389 x Fp(Chapter)21
b(B10.)74 b(Minimization)21 b(or)149 481 y(Maximization)f(of)h(Functions)0
574 y Fo(SUBROUTINE)14 b(mnbrak\(ax,)o(bx,)o(cx,)o(fa,)o(fb,)o(fc)o(,fu)o
(nc\))0 611 y(USE)j(nrtype;)e(USE)h(nrutil,)f(ONLY)i(:)g(swap)0
648 y(IMPLICIT)e(NONE)0 686 y(REAL\(SP\),)f(INTENT\(INOU)o(T\))g(::)j(ax,bx)0
723 y(REAL\(SP\),)d(INTENT\(OUT\))g(::)j(cx,fa,fb,f)o(c)0 760
y(INTERFACE)66 798 y(FUNCTION)e(func\(x\))66 835 y(USE)i(nrtype)66
872 y(IMPLICIT)e(NONE)66 910 y(REAL\(SP\),)g(INTENT\(IN\))f(::)j(x)66
947 y(REAL\(SP\))e(::)i(func)66 984 y(END)g(FUNCTION)e(func)0
1022 y(END)i(INTERFACE)0 1059 y(REAL\(SP\),)d(PARAMETER)h(::)i(GOLD=1.618)o
(03)o(4_s)o(p,G)o(LIM)o(IT=)o(10)o(0.0)o(_sp)o(,TI)o(NY=)o(1.)o(0e-)o(20_)o
(sp)58 1097 y Fn(Given)e(a)f(function)g Fm(func)o Fn(,)h(and)f(given)h
(distinct)f(initial)i(p)q(oints)e Fm(ax)g Fn(and)h Fm(bx)o
Fn(,)g(this)f(routine)g(sea)o(rches)58 1134 y(in)i(the)f(do)o(wnhill)i
(direction)e(\(de\014ned)g(b)o(y)g(the)g(function)g(as)g(evaluated)g(at)g
(the)g(initial)i(p)q(oints\))d(and)58 1171 y(returns)e(new)h(p)q(oints)f
Fm(ax)o Fn(,)h Fm(bx)o Fn(,)f Fm(cx)g Fn(that)g(b)o(rack)o(et)g(a)h(minimum)h
(of)e(the)g(function.)17 b(Also)12 b(returned)g(a)o(re)58 1209
y(the)g(function)f(values)h(at)f(the)h(three)f(p)q(oints,)g
Fm(fa)p Fn(,)g Fm(fb)o Fn(,)h(and)g Fm(fc)o Fn(.)58 1246 y(P)o(a)o(rameters:)
k Fm(GOLD)10 b Fn(is)i(the)f(default)h(ratio)f(b)o(y)i(which)f(successive)e
(intervals)i(a)o(re)f(magni\014ed;)h Fm(GLIMIT)58 1283 y Fn(is)i(the)f
(maximum)h(magni\014cation)f(allo)o(w)o(ed)h(fo)o(r)f(a)h(pa)o(rab)q
(olic-\014t)f(step.)0 1321 y Fo(REAL\(SP\))i(::)i(fu,q,r,u,)o(uli)o(m)0
1358 y(fa=func\(ax)o(\))0 1395 y(fb=func\(bx)o(\))0 1433 y(if)g(\(fb)f(>)i
(fa\))e(then)554 b Fn(Switch)15 b(roles)f(of)g Fl(a)h Fn(and)g
Fl(b)g Fn(so)f(that)h(w)o(e)915 1470 y(can)e(go)f(do)o(wnhill)i(in)g(the)e
(direction)915 1508 y(from)g Fl(a)h Fn(to)f Fl(b)p Fn(.)66
1470 y Fo(call)17 b(swap\(ax,b)o(x\))66 1508 y(call)g(swap\(fa,f)o(b\))0
1545 y(end)g(if)0 1582 y(cx=bx+GOLD)o(*\(b)o(x-a)o(x\))534
b Fn(First)13 b(guess)e(fo)o(r)i Fl(c)p Fn(.)0 1620 y Fo(fc=func\(cx)o(\))0
1657 y(do)819 b Fn(Do-while-lo)q(op:)18 b(Keep)c(returning)i(here)915
1694 y(until)e(w)o(e)e(b)o(rack)o(et.)-1096 b Fo(if)17 b(\(fb)g(<)g(fc\))g
(RETURN)100 1732 y Fn(Compute)11 b Fl(u)h Fn(b)o(y)h(pa)o(rab)q(olic)f
(extrap)q(olation)g(from)f Fl(a;)6 b(b;)g(c)p Fn(.)17 b Fo(TINY)11
b Fn(is)h(used)g(to)f(p)o(revent)h(any)g(p)q(ossible)100 1769
y(division)17 b(b)o(y)f(zero.)66 1806 y Fo(r=\(bx-ax\)*\()o(fb-)o(fc\))66
1844 y(q=\(bx-cx\)*\()o(fb-)o(fa\))66 1881 y(u=bx-\(\(bx-c)o(x\)*)o(q-\()o
(bx-)o(ax\))o(*r)o(\)/\()o(2.0)o(_sp)o(*si)o(gn)o(\(ma)o(x\(a)o(bs\()o(q-r)o
(\),)o(TIN)o(Y\),)o(q-r)o(\)\))66 1918 y(ulim=bx+GLI)o(MIT)o(*\(c)o(x-b)o
(x\))100 1956 y Fn(W)o(e)d(w)o(on't)g(go)g(fa)o(rther)g(than)h(this.)j(T)m
(est)c(va)o(rious)h(p)q(ossibilities:)66 1993 y Fo(if)j(\(\(bx-u\)*\(u-)o
(cx\))d(>)j(0.0\))f(then)276 b Fn(P)o(a)o(rab)q(olic)14 b Fl(u)g
Fn(is)f(b)q(et)o(w)o(een)g Fl(b)h Fn(and)g Fl(c)p Fn(:)j(try)915
2031 y(it.)-813 b Fo(fu=func\(u\))133 2068 y(if)17 b(\(fu)f(<)i(fc\))e(then)
421 b Fn(Got)11 b(a)h(minimum)h(b)q(et)o(w)o(een)e Fl(b)h Fn(and)g
Fl(c)p Fn(.)199 2105 y Fo(ax=bx)199 2143 y(fa=fb)199 2180 y(bx=u)199
2217 y(fb=fu)199 2255 y(RETURN)133 2292 y(else)k(if)h(\(fu)g(>)g(fb\))f(then)
333 b Fn(Got)11 b(a)h(minimum)h(b)q(et)o(w)o(een)e Fl(a)g Fn(and)i
Fl(u)p Fn(.)199 2329 y Fo(cx=u)199 2367 y(fc=fu)199 2404 y(RETURN)656
2507 y Fk(1201)p eop
%%Page: 1202 2
bop 0 50 a Fk(1202)188 b Fj(Chapter)11 b(B10.)54 b(Minimization)11
b(or)g(Maximization)f(of)h(Functions)p 0 68 1395 2 v 0 143
a @beginspecial @setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 133 180 a Fo(end)16
b(if)133 218 y(u=cx+GOLD*)o(\(cx)o(-b)o(x\))419 b Fn(P)o(a)o(rab)q(olic)9
b(\014t)g(w)o(as)f(no)h(use.)17 b(Use)8 b(default)915 255 y(magni\014cation.)
-990 b Fo(fu=func\(u\))66 293 y(else)17 b(if)g(\(\(cx-u\)*\()o(u-u)o(lim)o
(\))d(>)k(0.0\))e(then)152 b Fn(P)o(a)o(rab)q(olic)12 b(\014t)f(is)h(b)q(et)o
(w)o(een)f Fl(c)h Fn(and)g(its)f(al-)915 330 y(lo)o(w)o(ed)i(limit.)-952
b Fo(fu=func\(u\))133 367 y(if)17 b(\(fu)f(<)i(fc\))e(then)199
405 y(bx=cx)199 442 y(cx=u)199 479 y(u=cx+GOLD*\()o(cx-)o(bx\))199
517 y(call)g(shft\(fb,fc,f)o(u,)o(fun)o(c\(u)o(\)\))133 554
y(end)g(if)66 591 y(else)h(if)g(\(\(u-ulim\))o(*\(u)o(lim)o(-c)o(x\))d(>=)j
(0.0\))g(then)81 b Fn(Limit)19 b(pa)o(rab)q(olic)f Fl(u)h Fn(to)e(maximum)i
(al-)915 629 y(lo)o(w)o(ed)13 b(value.)-962 b Fo(u=ulim)133
666 y(fu=func\(u\))66 703 y(else)717 b Fn(Reject)10 b(pa)o(rab)q(olic)h
Fl(u)p Fn(,)g(use)f(default)h(mag-)915 741 y(ni\014cation.)-927
b Fo(u=cx+GOLD*)o(\(cx)o(-b)o(x\))133 778 y(fu=func\(u\))66
816 y(end)17 b(if)66 853 y(call)g(shft\(ax,b)o(x,c)o(x,u)o(\))66
890 y(call)g(shft\(fa,f)o(b,f)o(c,f)o(u\))397 b Fn(Eliminate)12
b(oldest)e(p)q(oint)h(and)g(continue.)0 928 y Fo(end)17 b(do)0
965 y(CONTAINS)0 1019 y(SUBROUTINE)d(shft\(a,b,c)o(,d\))0 1056
y(REAL\(SP\),)g(INTENT\(OUT\))g(::)j(a)0 1094 y(REAL\(SP\),)d(INTENT\(INOU)o
(T\))g(::)j(b,c)0 1131 y(REAL\(SP\),)d(INTENT\(IN\))g(::)j(d)0
1168 y(a=b)0 1206 y(b=c)0 1243 y(c=d)0 1280 y(END)g(SUBROUTIN)o(E)e(shft)0
1318 y(END)i(SUBROUTIN)o(E)e(mnbrak)187 1476 y @beginspecial
@setspecial
 /oshow {true charpath gsave 1 setgray fill grestore stroke} def gsave
0.5 setgray -40 -20 translate .8 .8 scale /NewCenturySchlbk-Bold findfont
40 scalefont setfont 2 1 scale 0 0 moveto (f) show /Helvetica-Narrow
findfont 24 scalefont setfont 0.5 1 scale 23 1 moveto (90) show grestore 
@endspecial(call)h(shft...)39 b Fk(There)13 b(are)g(three)f
(places)i(in)d Fi(mnbrak)g Fk(where)i(we)g(need)f(to)g(shift)187
1526 y(four)7 b(variables)i(around.)14 b(Rather)8 b(than)g(repeat)h(code,)g
(we)g(make)h Fi(shft)d Fk(an)i(internal)187 1575 y(subroutine,)17
b(coming)g(after)g(a)g Fi(CONTAINS)e Fk(statement.)36 b(It)16
b(is)h(invisible)e(to)h(all)0 1625 y(procedures)j(except)g
Fi(mnbrak)o Fk(.)574 1719 y Fh(?)92 b(?)g(?)0 1875 y Fo(FUNCTION)15
b(golden\(ax,)o(bx)o(,cx)o(,fu)o(nc,)o(tol)o(,x)o(min)o(\))0
1912 y(USE)i(nrtype)0 1949 y(IMPLICIT)e(NONE)0 1987 y(REAL\(SP\),)f
(INTENT\(IN\))g(::)j(ax,bx,cx,to)o(l)0 2024 y(REAL\(SP\),)d(INTENT\(OUT\))g
(::)j(xmin)0 2062 y(REAL\(SP\))e(::)i(golden)0 2099 y(INTERFACE)66
2136 y(FUNCTION)e(func\(x\))66 2174 y(USE)i(nrtype)66 2211
y(IMPLICIT)e(NONE)66 2248 y(REAL\(SP\),)g(INTENT\(IN\))f(::)j(x)66
2286 y(REAL\(SP\))e(::)i(func)66 2323 y(END)g(FUNCTION)e(func)0
2360 y(END)i(INTERFACE)0 2398 y(REAL\(SP\),)d(PARAMETER)h(::)i(R=0.618033)o
(99)o(_sp)o(,C=)o(1.0)o(_sp)o(-R)58 2435 y Fn(Given)d(a)g(function)f
Fm(func)o Fn(,)h(and)g(given)g(a)g(b)o(rack)o(eting)f(triplet)h(of)f
(abscissas)f Fm(ax)p Fn(,)i Fm(bx)o Fn(,)g Fm(cx)f Fn(\(such)g(that)58
2473 y Fm(bx)h Fn(is)h(b)q(et)o(w)o(een)f Fm(ax)g Fn(and)h
Fm(cx)o Fn(,)g(and)g Fm(func\(bx\))d Fn(is)i(less)g(than)h(b)q(oth)g
Fm(func\(ax\))c Fn(and)k Fm(func\(cx\))m Fn(\),)58 2510 y(this)e(routine)g(p)
q(erfo)o(rms)g(a)g(golden)g(section)f(sea)o(rch)g(fo)o(r)h(the)g(minimum,)i
(isolating)e(it)g(to)g(a)g(fractional)58 2547 y(p)o(recision)c(of)f(ab)q(out)
g Fm(tol)o Fn(.)18 b(The)8 b(abscissa)g(of)g(the)g(minimum)i(is)f(returned)f
(as)g Fm(xmin)o Fn(,)h(and)g(the)f(minimum)p eop
%%Page: 1203 3
bop 154 50 a Fj(Chapter)10 b(B10.)37 b(Minimization)11 b(or)g(Maximization)f
(of)h(Functions)188 b Fk(1203)p 0 68 1395 2 v 0 143 a @beginspecial
@setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 58 180 a Fn(function)12 b(value)g(is)g(returned)f
(as)h Fm(golden)m Fn(,)g(the)f(returned)h(function)g(value.)58
218 y(P)o(a)o(rameters:)k(The)f(golden)g(ratios.)0 255 y Fo(REAL\(SP\))g(::)i
(f1,f2,x0,)o(x1,)o(x2,)o(x3)0 293 y(x0=ax)705 b Fn(A)o(t)13
b(any)g(given)h(time)f(w)o(e)g(will)i(k)o(eep)e(track)g(of)855
330 y(four)f(p)q(oints,)g Fo(x0,x1,x2,x)o(3)m Fn(.)-1242 b
Fo(x3=cx)0 367 y(if)17 b(\(abs\(cx-bx)o(\))e(>)i(abs\(bx-ax\))o(\))e(then)211
b Fn(Mak)o(e)12 b Fo(x0)f Fn(to)g Fo(x1)h Fn(the)f(smaller)h(segment,)66
405 y Fo(x1=bx)66 442 y(x2=bx+C*\(cx)o(-bx)o(\))461 b Fn(and)12
b(\014ll)h(in)g(the)e(new)h(p)q(oint)g(to)g(b)q(e)f(tried.)0
479 y Fo(else)66 517 y(x2=bx)66 554 y(x1=bx-C*\(bx)o(-ax)o(\))0
591 y(end)17 b(if)0 629 y(f1=func\(x1)o(\))0 666 y(f2=func\(x2)o(\))33
703 y Fn(The)f(initial)h(function)e(evaluations.)j(Note)c(that)h(w)o(e)h
(never)f(need)g(to)g(evaluate)g(the)h(function)f(at)g(the)33
741 y(o)o(riginal)i(endp)q(oints.)0 778 y Fo(do)759 b Fn(Do-while-lo)q(op:)18
b(W)o(e)c(k)o(eep)f(returning)h(here.)66 816 y Fo(if)j(\(abs\(x3-x0\))d(<=)j
(tol*\(abs\(x)o(1\)+)o(abs)o(\(x2)o(\)\))o(\))e(exit)66 853
y(if)i(\(f2)g(<)g(f1\))g(then)427 b Fn(One)13 b(p)q(ossible)f(outcome,)133
890 y Fo(call)k(shft3\(x0,x)o(1,x)o(2,R)o(*x2)o(+C*)o(x3)o(\))130
b Fn(its)13 b(housek)o(eeping,)133 928 y Fo(call)j(shft2\(f1,f)o(2,f)o(unc)o
(\(x2)o(\)\))200 b Fn(and)13 b(a)f(new)g(function)g(evaluation.)66
965 y Fo(else)657 b Fn(The)13 b(other)f(outcome,)133 1002 y
Fo(call)k(shft3\(x3,x)o(2,x)o(1,R)o(*x1)o(+C*)o(x0)o(\))133
1040 y(call)g(shft2\(f2,f)o(1,f)o(unc)o(\(x1)o(\)\))200 b Fn(and)13
b(its)e(new)i(function)f(evaluation.)66 1077 y Fo(end)17 b(if)0
1114 y(end)g(do)688 b Fn(Back)12 b(to)g(see)f(if)i(w)o(e)f(a)o(re)g(done.)0
1152 y Fo(if)17 b(\(f1)f(<)i(f2\))e(then)494 b Fn(W)o(e)9 b(a)o(re)f(done.)17
b(Output)9 b(the)g(b)q(est)e(of)i(the)f(t)o(w)o(o)855 1189
y(current)13 b(values.)-1006 b Fo(golden=f1)66 1227 y(xmin=x1)0
1264 y(else)66 1301 y(golden=f2)66 1339 y(xmin=x2)0 1376 y(end)17
b(if)0 1413 y(CONTAINS)0 1467 y(SUBROUTINE)d(shft2\(a,b,)o(c\))0
1505 y(REAL\(SP\),)g(INTENT\(OUT\))g(::)j(a)0 1542 y(REAL\(SP\),)d
(INTENT\(INOU)o(T\))g(::)j(b)0 1579 y(REAL\(SP\),)d(INTENT\(IN\))g(::)j(c)0
1617 y(a=b)0 1654 y(b=c)0 1691 y(END)g(SUBROUTIN)o(E)e(shft2)0
1745 y(SUBROUTINE)f(shft3\(a,b,)o(c,d)o(\))0 1783 y(REAL\(SP\),)g
(INTENT\(OUT\))g(::)j(a)0 1820 y(REAL\(SP\),)d(INTENT\(INOU)o(T\))g(::)j(b,c)
0 1857 y(REAL\(SP\),)d(INTENT\(IN\))g(::)j(d)0 1895 y(a=b)0
1932 y(b=c)0 1970 y(c=d)0 2007 y(END)g(SUBROUTIN)o(E)e(shft3)0
2044 y(END)i(FUNCTION)d(golden)187 2220 y @beginspecial @setspecial
 /oshow {true charpath gsave 1 setgray fill grestore stroke} def gsave
0.5 setgray -40 -20 translate .8 .8 scale /NewCenturySchlbk-Bold findfont
40 scalefont setfont 2 1 scale 0 0 moveto (f) show /Helvetica-Narrow
findfont 24 scalefont setfont 0.5 1 scale 23 1 moveto (90) show grestore

@endspecial(call)i(shft3...ca)o(ll)e(shft2...)39 b Fk(See)23
b(discussion)e(of)h Fi(shft)f Fk(for)g Fi(mnbrak)g Fk(on)187
2270 y(p.)f(1202.)574 2384 y Fh(?)92 b(?)g(?)p eop
%%Page: 1204 4
bop 0 50 a Fk(1204)188 b Fj(Chapter)11 b(B10.)54 b(Minimization)11
b(or)g(Maximization)f(of)h(Functions)p 0 68 1395 2 v 0 143
a @beginspecial @setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 37 x Fo(FUNCTION)k(brent\(ax,b)o
(x,)o(cx,)o(fun)o(c,t)o(ol,)o(xm)o(in\))0 218 y(USE)i(nrtype;)e(USE)h
(nrutil,)f(ONLY)i(:)g(nrerror)0 255 y(IMPLICIT)e(NONE)0 293
y(REAL\(SP\),)f(INTENT\(IN\))g(::)j(ax,bx,cx,to)o(l)0 330 y(REAL\(SP\),)d
(INTENT\(OUT\))g(::)j(xmin)0 367 y(REAL\(SP\))e(::)i(brent)0
405 y(INTERFACE)66 442 y(FUNCTION)e(func\(x\))66 479 y(USE)i(nrtype)66
517 y(IMPLICIT)e(NONE)66 554 y(REAL\(SP\),)g(INTENT\(IN\))f(::)j(x)66
591 y(REAL\(SP\))e(::)i(func)66 629 y(END)g(FUNCTION)e(func)0
666 y(END)i(INTERFACE)0 703 y(INTEGER\(I4)o(B\),)d(PARAMETER)g(::)j
(ITMAX=100)0 741 y(REAL\(SP\),)d(PARAMETER)h(::)i(CGOLD=0.38)o(19)o(660)o
(_sp)o(,ZE)o(PS=)o(1.)o(0e-)o(3_s)o(p*e)o(psi)o(lo)o(n\(a)o(x\))58
778 y Fn(Given)11 b(a)f(function)h Fm(func)n Fn(,)g(and)f(given)h(a)g(b)o
(rack)o(eting)f(triplet)h(of)f(abscissas)e Fm(ax)p Fn(,)i Fm(bx)o
Fn(,)h Fm(cx)f Fn(\(such)f(that)i Fm(bx)58 816 y Fn(is)j(b)q(et)o(w)o(een)f
Fm(ax)g Fn(and)h Fm(cx)o Fn(,)g(and)g Fm(func\(bx\))d Fn(is)i(less)g(than)h
(b)q(oth)g Fm(func\(ax\))c Fn(and)k Fm(func\(cx\))m Fn(\),)g(this)58
853 y(routine)e(isolates)f(the)h(minimum)h(to)e(a)h(fractional)g(p)o
(recision)g(of)f(ab)q(out)h Fm(tol)f Fn(using)h(Brent's)e(metho)q(d.)58
890 y(The)17 b(abscissa)e(of)h(the)g(minimum)h(is)g(returned)f(as)g
Fm(xmin)n Fn(,)i(and)f(the)f(minimum)i(function)e(value)h(is)58
928 y(returned)12 b(as)f Fm(brent)n Fn(,)h(the)f(returned)h(function)f
(value.)58 965 y(P)o(a)o(rameters:)16 b(Maximum)11 b(allo)o(w)o(ed)f(numb)q
(er)h(of)f(iterations;)g(golden)g(ratio;)g(and)h(a)f(small)g(numb)q(er)h
(that)58 1002 y(p)o(rotects)i(against)h(trying)g(to)g(achieve)g(fractional)h
(accuracy)f(fo)o(r)g(a)g(minimum)i(that)e(happ)q(ens)g(to)g(b)q(e)58
1040 y(exactly)j(zero.)0 1077 y Fo(INTEGER\(I4)o(B\))d(::)j(iter)0
1114 y(REAL\(SP\))e(::)i(a,b,d,e,e)o(tem)o(p,f)o(u,f)o(v,f)o(w,)o(fx,)o(p,q)o
(,r,)o(tol)o(1,)o(tol)o(2,u)o(,v,)o(w,x)o(,x)o(m)0 1152 y(a=min\(ax,c)o(x\))
520 b(a)12 b Fn(and)h Fo(b)f Fn(must)g(b)q(e)g(in)h(ascending)f(o)o(rder,)g
(though)795 1189 y(the)g(input)h(abscissas)d(need)i(not)g(b)q(e.)-1270
b Fo(b=max\(ax,c)o(x\))0 1227 y(v=bx)663 b Fn(Initializations...)0
1264 y Fo(w=v)0 1301 y(x=v)0 1339 y(e=0.0)645 b Fn(This)13
b(will)g(b)q(e)f(the)g(distance)g(moved)g(on)g(the)g(step)795
1376 y(b)q(efo)o(re)h(last.)-961 b Fo(fx=func\(x\))0 1413 y(fv=fx)0
1451 y(fw=fx)0 1488 y(do)17 b(iter=1,ITM)o(AX)467 b Fn(Main)14
b(p)o(rogram)e(lo)q(op.)66 1525 y Fo(xm=0.5_sp*\()o(a+b)o(\))66
1563 y(tol1=tol*ab)o(s\(x)o(\)+Z)o(EPS)66 1600 y(tol2=2.0_sp)o(*to)o(l1)66
1637 y(if)17 b(\(abs\(x-xm\))d(<=)j(\(tol2-0.5_s)o(p*\()o(b-a)o(\)\)\))d
(then)106 b Fn(T)m(est)12 b(fo)o(r)g(done)g(here.)133 1675
y Fo(xmin=x)494 b Fn(Arrive)12 b(here)f(ready)h(to)g(exit)f(with)i(b)q(est)e
(values.)133 1712 y Fo(brent=fx)133 1750 y(RETURN)66 1787 y(end)17
b(if)66 1824 y(if)g(\(abs\(e\))e(>)j(tol1\))e(then)261 b Fn(Construct)11
b(a)h(trial)i(pa)o(rab)q(olic)f(\014t.)133 1862 y Fo(r=\(x-w\)*\(f)o(x-f)o
(v\))133 1899 y(q=\(x-v\)*\(f)o(x-f)o(w\))133 1936 y(p=\(x-v\)*q-)o(\(x-)o
(w\))o(*r)133 1974 y(q=2.0_sp*\()o(q-r)o(\))133 2011 y(if)k(\(q)g(>)g(0.0\))f
(p=-p)133 2048 y(q=abs\(q\))133 2086 y(etemp=e)133 2123 y(e=d)133
2161 y(if)h(\(abs\(p\))e(>=)i(abs\(0.5_sp)o(*q*)o(et)o(emp)o(\))e(.or.)h(&)
199 2198 y(p)i(<=)e(q*\(a-x\))g(.or.)g(p)h(>=)g(q*\(b-x\)\))e(then)232
2235 y Fn(The)c(ab)q(ove)f(conditions)h(determine)f(the)g(acceptabilit)o(y)h
(of)g(the)f(pa)o(rab)q(olic)h(\014t.)17 b(Here)10 b(it)h(is)232
2273 y(not)e(o.k.,)g(so)f(w)o(e)h(tak)o(e)g(the)g(golden)g(section)f(step)g
(into)i(the)e(la)o(rger)h(of)g(the)g(t)o(w)o(o)f(segments.)199
2310 y Fo(e=merge\(a-x)o(,b-)o(x,)14 b(x)j(>=)g(xm)g(\))199
2347 y(d=CGOLD*e)133 2385 y(else)530 b Fn(T)m(ak)o(e)13 b(the)g(pa)o(rab)q
(olic)g(step.)199 2422 y Fo(d=p/q)199 2459 y(u=x+d)199 2497
y(if)k(\(u-a)f(<)i(tol2)e(.or.)g(b-u)h(<)g(tol2\))f(d=sign\(tol)o(1,x)o(m-)o
(x\))133 2534 y(end)g(if)p eop
%%Page: 1205 5
bop 154 50 a Fj(Chapter)10 b(B10.)37 b(Minimization)11 b(or)g(Maximization)f
(of)h(Functions)188 b Fk(1205)p 0 68 1395 2 v 0 143 a @beginspecial
@setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 66 180 a Fo(else)597 b Fn(T)m(ak)o(e)13
b(the)g(golden)g(section)f(step)g(into)h(the)g(la)o(rger)795
218 y(of)f(the)h(t)o(w)o(o)f(segments.)-975 b Fo(e=merge\(a-)o(x,b)o(-x)o(,)
15 b(x)i(>=)g(xm)g(\))133 255 y(d=CGOLD*e)66 293 y(end)g(if)66
330 y(u=merge\(x+d)o(,x+)o(sig)o(n\(t)o(ol1)o(,d)o(\),)d(abs\(d\))i(>=)h
(tol1)f(\))100 367 y Fn(Arrive)c(here)f(with)i Fo(d)e Fn(computed)h(either)g
(from)f(pa)o(rab)q(olic)i(\014t,)e(o)o(r)h(else)f(from)h(golden)g(section.)66
405 y Fo(fu=func\(u\))100 442 y Fn(This)i(is)g(the)g(one)f(function)h
(evaluation)h(p)q(er)f(iteration.)66 479 y Fo(if)j(\(fu)g(<=)g(fx\))f(then)
350 b Fn(No)o(w)12 b(w)o(e)f(have)i(to)e(decide)h(what)g(to)f(do)h(with)h
(our)795 517 y(function)8 b(evaluation.)18 b(Housek)o(eeping)7
b(follo)o(ws:)-1285 b Fo(if)17 b(\(u)g(>=)g(x\))g(then)199
554 y(a=x)133 591 y(else)199 629 y(b=x)133 666 y(end)f(if)133
703 y(call)g(shft\(v,w,x)o(,u\))133 741 y(call)g(shft\(fv,fw)o(,fx)o(,fu)o
(\))66 778 y(else)133 816 y(if)h(\(u)g(<)g(x\))g(then)199 853
y(a=u)133 890 y(else)199 928 y(b=u)133 965 y(end)f(if)133 1002
y(if)h(\(fu)f(<=)h(fw)g(.or.)f(w)i(==)f(x\))g(then)199 1040
y(v=w)199 1077 y(fv=fw)199 1114 y(w=u)199 1152 y(fw=fu)133
1189 y(else)f(if)h(\(fu)g(<=)f(fv)h(.or.)g(v)g(==)g(x)g(.or.)f(v)i(==)f(w\))f
(then)199 1227 y(v=u)199 1264 y(fv=fu)133 1301 y(end)g(if)66
1339 y(end)h(if)0 1376 y(end)g(do)628 b Fn(Done)16 b(with)h(housek)o(eeping.)
g(Back)f(fo)o(r)g(another)915 1413 y(iteration.)-1048 b Fo(call)16
b(nrerror\('br)o(ent)o(:)e(exceed)i(maximum)f(iterations')o(\))0
1451 y(CONTAINS)0 1505 y(SUBROUTINE)f(shft\(a,b,c)o(,d\))0
1542 y(REAL\(SP\),)g(INTENT\(OUT\))g(::)j(a)0 1579 y(REAL\(SP\),)d
(INTENT\(INOU)o(T\))g(::)j(b,c)0 1617 y(REAL\(SP\),)d(INTENT\(IN\))g(::)j(d)0
1654 y(a=b)0 1691 y(b=c)0 1729 y(c=d)0 1766 y(END)g(SUBROUTIN)o(E)e(shft)0
1804 y(END)i(FUNCTION)d(brent)574 1939 y Fh(?)92 b(?)g(?)0
2045 y Fo(FUNCTION)15 b(dbrent\(ax,)o(bx)o(,cx)o(,fu)o(nc,)o(dfu)o(nc)o(,to)o
(l,x)o(min)o(\))0 2082 y(USE)i(nrtype;)e(USE)h(nrutil,)f(ONLY)i(:)g(nrerror)0
2120 y(IMPLICIT)e(NONE)0 2157 y(REAL\(SP\),)f(INTENT\(IN\))g(::)j
(ax,bx,cx,to)o(l)0 2194 y(REAL\(SP\),)d(INTENT\(OUT\))g(::)j(xmin)0
2232 y(REAL\(SP\))e(::)i(dbrent)0 2269 y(INTERFACE)66 2306
y(FUNCTION)e(func\(x\))66 2344 y(USE)i(nrtype)66 2381 y(IMPLICIT)e(NONE)66
2419 y(REAL\(SP\),)g(INTENT\(IN\))f(::)j(x)66 2456 y(REAL\(SP\))e(::)i(func)
66 2493 y(END)g(FUNCTION)e(func)66 2547 y(FUNCTION)g(dfunc\(x\))p
eop
%%Page: 1206 6
bop 0 50 a Fk(1206)188 b Fj(Chapter)11 b(B10.)54 b(Minimization)11
b(or)g(Maximization)f(of)h(Functions)p 0 68 1395 2 v 0 143
a @beginspecial @setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 66 180 a Fo(USE)17
b(nrtype)66 218 y(IMPLICIT)e(NONE)66 255 y(REAL\(SP\),)g(INTENT\(IN\))f(::)j
(x)66 293 y(REAL\(SP\))e(::)i(dfunc)66 330 y(END)g(FUNCTION)e(dfunc)0
367 y(END)i(INTERFACE)0 405 y(INTEGER\(I4)o(B\),)d(PARAMETER)g(::)j
(ITMAX=100)0 442 y(REAL\(SP\),)d(PARAMETER)h(::)i(ZEPS=1.0e-)o(3_)o(sp*)o
(eps)o(ilo)o(n\(a)o(x\))58 479 y Fn(Given)12 b(a)g(function)g
Fm(func)f Fn(and)h(its)g(derivative)h(function)e Fm(dfunc)o
Fn(,)g(and)i(given)f(a)g(b)o(rack)o(eting)g(triplet)g(of)58
517 y(abscissas)e Fm(ax)o Fn(,)h Fm(bx)o Fn(,)h Fm(cx)e Fn([such)h(that)g
Fm(bx)g Fn(is)g(b)q(et)o(w)o(een)g Fm(ax)g Fn(and)g Fm(cx)p
Fn(,)g(and)g Fm(func\(bx\))e Fn(is)i(less)f(than)i(b)q(oth)58
554 y Fm(func\(ax\))f Fn(and)i Fm(func\(cx\))m Fn(],)h(this)g(routine)f
(isolates)f(the)i(minimum)g(to)f(a)h(fractional)f(p)o(recision)g(of)58
591 y(ab)q(out)h Fm(tol)e Fn(using)i(a)g(mo)q(di\014cation)g(of)f(Brent's)f
(metho)q(d)i(that)f(uses)g(derivatives.)18 b(The)c(abscissa)e(of)58
629 y(the)f(minimum)h(is)f(returned)g(as)f Fm(xmin)o Fn(,)h(and)g(the)f
(minimum)j(function)e(value)g(is)g(returned)g(as)f Fm(dbrent)n
Fn(,)58 666 y(the)i(returned)f(function)h(value.)58 703 y(P)o(a)o(rameters:)k
(Maximum)h(allo)o(w)o(ed)h(numb)q(er)f(of)f(iterations,)h(and)h(a)f(small)g
(numb)q(er)g(that)f(p)o(rotects)58 741 y(against)f(trying)h(to)f(achieve)g
(fractional)h(accuracy)f(fo)o(r)g(a)h(minimum)h(that)e(happ)q(ens)g(to)g(b)q
(e)h(exactly)58 778 y(zero.)0 816 y Fo(INTEGER\(I4)o(B\))e(::)j(iter)0
853 y(REAL\(SP\))e(::)i(a,b,d,d1,)o(d2,)o(du,)o(dv,)o(dw,)o(dx)o(,e,)o(fu,)o
(fv,)o(fw,)o(fx)o(,ol)o(de,)o(tol)o(1,t)o(ol)o(2,&)66 890 y(u,u1,u2,v,w)o
(,x,)o(xm)58 928 y Fn(Comments)e(follo)o(wing)i(will)h(p)q(oint)f(out)f(only)
i(di\013erences)d(from)h(the)h(routine)f Fm(brent)n Fn(.)i(Read)e(that)58
965 y(routine)h(\014rst.)0 1002 y Fo(LOGICAL)e(::)i(ok1,ok2)535
b Fn(Will)10 b(b)q(e)f(used)f(as)g(\015ags)f(fo)o(r)i(whether)f(p)o(ro-)915
1040 y(p)q(osed)f(steps)g(a)o(re)g(acceptable)g(o)o(r)h(not.)-1398
b Fo(a=min\(ax,c)o(x\))0 1077 y(b=max\(ax,c)o(x\))0 1114 y(v=bx)0
1152 y(w=v)0 1189 y(x=v)0 1227 y(e=0.0)0 1264 y(fx=func\(x\))0
1301 y(fv=fx)0 1339 y(fw=fx)0 1376 y(dx=dfunc\(x)o(\))658 b
Fn(All)10 b(our)g(housek)o(eeping)f(cho)o(res)f(a)o(re)i(dou-)915
1413 y(bled)k(b)o(y)g(the)f(necessit)o(y)f(of)h(moving)915
1451 y(derivative)i(values)e(a)o(round)i(as)e(w)o(ell)915 1488
y(as)f(function)g(values.)0 1413 y Fo(dv=dx)0 1451 y(dw=dx)0
1488 y(do)17 b(iter=1,ITM)o(AX)66 1525 y(xm=0.5_sp*\()o(a+b)o(\))66
1563 y(tol1=tol*ab)o(s\(x)o(\)+Z)o(EPS)66 1600 y(tol2=2.0_sp)o(*to)o(l1)66
1637 y(if)g(\(abs\(x-xm\))d(<=)j(\(tol2-0.5_s)o(p*\()o(b-a)o(\)\)\))d(exit)66
1675 y(if)j(\(abs\(e\))e(>)j(tol1\))e(then)133 1712 y(d1=2.0_sp*)o(\(b-)o
(a\))454 b Fn(Initialize)9 b(these)e Fo(d)p Fn('s)g(to)g(an)h(out-of-b)o
(rack)o(et)915 1750 y(value.)-867 b Fo(d2=d1)133 1787 y(if)17
b(\(dw)f(/=)h(dx\))g(d1=\(w-x\)*d)o(x/\()o(dx)o(-dw)o(\))137
b Fn(Secant)11 b(metho)q(d)g(with)i(each)e(p)q(oint.)133 1824
y Fo(if)17 b(\(dv)f(/=)h(dx\))g(d2=\(v-x\)*d)o(x/\()o(dx)o(-dv)o(\))166
1862 y Fn(Which)12 b(of)f(these)g(t)o(w)o(o)g(estimates)f(of)h
Fo(d)g Fn(shall)h(w)o(e)g(tak)o(e?)17 b(W)o(e)11 b(will)i(insist)e(that)h
(they)f(b)q(e)h(within)166 1899 y(the)h(b)o(rack)o(et,)f(and)i(on)e(the)h
(side)g(p)q(ointed)g(to)f(b)o(y)i(the)e(derivative)i(at)f Fo(x)o
Fn(:)133 1936 y Fo(u1=x+d1)133 1974 y(u2=x+d2)133 2011 y(ok1=\(\(a-u1)o
(\)*\()o(u1)o(-b\))h(>)j(0.0\))g(.and.)e(\(dx*d1)h(<=)h(0.0\))133
2048 y(ok2=\(\(a-u2)o(\)*\()o(u2)o(-b\))d(>)j(0.0\))g(.and.)e(\(dx*d2)h(<=)h
(0.0\))133 2086 y(olde=e)614 b Fn(Movement)11 b(on)h(the)f(step)g(b)q(efo)o
(re)g(last.)133 2123 y Fo(e=d)133 2161 y(if)17 b(\(ok1)f(.or.)g(ok2\))g(then)
333 b Fn(T)m(ak)o(e)18 b(only)h(an)g(acceptable)e Fo(d)p Fn(,)j(and)e(if)915
2198 y(b)q(oth)f(a)o(re)g(acceptable,)g(then)g(tak)o(e)975
2235 y(the)12 b(smallest)g(one.)199 2198 y Fo(if)17 b(\(ok1)f(.and.)g(ok2\))g
(then)266 2235 y(d=merge\(d)o(1,d)o(2,)e(abs\(d1\))h(<)j(abs\(d2\)\))199
2273 y(else)266 2310 y(d=merge\(d)o(1,d)o(2,o)o(k1\))199 2347
y(end)f(if)199 2385 y(if)g(\(abs\(d\))e(<=)i(abs\(0.5_sp*)o(old)o(e\)\))d
(then)266 2422 y(u=x+d)266 2459 y(if)j(\(u-a)f(<)h(tol2)f(.or.)h(b-u)f(<)h
(tol2\))f(&)332 2497 y(d=sign\(tol1)o(,x)o(m-x)o(\))199 2534
y(else)p eop
%%Page: 1207 7
bop 154 50 a Fj(Chapter)10 b(B10.)37 b(Minimization)11 b(or)g(Maximization)f
(of)h(Functions)188 b Fk(1207)p 0 68 1395 2 v 0 143 a @beginspecial
@setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 266 180 a Fo(e=merge\(a)o(,b,)14
b(dx)j(>=)g(0.0\)-x)299 218 y Fn(Decide)c(which)h(segment)d(b)o(y)j(the)f
(sign)f(of)h(the)g(derivative.)266 255 y Fo(d=0.5_sp*)o(e)410
b Fn(Bisect,)11 b(not)h(golden)g(section.)199 293 y Fo(end)17
b(if)133 330 y(else)199 367 y(e=merge\(a,b)o(,)e(dx)i(>=)f(0.0\)-x)199
405 y(d=0.5_sp*e)476 b Fn(Bisect,)11 b(not)h(golden)g(section.)133
442 y Fo(end)k(if)66 479 y(else)133 517 y(e=merge\(a,)o(b,)e(dx)j(>=)g
(0.0\)-x)133 554 y(d=0.5_sp*e)542 b Fn(Bisect,)11 b(not)h(golden)g(section.)
66 591 y Fo(end)17 b(if)66 629 y(if)g(\(abs\(d\))e(>=)i(tol1\))f(then)133
666 y(u=x+d)133 703 y(fu=func\(u\))66 741 y(else)133 778 y(u=x+sign\(t)o(ol1)
o(,d)o(\))133 816 y(fu=func\(u\))542 b Fn(If)12 b(the)g(minimum)h(step)e(in)i
(the)f(do)o(wnhill)915 853 y(direction)d(tak)o(es)f(us)g(uphill,)j(then)e(w)o
(e)915 890 y(a)o(re)k(done.)133 853 y Fo(if)k(\(fu)f(>)i(fx\))e(exit)66
890 y(end)h(if)66 928 y(du=dfunc\(u\))591 b Fn(No)o(w)12 b(all)g(the)g
(housek)o(eeping,)f(sigh.)66 965 y Fo(if)17 b(\(fu)g(<=)g(fx\))f(then)133
1002 y(if)h(\(u)g(>=)g(x\))g(then)199 1040 y(a=x)133 1077 y(else)199
1114 y(b=x)133 1152 y(end)f(if)133 1189 y(call)g(mov3\(v,fv,)o(dv,)o(w,f)o
(w,d)o(w\))133 1227 y(call)g(mov3\(w,fw,)o(dw,)o(x,f)o(x,d)o(x\))133
1264 y(call)g(mov3\(x,fx,)o(dx,)o(u,f)o(u,d)o(u\))66 1301 y(else)133
1339 y(if)h(\(u)g(<)g(x\))g(then)199 1376 y(a=u)133 1413 y(else)199
1451 y(b=u)133 1488 y(end)f(if)133 1525 y(if)h(\(fu)f(<=)h(fw)g(.or.)f(w)i
(==)f(x\))g(then)199 1563 y(call)f(mov3\(v,fv,dv)o(,w)o(,fw)o(,dw)o(\))199
1600 y(call)g(mov3\(w,fw,dw)o(,u)o(,fu)o(,du)o(\))133 1637
y(else)g(if)h(\(fu)g(<=)f(fv)h(.or.)g(v)g(==)g(x)g(.or.)f(v)i(==)f(w\))f
(then)199 1675 y(call)g(mov3\(v,fv,dv)o(,u)o(,fu)o(,du)o(\))133
1712 y(end)g(if)66 1750 y(end)h(if)0 1787 y(end)g(do)0 1824
y(if)g(\(iter)f(>)h(ITMAX\))f(call)g(nrerror\('d)o(br)o(ent)o(:)f(exceeded)f
(maximum)i(iteration)o(s'\))0 1862 y(xmin=x)0 1899 y(dbrent=fx)0
1936 y(CONTAINS)0 1990 y(SUBROUTINE)e(mov3\(a,b,c)o(,d,)o(e,f)o(\))0
2028 y(REAL\(SP\),)g(INTENT\(IN\))g(::)j(d,e,f)0 2065 y(REAL\(SP\),)d
(INTENT\(OUT\))g(::)j(a,b,c)0 2102 y(a=d)0 2140 y(b=e)0 2177
y(c=f)0 2214 y(END)g(SUBROUTIN)o(E)e(mov3)0 2252 y(END)i(FUNCTION)d(dbrent)
574 2429 y Fh(?)92 b(?)g(?)p eop
%%Page: 1208 8
bop 0 50 a Fk(1208)188 b Fj(Chapter)11 b(B10.)54 b(Minimization)11
b(or)g(Maximization)f(of)h(Functions)p 0 68 1395 2 v 0 143
a @beginspecial @setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 37 x Fo(SUBROUTINE)j(amoeba\(p,y)o
(,ft)o(ol,)o(fun)o(c,i)o(te)o(r\))0 218 y(USE)j(nrtype;)e(USE)h(nrutil,)f
(ONLY)i(:)g(assert_eq,)o(ima)o(xlo)o(c,)o(imi)o(nlo)o(c,n)o(rer)o(ro)o(r,s)o
(wap)0 255 y(IMPLICIT)e(NONE)0 293 y(INTEGER\(I4)o(B\),)f(INTENT\(OUT)o(\))h
(::)i(iter)0 330 y(REAL\(SP\),)d(INTENT\(IN\))g(::)j(ftol)0
367 y(REAL\(SP\),)d(DIMENSION\(:)o(\),)g(INTENT\(INOU)o(T\))g(::)j(y)0
405 y(REAL\(SP\),)d(DIMENSION\(:)o(,:\))o(,)h(INTENT\(IN)o(OUT)o(\))g(::)i(p)
0 442 y(INTERFACE)66 479 y(FUNCTION)e(func\(x\))66 517 y(USE)i(nrtype)66
554 y(IMPLICIT)e(NONE)66 591 y(REAL\(SP\),)g(DIMENSION\()o(:\),)f
(INTENT\(IN\))g(::)j(x)66 629 y(REAL\(SP\))e(::)i(func)66 666
y(END)g(FUNCTION)e(func)0 703 y(END)i(INTERFACE)0 741 y(INTEGER\(I4)o(B\),)d
(PARAMETER)g(::)j(ITMAX=5000)0 778 y(REAL\(SP\),)d(PARAMETER)h(::)i
(TINY=1.0e-)o(10)58 816 y Fn(Minimization)g(of)f(the)f(function)h
Fm(func)e Fn(in)i Fl(N)j Fn(dimensions)d(b)o(y)g(the)f(do)o(wnhill)j(simplex)
e(metho)q(d)f(of)58 853 y(Nelder)d(and)h(Mead.)k(The)12 b Fg(\()p
Fl(N)f Fg(+)e(1\))e Ff(\002)h Fl(N)16 b Fn(matrix)d Fm(p)e
Fn(is)h(input.)19 b(Its)11 b Fl(N)g Fg(+)e(1)j Fn(ro)o(ws)f(a)o(re)h
Fl(N)t Fn(-dimensional)58 890 y(vecto)o(rs)h(that)h(a)o(re)g(the)g(vertices)f
(of)h(the)g(sta)o(rting)g(simplex.)k(Also)13 b(input)i(is)g(the)f(vecto)o(r)f
Fm(y)h Fn(of)g(length)58 928 y Fl(N)f Fg(+)d(1)p Fn(,)k(whose)g(comp)q
(onents)f(must)g(b)q(e)h(p)o(reinitialized)j(to)c(the)h(values)h(of)e
Fm(func)g Fn(evaluated)h(at)g(the)58 965 y Fl(N)e Fg(+)d(1)j
Fn(vertices)g(\(ro)o(ws\))f(of)h Fm(p)o Fn(;)h(and)g Fm(ftol)e
Fn(the)h(fractional)h(convergence)e(tolerance)g(to)h(b)q(e)h(achieved)58
1002 y(in)f(the)f(function)g(value)g(\(n.b.!\).)18 b(On)11
b(output,)g Fm(p)g Fn(and)g Fm(y)g Fn(will)h(have)g(b)q(een)f(reset)e(to)i
Fl(N)f Fg(+)d(1)k Fn(new)g(p)q(oints)58 1040 y(all)18 b(within)g
Fm(ftol)d Fn(of)h(a)h(minimum)h(function)f(value,)h(and)f Fm(iter)f
Fn(gives)g(the)g(numb)q(er)i(of)e(function)58 1077 y(evaluations)c(tak)o(en.)
58 1114 y(P)o(a)o(rameters:)k(The)c(maximum)g(allo)o(w)o(ed)h(numb)q(er)f(of)
f(function)h(evaluations,)g(and)g(a)g(small)g(numb)q(er.)0
1152 y Fo(INTEGER\(I4)o(B\))i(::)j(ihi,ndim)309 b Fn(Global)14
b(va)o(riables.)0 1189 y Fo(REAL\(SP\),)g(DIMENSION\(s)o(ize)o(\(p,)o(2\)\))g
(::)j(psum)0 1227 y(call)f(amoeba_priv)o(ate)0 1264 y(CONTAINS)0
1318 y(SUBROUTINE)e(amoeba_pri)o(vat)o(e)0 1355 y(IMPLICIT)h(NONE)0
1393 y(INTEGER\(I4)o(B\))f(::)j(i,ilo,inhi)0 1430 y(REAL\(SP\))e(::)i
(rtol,ysav)o(e,y)o(try)o(,yt)o(mp)0 1467 y(ndim=asser)o(t_e)o(q\(s)o(ize)o
(\(p)o(,2\))o(,si)o(ze\()o(p,1)o(\)-)o(1,s)o(ize)o(\(y\))o(-1,)o('a)o(moe)o
(ba')o(\))0 1505 y(iter=0)0 1542 y(psum\(:\)=su)o(m\(p)o(\(:,)o(:\),)o(di)o
(m=1)o(\))0 1579 y(do)699 b Fn(Iteration)13 b(lo)q(op.)66 1617
y Fo(ilo=iminloc)o(\(y\()o(:\)\))365 b Fn(Determine)8 b(which)h(p)q(oint)g
(is)f(the)g(highest)g(\(w)o(o)o(rst\),)795 1654 y(next-highest,)j(and)i(lo)o
(w)o(est)e(\(b)q(est\).)-1198 b Fo(ihi=imaxloc)o(\(y\()o(:\)\))66
1691 y(ytmp=y\(ihi\))66 1729 y(y\(ihi\)=y\(il)o(o\))66 1766
y(inhi=imaxlo)o(c\(y)o(\(:\))o(\))66 1804 y(y\(ihi\)=ytmp)66
1841 y(rtol=2.0_sp)o(*ab)o(s\(y)o(\(ih)o(i\)-)o(y\()o(ilo)o(\)\)/)o(\(ab)o
(s\(y)o(\(i)o(hi\))o(\)+a)o(bs\()o(y\(i)o(lo)o(\)\)+)o(TIN)o(Y\))100
1878 y Fn(Compute)11 b(the)h(fractional)g(range)g(from)f(highest)h(to)g(lo)o
(w)o(est)f(and)i(return)f(if)h(satisfacto)o(ry)m(.)66 1916
y Fo(if)k(\(rtol)f(<)h(ftol\))f(then)297 b Fn(If)11 b(returning,)h(put)g(b)q
(est)f(p)q(oint)h(and)g(value)g(in)g(slot)795 1953 y(1.)-690
b Fo(call)16 b(swap\(y\(1\),)o(y\(i)o(lo\))o(\))133 1990 y(call)g
(swap\(p\(1,:)o(\),p)o(\(il)o(o,:)o(\)\))133 2028 y(RETURN)66
2065 y(end)h(if)66 2102 y(if)g(\(iter)f(>=)h(ITMAX\))f(call)g(nrerror\('I)o
(TMA)o(X)e(exceeded)h(in)i(amoeba'\))100 2140 y Fn(Begin)11
b(a)h(new)h(iteration.)k(First)12 b(extrap)q(olate)g(b)o(y)g(a)g(facto)o(r)f
Ff(\000)p Fg(1)i Fn(through)f(the)f(face)h(of)f(the)h(simplex)100
2177 y(across)f(from)h(the)g(high)h(p)q(oint,)g(i.e.,)f(re\015ect)g(the)g
(simplex)h(from)f(the)h(high)g(p)q(oint.)66 2214 y Fo(ytry=amotry)o(\(-1)o
(.0_)o(sp\))66 2252 y(iter=iter+1)66 2289 y(if)k(\(ytry)f(<=)h(y\(ilo\)\))e
(then)244 b Fn(Gives)12 b(a)g(result)f(b)q(etter)h(than)g(the)g(b)q(est)f(p)q
(oint,)h(so)795 2327 y(try)g(an)g(additional)i(extrap)q(olation)e(b)o(y)g(a)g
(fac-)795 2364 y(to)o(r)h(of)g Fg(2)p Fn(.)133 2327 y Fo(ytry=amotr)o(y\(2)o
(.0)o(_sp)o(\))133 2364 y(iter=iter+)o(1)66 2401 y(else)k(if)g(\(ytry)e(>=)i
(y\(inhi\)\))e(then)138 b Fn(The)17 b(re\015ected)f(p)q(oint)h(is)h(w)o(o)o
(rse)e(than)h(the)g(sec-)795 2439 y(ond)12 b(highest,)g(so)f(lo)q(ok)h(fo)o
(r)f(an)i(intermediate)795 2476 y(lo)o(w)o(er)k(p)q(oint,)i(i.e.,)e(do)g(a)g
(one-dimensional)795 2513 y(contraction.)133 2439 y Fo(ysave=y\(ih)o(i\))133
2476 y(ytry=amotr)o(y\(0)o(.5)o(_sp)o(\))133 2513 y(iter=iter+)o(1)p
eop
%%Page: 1209 9
bop 154 50 a Fj(Chapter)11 b(B10.)37 b(Minimization)11 b(or)g(Maximization)f
(of)g(Functions)195 b Fk(1209)p 0 68 1395 2 v 0 143 a @beginspecial
@setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 133 180 a Fo(if)17 b(\(ytry)f(>=)h(ysave\))e(then)
232 218 y Fn(Can't)g(seem)g(to)g(get)g(rid)h(of)f(that)g(high)h(p)q(oint.)i
(Better)c(contract)g(a)o(round)i(the)g(lo)o(w)o(est)232 255
y(\(b)q(est\))f(p)q(oint.)199 293 y Fo(p\(:,:\)=0.5_)o(sp*)o(\(p\()o(:,)o
(:\)+)o(spr)o(ead)o(\(p\()o(il)o(o,:)o(\),1)o(,si)o(ze\()o(p,)o(1\)\))o(\))
199 330 y(do)i(i=1,ndim+1)266 367 y(if)g(\(i)g(/=)f(ilo\))h(y\(i\)=func)o
(\(p\()o(i,:)o(\)\))199 405 y(end)g(do)199 442 y(iter=iter+n)o(dim)285
b Fn(Keep)11 b(track)h(of)g(function)g(evaluations.)199 479
y Fo(psum\(:\)=sum)o(\(p\()o(:,:)o(\),)o(dim)o(=1\))133 517
y(end)k(if)66 554 y(end)h(if)0 591 y(end)g(do)628 b Fn(Go)8
b(back)h(fo)o(r)f(the)h(test)e(of)h(doneness)g(and)h(the)g(next)795
629 y(iteration.)-928 b Fo(END)17 b(SUBROUTIN)o(E)e(amoeba_pr)o(iva)o(te)0
683 y(FUNCTION)g(amotry\(fac)o(\))0 720 y(IMPLICIT)g(NONE)0
757 y(REAL\(SP\),)f(INTENT\(IN\))g(::)j(fac)0 795 y(REAL\(SP\))e(::)i(amotry)
58 832 y Fn(Extrap)q(olates)c(b)o(y)h(a)f(facto)o(r)g Fm(fac)f
Fn(through)h(the)g(face)g(of)g(the)g(simplex)h(across)e(from)h(the)g(high)h
(p)q(oint,)58 870 y(tries)f(it,)h(and)g(replaces)e(the)i(high)g(p)q(oint)f
(if)h(the)f(new)g(p)q(oint)h(is)g(b)q(etter.)0 907 y Fo(REAL\(SP\))h(::)i
(fac1,fac2)o(,yt)o(ry)0 944 y(REAL\(SP\),)d(DIMENSION\(s)o(ize)o(\(p,)o
(2\)\))g(::)j(ptry)0 982 y(fac1=\(1.0_)o(sp-)o(fac)o(\)/n)o(di)o(m)0
1019 y(fac2=fac1-)o(fac)0 1056 y(ptry\(:\)=ps)o(um\()o(:\)*)o(fac)o(1-)o
(p\(i)o(hi,)o(:\)*)o(fac)o(2)0 1094 y(ytry=func\()o(ptr)o(y\))467
b Fn(Evaluate)12 b(the)g(function)g(at)g(the)f(trial)i(p)q(oint.)0
1131 y Fo(if)k(\(ytry)f(<)h(y\(ihi\)\))e(then)328 b Fn(If)14
b(it's)h(b)q(etter)e(than)i(the)g(highest,)f(then)h(replace)795
1168 y(the)e(highest.)-904 b Fo(y\(ihi\)=ytry)66 1206 y(psum\(:\)=psu)o(m\(:)
o(\)-p)o(\(ih)o(i,:)o(\)+)o(ptr)o(y\(:)o(\))66 1243 y(p\(ihi,:\)=pt)o(ry\()o
(:\))0 1280 y(end)17 b(if)0 1318 y(amotry=ytr)o(y)0 1355 y(END)g(FUNCTION)d
(amotry)0 1393 y(END)j(SUBROUTIN)o(E)e(amoeba)187 1501 y @beginspecial
@setspecial
 /oshow {true charpath gsave 1 setgray fill grestore stroke} def gsave
0.5 setgray -40 -20 translate .8 .8 scale /NewCenturySchlbk-Bold findfont
40 scalefont setfont 2 1 scale 0 0 moveto (f) show /Helvetica-Narrow
findfont 24 scalefont setfont 0.5 1 scale 23 1 moveto (90) show grestore 
@endspecial Fk(The)h(only)e(action)g(taken)h(by)g(the)g
(subroutine)e Fi(amoeba)h Fk(is)h(to)g(call)g(the)g(internal)187
1551 y(subroutine)9 b Fi(amoeba)p 505 1551 22 4 v 22 w(private)m
Fk(.)17 b(Why)11 b(this)f(structure?)17 b(The)11 b(reason)h(has)f(to)f(do)187
1601 y(with)i(meeting)i(the)g(twin)e(goals)i(of)f(data)h(hiding)e
(\(especially)i(for)f(\252safe\272)i(scope)0 1651 y(of)10 b(variables\))h
(and)g(program)f(readability)m(.)16 b(The)11 b(situation)e(is)i(this:)j
(Logically)m(,)d Fi(amoeba)f Fk(does)0 1700 y(most)i(of)f(the)h(calculating,)
g(but)f(calls)i(an)f(internal)f(subroutine)f Fi(amotry)h Fk(at)h(several)h
(dif)o(ferent)0 1750 y(points,)j(with)f(several)i(values)f(of)f(the)h
(parameter)h Fi(fac)o Fk(.)33 b(However)n(,)18 b Fi(fac)d Fk(is)h(not)f(the)h
(only)0 1800 y(piece)10 b(of)f(data)h(that)f(must)g(be)h(shared)g(with)e
Fi(amotry)o Fk(;)h(the)g(latter)g(also)h(needs)g(access)h(to)e(several)0
1850 y(shared)j(variables)f(\()p Fi(ihi)p Fk(,)h Fi(ndim)o
Fk(,)g Fi(psum)o Fk(\))g(and)f(ar)o(guments)h(of)f Fi(amoeba)f
Fk(\()p Fi(p)p Fk(,)i Fi(y)p Fk(,)g Fi(func)p Fk(\).)83 1900
y(The)d(obvious)e(\(but)h(not)g(best\))g(way)h(of)f(coding)g(this)g(would)f
(be)i(to)f(put)g(the)g(computational)0 1949 y(guts)k(in)g Fi(amoeba)o
Fk(,)i(with)d Fi(amotry)h Fk(as)h(the)g(sole)g(internal)e(subprogram.)22
b(Assuming)12 b(that)g Fi(fac)0 1999 y Fk(is)j(passed)h(as)h(an)e(ar)o
(gument)h(to)f Fi(amotry)f Fk(\(it)h(being)f(the)i(parameter)g(that)f(is)g
(being)g(rapidly)0 2049 y(altered\),)g(one)f(must)f(decide)i(whether)e(to)g
(pass)i(all)e(the)h(other)f(quantities)f(to)h Fi(amotry)g Fk(\(i\))g(as)0
2099 y(additional)e(ar)o(guments)h(\(as)h(is)f(done)h(in)e(the)i(Fortran)e
(77)h(version\),)h(or)f(\(ii\))f(\252automatically)m(,\272)0
2149 y(i.e.,)k(doing)c(nothing)g(except)i(using)f(the)h(fact)g(that)f(an)h
(internal)f(subprogram)g(has)h(automatic)0 2199 y(access)i(to)e(all)g(of)g
(its)f(host')n(s)h(entities.)23 b(Each)14 b(of)f(these)h(choices)g(has)f
(strong)g(disadvantages.)0 2248 y(Choice)f(\(i\))g(is)g(inef)o(\256cient)g
(\(all)f(those)h(ar)o(guments\))h(and)f(also)g(obscures)h(the)f(fact)h(that)e
Fi(fac)h Fk(is)0 2298 y(the)c(primary)g(changing)g(ar)o(gument.)15
b(Choice)8 b(\(ii\))f(makes)i(the)g(program)f(extremely)g(dif)o(\256cult)f
(to)0 2348 y(read,)i(because)g(it)e(wouldn')o(t)f(be)h(obvious)g(without)e
(careful)j(cross-comparison)f(of)h(the)f(routines)0 2398 y
Fe(which)j Fk(variables)h(in)f Fi(amoeba)f Fk(are)j(actually)e(global)f
(variables)i(that)f(are)i(used)f(by)f Fi(amotry)o Fk(.)83 2448
y(Choice)g(\(ii\))g(is)g(also)h(\252unsafe)g(scoping\272)f(because)i(it)e
(gives)g(a)h(nontrivially)d(complicated)0 2497 y(internal)15
b(subprogram,)i Fi(amotry)o Fk(,)h(access)g(to)d(all)h(the)f(variables)h(in)g
(its)f(host.)31 b(A)16 b(common)0 2547 y(and)c(dif)o(\256cult-to-\256nd)d
(bug)i(is)g(the)h(accidental)g(alteration)e(of)i(a)g(variable)f(that)g(one)h
(\252thought\272)p eop
%%Page: 1210 10
bop 0 50 a Fk(1210)188 b Fj(Chapter)11 b(B10.)54 b(Minimization)11
b(or)g(Maximization)f(of)h(Functions)p 0 68 1395 2 v 0 143
a @beginspecial @setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 46 x Fk(was)k(local,)h(but)e(is)g
(actually)g(shared.)29 b(\(Simple)14 b(variables)g(like)g Fi(i)p
Fk(,)i Fi(j)p Fk(,)g(and)f Fi(n)f Fk(are)i(the)e(most)0 239
y(common)20 b(culprits.\))83 288 y(W)m(e)8 b(are)g(therefore)g(led)f(to)g
(reject)h(both)f(choice)h(\(i\))f(and)g(choice)h(\(ii\))f(in)g(favor)g(of)g
(a)i(structure)0 338 y(previously)d(described)j(in)e(the)h(subsection)g(on)f
(Scope,)j(V)n(isibilit)o(y)m(,)d(and)h(Data)g(Hiding)f(in)g
Fd(x)q Fk(21.5.)0 388 y(The)k(guts)f(of)h Fi(amoeba)e Fk(are)i(put)f(in)g
Fi(amoeba)p 642 388 22 4 v 22 w(private)m Fk(,)i(a)f Fe(sister)f(r)n(outine)g
Fk(to)g Fi(amotry)o Fk(.)17 b(These)0 438 y(two)12 b(siblings)f(have)i
(mutually)e(private)h(name)i(spaces.)23 b(However)n(,)14 b(any)f(variables)f
(that)g(they)0 488 y(need)d(to)e(share)i(\(including)d(the)j(top-level)d(ar)o
(guments)j(of)f Fi(amoeba)o Fk(\))g(are)h(declared)g(as)g(variables)0
537 y(in)h(the)h(enclosing)f Fi(amoeba)f Fk(routine.)16 b(The)11
b(presence)h(of)e(these)h(\252global)g(variables\272)g(serves)g(as)0
587 y(a)i(warning)f(\257ag)h(to)f(the)h(reader)h(that)e(data)h(are)g(shared)g
(between)h(routines.)83 637 y(An)i(alternative)f(attractive)g(way)h(of)g
(coding)f(the)g(above)h(situation)e(would)h(be)h(to)f(use)0
687 y(a)g(module)g(containing)e Fi(amoeba)g Fk(and)i Fi(amotry)o
Fk(.)28 b(Everything)14 b(would)f(be)i(declared)g(private)0
737 y(except)k(the)e(name)j Fi(amoeba)n Fk(.)39 b(The)19 b(global)e
(variables)h(would)f(be)h(at)g(the)g(top)g(level,)i(and)0 786
y(the)14 b(ar)o(guments)h(of)f Fi(amoeba)g Fk(that)g(need)h(to)f(be)g(passed)
i(to)e Fi(amotry)f Fk(would)g(be)i(handled)f(by)0 836 y(pointers)h(among)g
(the)h(global)f(variables.)31 b(Unfortunately)m(,)16 b(Fortran)f(90)g(does)h
(not)f(support)0 886 y(pointers)i(to)h(functions.)38 b(Sigh!)101
963 y Fo(ilo=iminl)o(oc.)o(..i)o(hi=)o(ima)o(xl)o(oc.)o(..)g
Fk(See)12 b(discussion)d(of)h(these)h(functions)e(on)h(p.)g(1017.)101
1040 y Fo(call)16 b(swap\(y\(1\).)o(..c)o(all)e(swap\(p\(1,:)o(\)..)o(.)38
b Fk(Here)16 b(the)f Fi(swap)f Fk(routine)g(in)g Fi(nrutil)g
Fk(is)0 1090 y(called)c(once)h(with)e(a)i(scalar)g(ar)o(gument)g(and)f(once)h
(with)e(a)i(vector)f(ar)o(gument.)15 b(Inside)10 b Fi(nrutil)0
1140 y Fk(scalar)i(and)g(vector)f(versions)g(have)g(been)h(overloaded)f(onto)
f(the)h(single)g(name)h Fi(swap)p Fk(,)g(hiding)0 1190 y(all)i(the)g
(implementation)f(details)h(from)g(the)h(calling)e(routine.)574
1268 y Fh(?)92 b(?)g(?)0 1389 y Fo(SUBROUTINE)14 b(powell\(p,x)o(i,f)o(tol)o
(,it)o(er,)o(fr)o(et\))0 1426 y(USE)j(nrtype;)e(USE)h(nrutil,)f(ONLY)i(:)g
(assert_eq,)o(nre)o(rro)o(r)0 1464 y(USE)g(nr,)f(ONLY)g(:)i(linmin)0
1501 y(IMPLICIT)d(NONE)0 1539 y(REAL\(SP\),)f(DIMENSION\(:)o(\),)g
(INTENT\(INOU)o(T\))g(::)j(p)0 1576 y(REAL\(SP\),)d(DIMENSION\(:)o(,:\))o(,)h
(INTENT\(IN)o(OUT)o(\))g(::)i(xi)0 1613 y(INTEGER\(I4)o(B\),)d(INTENT\(OUT)o
(\))h(::)i(iter)0 1651 y(REAL\(SP\),)d(INTENT\(IN\))g(::)j(ftol)0
1688 y(REAL\(SP\),)d(INTENT\(OUT\))g(::)j(fret)0 1725 y(INTERFACE)66
1763 y(FUNCTION)e(func\(p\))66 1800 y(USE)i(nrtype)66 1837
y(IMPLICIT)e(NONE)66 1875 y(REAL\(SP\),)g(DIMENSION\()o(:\),)f(INTENT\(IN\))g
(::)j(p)66 1912 y(REAL\(SP\))e(::)i(func)66 1949 y(END)g(FUNCTION)e(func)0
1987 y(END)i(INTERFACE)0 2024 y(INTEGER\(I4)o(B\),)d(PARAMETER)g(::)j
(ITMAX=200)0 2062 y(REAL\(SP\),)d(PARAMETER)h(::)i(TINY=1.0e-)o(25)o(_sp)58
2099 y Fn(Minimization)f(of)d(a)i(function)f Fm(func)e Fn(of)i
Fl(N)k Fn(va)o(riables.)f(\()p Fm(func)c Fn(is)h(not)g(an)g(a)o(rgument,)g
(it)g(is)h(a)f(\014xed)58 2136 y(function)j(name.\))g(Input)g(consists)f(of)g
(an)h(initial)i(sta)o(rting)d(p)q(oint)h Fm(p)p Fn(,)h(a)f(vecto)o(r)f(of)h
(length)g Fl(N)t Fn(;)i(an)58 2174 y(initial)14 b Fl(N)d Ff(\002)e
Fl(N)15 b Fn(matrix)d Fm(xi)g Fn(whose)f(columns)g(contain)h(the)g(initial)h
(set)e(of)g(directions)h(\(usually)h(the)e Fl(N)58 2211 y Fn(unit)i(vecto)o
(rs\);)f(and)h Fm(ftol)n Fn(,)g(the)f(fractional)h(tolerance)e(in)j(the)e
(function)g(value)i(such)e(that)g(failure)h(to)58 2248 y(decrease)e(b)o(y)i
(mo)o(re)f(than)h(this)f(amount)h(on)f(one)g(iteration)h(signals)f(doneness.)
k(On)d(output,)f Fm(p)g Fn(is)h(set)58 2286 y(to)e(the)g(b)q(est)g(p)q(oint)g
(found,)h Fm(xi)e Fn(is)i(the)f(then-current)f(direction)i(set,)e
Fm(fret)g Fn(is)h(the)h(returned)f(function)58 2323 y(value)h(at)g
Fm(p)o Fn(,)g(and)g Fm(iter)e Fn(is)i(the)g(numb)q(er)g(of)f(iterations)g
(tak)o(en.)17 b(The)12 b(routine)g Fm(linmin)d Fn(is)j(used.)58
2360 y(P)o(a)o(rameters:)k(Maximum)e(allo)o(w)o(ed)g(iterations,)f(and)h(a)f
(small)h(numb)q(er.)0 2398 y Fo(INTEGER\(I4)o(B\))g(::)j(i,ibig,n)0
2435 y(REAL\(SP\))e(::)i(del,fp,fp)o(tt,)o(t)0 2473 y(REAL\(SP\),)d
(DIMENSION\(s)o(ize)o(\(p\))o(\))h(::)i(pt,ptt,xi)o(t)0 2510
y(n=assert_e)o(q\(s)o(ize)o(\(p\))o(,s)o(ize)o(\(xi)o(,1\))o(,si)o(ze)o(\(xi)
o(,2\))o(,'p)o(owe)o(ll)o('\))0 2547 y(fret=func\()o(p\))p
eop
%%Page: 1211 11
bop 154 50 a Fj(Chapter)10 b(B10.)37 b(Minimization)11 b(or)g(Maximization)f
(of)h(Functions)188 b Fk(1211)p 0 68 1395 2 v 0 143 a @beginspecial
@setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 37 x Fo(pt\(:\)=p\(:\))555 b Fn(Save)13
b(the)f(initial)j(p)q(oint.)0 218 y Fo(iter=0)0 255 y(do)66
293 y(iter=iter+1)66 330 y(fp=fret)66 367 y(ibig=0)66 405 y(del=0.0)543
b Fn(Will)14 b(b)q(e)e(the)f(biggest)g(function)h(decrease.)66
442 y Fo(do)17 b(i=1,n)526 b Fn(Lo)q(op)12 b(over)g(all)h(directions)f(in)h
(the)f(set.)133 479 y Fo(xit\(:\)=xi\()o(:,i)o(\))352 b Fn(Cop)o(y)13
b(the)g(direction,)133 517 y Fo(fptt=fret)133 554 y(call)j(linmin\(p,x)o(it,)
o(fre)o(t\))193 b Fn(minimize)15 b(along)e(it,)133 591 y Fo(if)k(\(fptt-fret)
d(>)j(del\))f(then)160 b Fn(and)15 b(reco)o(rd)e(it)h(if)h(it)f(is)g(the)g
(la)o(rgest)f(decrease)f(so)795 629 y(fa)o(r.)-645 b Fo(del=fptt-fr)o(et)199
666 y(ibig=i)133 703 y(end)16 b(if)66 741 y(end)h(do)66 778
y(if)g(\(2.0_sp*\(fp)o(-fr)o(et\))d(<=)j(ftol*\(abs\()o(fp\))o(+a)o(bs\()o
(fre)o(t\)\))o(+TI)o(NY)o(\))e(RETURN)100 816 y Fn(T)m(ermination)h
(criterion.)66 853 y Fo(if)h(\(iter)f(==)h(ITMAX\))f(call)g(&)133
890 y(nrerror\('p)o(owe)o(ll)e(exceeding)h(maximum)g(iteration)o(s'\))66
928 y(ptt\(:\)=2.0_)o(sp*)o(p\(:)o(\)-p)o(t\(:)o(\))242 b Fn(Construct)8
b(the)h(extrap)q(olated)g(p)q(oint)h(and)g(the)f(av-)795 965
y(erage)e(direction)h(moved.)17 b(Save)7 b(the)h(old)g(sta)o(rt-)795
1002 y(ing)14 b(p)q(oint.)66 965 y Fo(xit\(:\)=p\(:\))o(-pt)o(\(:\))66
1002 y(pt\(:\)=p\(:\))66 1040 y(fptt=func\(p)o(tt\))418 b Fn(F)o(unction)12
b(value)h(at)f(extrap)q(olated)g(p)q(oint.)66 1077 y Fo(if)17
b(\(fptt)f(>=)h(fp\))g(cycle)296 b Fn(One)12 b(reason)f(not)h(to)g(use)f(new)
h(direction.)66 1114 y Fo(t=2.0_sp*\(f)o(p-2)o(.0_)o(sp*)o(fre)o(t+)o(fpt)o
(t\)*)o(\(fp)o(-fr)o(et)o(-de)o(l\)*)o(*2-)o(del)o(*\()o(fp-)o(fpt)o(t\)*)o
(*2)66 1152 y(if)17 b(\(t)g(>=)g(0.0\))f(cycle)332 b Fn(Other)12
b(reason)f(not)h(to)f(use)g(new)h(direction.)66 1189 y Fo(call)17
b(linmin\(p,)o(xit)o(,fr)o(et\))259 b Fn(Move)11 b(to)h(minimum)h(of)e(the)h
(new)g(direction,)66 1227 y Fo(xi\(:,ibig\)=)o(xi\()o(:,n)o(\))348
b Fn(and)13 b(save)f(the)h(new)f(direction.)66 1264 y Fo(xi\(:,n\)=xit)o
(\(:\))0 1301 y(end)17 b(do)628 b Fn(Back)12 b(fo)o(r)g(another)h(iteration.)
0 1339 y Fo(END)k(SUBROUTIN)o(E)e(powell)574 1485 y Fh(?)92
b(?)g(?)0 1604 y Fc(MODULE)19 b(f1dim_mod)176 b Fn(Used)12
b(fo)o(r)g(communication)g(from)g Fo(linmin)f Fn(to)g Fo(f1dim)o
Fn(.)0 1642 y Fo(USE)17 b(nrtype)0 1679 y(INTEGER\(I4)o(B\))d(::)j(ncom)0
1716 y(REAL\(SP\),)d(DIMENSION\(:)o(\),)g(POINTER)i(::)g(pcom,xicom)0
1754 y Fc(CONTAINS)0 1808 y Fo(FUNCTION)f(f1dim\(x\))0 1845
y(IMPLICIT)g(NONE)0 1882 y(REAL\(SP\),)f(INTENT\(IN\))g(::)j(x)0
1920 y(REAL\(SP\))e(::)i(f1dim)58 1957 y Fn(Used)12 b(b)o(y)h
Fm(linmin)d Fn(as)i(the)g(one-dimensional)g(function)g(passed)g(to)g
Fm(mnbrak)e Fn(and)i Fm(brent)o Fn(.)0 1994 y Fo(INTERFACE)66
2032 y(FUNCTION)j(func\(x\))66 2069 y(USE)i(nrtype)66 2107
y(REAL\(SP\),)e(DIMENSION\()o(:\),)f(INTENT\(IN\))g(::)j(x)66
2144 y(REAL\(SP\))e(::)i(func)66 2181 y(END)g(FUNCTION)e(func)0
2219 y(END)i(INTERFACE)0 2256 y(REAL\(SP\),)d(DIMENSION\(:)o(\),)g
(ALLOCATABLE)g(::)j(xt)0 2293 y(allocate\(x)o(t\(n)o(com)o(\)\))0
2331 y(xt\(:\)=pcom)o(\(:\))o(+x*)o(xic)o(om)o(\(:\))0 2368
y(f1dim=func)o(\(xt)o(\))0 2405 y(deallocate)o(\(xt)o(\))0
2443 y(END)g(FUNCTION)d(f1dim)0 2480 y Fc(END)20 b(MODULE)f(f1dim_mod)p
eop
%%Page: 1212 12
bop 0 50 a Fk(1212)188 b Fj(Chapter)11 b(B10.)54 b(Minimization)11
b(or)g(Maximization)f(of)h(Functions)p 0 68 1395 2 v 0 143
a @beginspecial @setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 37 x Fo(SUBROUTINE)j(linmin\(p,x)o
(i,f)o(ret)o(\))0 218 y(USE)j(nrtype;)e(USE)h(nrutil,)f(ONLY)i(:)g(assert_eq)
0 255 y(USE)g(nr,)f(ONLY)g(:)i(mnbrak,br)o(ent)0 293 y(USE)f(f1dim_mod)0
330 y(IMPLICIT)e(NONE)0 367 y(REAL\(SP\),)f(INTENT\(OUT\))g(::)j(fret)0
405 y(REAL\(SP\),)d(DIMENSION\(:)o(\),)g(TARGET,)i(INTENT\(IN)o(OUT)o(\))f
(::)h(p,xi)0 442 y(REAL\(SP\),)e(PARAMETER)h(::)i(TOL=1.0e-4)o(_s)o(p)58
479 y Fn(Given)11 b(an)g Fl(N)t Fn(-dimensional)f(p)q(oint)h
Fm(p)g Fn(and)g(an)g Fl(N)t Fn(-dimensional)f(direction)h Fm(xi)o
Fn(,)g(b)q(oth)f(vecto)o(rs)g(of)g(length)58 517 y Fl(N)t Fn(,)i(moves)f(and)
i(resets)d Fm(p)i Fn(to)f(where)h(the)g(\014xed-name)g(function)g
Fm(func)f Fn(tak)o(es)g(on)h(a)g(minimum)i(along)58 554 y(the)h(direction)h
Fm(xi)f Fn(from)g Fm(p)p Fn(,)h(and)g(replaces)f Fm(xi)g Fn(b)o(y)h(the)f
(actual)h(vecto)o(r)e(displacement)i(that)f Fm(p)g Fn(w)o(as)58
591 y(moved.)i(Also)10 b(returns)g(as)g Fm(fret)f Fn(the)h(value)h(of)f
Fm(func)f Fn(at)h(the)g(returned)h(lo)q(cation)f Fm(p)o Fn(.)18
b(This)11 b(is)f(actually)58 629 y(all)j(accomplished)e(b)o(y)h(calling)h
(the)e(routines)h Fm(mnbrak)d Fn(and)j Fm(brent)n Fn(.)58 666
y(P)o(a)o(rameter:)k(T)m(olerance)f(passed)f(to)g Fm(brent)n
Fn(.)0 703 y Fo(REAL\(SP\))h(::)i(ax,bx,fa,)o(fb,)o(fx,)o(xmi)o(n,x)o(x)0
741 y(ncom=asser)o(t_e)o(q\(s)o(ize)o(\(p)o(\),s)o(ize)o(\(xi)o(\),')o(li)o
(nmi)o(n'\))0 778 y(pcom=>p)369 b Fn(Communicate)12 b(the)g(global)h(va)o
(riables)g(to)f Fo(f1dim)o Fn(.)0 816 y Fo(xicom=>xi)0 853
y(ax=0.0)387 b Fn(Initial)15 b(guess)d(fo)o(r)i(b)o(rack)o(ets.)0
890 y Fo(xx=1.0)0 928 y(call)i(mnbrak\(ax,x)o(x,b)o(x,)o(fa,)o(fx,)o(fb,)o
(f1d)o(im)o(\))0 965 y(fret=brent)o(\(ax)o(,xx)o(,bx)o(,f)o(1di)o(m,T)o(OL,)o
(xmi)o(n\))0 1002 y(xi=xmin*xi)315 b Fn(Construct)11 b(the)i(vecto)o(r)f
(results)h(to)f(return.)0 1040 y Fo(p=p+xi)0 1077 y(END)17
b(SUBROUTIN)o(E)e(linmin)187 1215 y @beginspecial @setspecial
 /oshow {true charpath gsave 1 setgray fill grestore stroke} def gsave
0.5 setgray -40 -20 translate .8 .8 scale /NewCenturySchlbk-Bold findfont
40 scalefont setfont 2 1 scale 0 0 moveto (f) show /Helvetica-Narrow
findfont 24 scalefont setfont 0.5 1 scale 23 1 moveto (90) show grestore

@endspecial(USE)h(f1dim_mod)39 b Fk(At)20 b(\256rst)g(sight)g(this)g
(situation)f(is)h(like)g(the)h(one)g(involving)187 1265 y Fi(USE)g(fminln)16
b Fk(in)h Fi(newt)f Fk(on)h(p.)h(1197:)27 b(W)m(e)18 b(want)f(to)g(pass)h
(arrays)g Fi(p)f Fk(and)g Fi(xi)187 1314 y Fk(from)11 b Fi(linmin)g
Fk(to)g Fi(f1dim)g Fk(without)f(having)h(them)h(be)g(ar)o(guments)g(of)g
Fi(f1dim)o Fk(.)20 b(If)0 1364 y(you)13 b(recall)h(the)f(discussion)g(in)f
Fd(x)q Fk(21.5)h(and)h(on)f(p.)g(1197,)h(there)g(are)g(two)f(ways)h(of)f(ef)o
(fecting)0 1414 y(this:)21 b(via)13 b(pointers)g(or)h(via)f(allocatable)h
(arrays.)27 b(There)14 b(is)g(an)g(important)e(dif)o(ference)j(here,)0
1464 y(however)n(.)k(The)13 b(arrays)f Fi(p)g Fk(and)f Fi(xi)h
Fk(are)g(themselves)h(ar)o(guments)f(of)f Fi(linmin)o Fk(,)i(and)e(so)h
(cannot)0 1514 y(be)h(allocatable)f(arrays)h(in)e(the)h(module.)21
b(If)12 b(we)h(did)f(want)g(to)g(use)g(allocatable)h(arrays)f(in)g(the)0
1563 y(module,)i(we)h(would)d(have)i(to)f(copy)h Fi(p)f Fk(and)h
Fi(xi)f Fk(into)f(them.)26 b(The)14 b(pointer)e(implementation)0
1613 y(is)g(much)h(more)g(elegant,)h(since)f(no)f(unnecessary)i(copying)d(is)
i(required.)21 b(The)14 b(construction)0 1663 y(here)d(is)f(identical)g(to)g
(the)g(one)h(in)f Fi(fminln)f Fk(and)i Fi(newt)o Fk(,)g(except)g(that)f
Fi(p)g Fk(and)h Fi(xi)f Fk(are)i(ar)o(guments)0 1713 y(instead)18
b(of)g(automatic)g(arrays.)574 1787 y Fh(?)92 b(?)g(?)0 1896
y Fc(MODULE)19 b(df1dim_mod)156 b Fn(Used)9 b(fo)o(r)g(communication)h(from)f
Fo(dlinmin)e Fn(to)i Fo(f1dim)f Fn(and)i Fo(df1dim)n Fn(.)0
1933 y Fo(USE)17 b(nrtype)0 1970 y(INTEGER\(I4)o(B\))d(::)j(ncom)0
2008 y(REAL\(SP\),)d(DIMENSION\(:)o(\),)g(POINTER)i(::)g(pcom,xicom)0
2045 y Fc(CONTAINS)0 2099 y Fo(FUNCTION)f(f1dim\(x\))0 2136
y(IMPLICIT)g(NONE)0 2174 y(REAL\(SP\),)f(INTENT\(IN\))g(::)j(x)0
2211 y(REAL\(SP\))e(::)i(f1dim)58 2248 y Fn(Used)c(b)o(y)g
Fm(dlinmin)e Fn(as)h(the)h(one-dimensional)g(function)g(passed)f(to)g
Fm(mnbrak)n Fn(.)0 2286 y Fo(INTERFACE)66 2323 y(FUNCTION)j(func\(x\))66
2360 y(USE)i(nrtype)66 2398 y(REAL\(SP\),)e(DIMENSION\()o(:\),)f
(INTENT\(IN\))g(::)j(x)66 2435 y(REAL\(SP\))e(::)i(func)66
2473 y(END)g(FUNCTION)e(func)0 2510 y(END)i(INTERFACE)0 2547
y(REAL\(SP\),)d(DIMENSION\(:)o(\),)g(ALLOCATABLE)g(::)j(xt)p
eop
%%Page: 1213 13
bop 154 50 a Fj(Chapter)10 b(B10.)37 b(Minimization)11 b(or)g(Maximization)f
(of)h(Functions)188 b Fk(1213)p 0 68 1395 2 v 0 143 a @beginspecial
@setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 37 x Fo(allocate\(x)o(t\(n)o(com)o(\)\))0
218 y(xt\(:\)=pcom)o(\(:\))o(+x*)o(xic)o(om)o(\(:\))0 255 y(f1dim=func)o
(\(xt)o(\))0 293 y(deallocate)o(\(xt)o(\))0 330 y(END)17 b(FUNCTION)d(f1dim)0
384 y(FUNCTION)h(df1dim\(x\))0 421 y(IMPLICIT)g(NONE)0 459
y(REAL\(SP\),)f(INTENT\(IN\))g(::)j(x)0 496 y(REAL\(SP\))e(::)i(df1dim)58
533 y Fn(Used)c(b)o(y)g Fm(dlinmin)e Fn(as)h(the)h(one-dimensional)g
(function)g(passed)f(to)g Fm(dbrent)n Fn(.)0 571 y Fo(INTERFACE)66
608 y(FUNCTION)j(dfunc\(x\))66 645 y(USE)i(nrtype)66 683 y(REAL\(SP\),)e
(DIMENSION\()o(:\),)f(INTENT\(IN\))g(::)j(x)66 720 y(REAL\(SP\),)e
(DIMENSION\()o(siz)o(e\()o(x\)\))f(::)j(dfunc)66 757 y(END)g(FUNCTION)e
(dfunc)0 795 y(END)i(INTERFACE)0 832 y(REAL\(SP\),)d(DIMENSION\(:)o(\),)g
(ALLOCATABLE)g(::)j(xt,df)0 870 y(allocate\(x)o(t\(n)o(com)o(\),d)o(f\()o
(nco)o(m\)\))0 907 y(xt\(:\)=pcom)o(\(:\))o(+x*)o(xic)o(om)o(\(:\))0
944 y(df\(:\)=dfun)o(c\(x)o(t\))0 982 y(df1dim=dot)o(_pr)o(odu)o(ct\()o(df)o
(,xi)o(com)o(\))0 1019 y(deallocate)o(\(xt)o(,df)o(\))0 1056
y(END)g(FUNCTION)d(df1dim)0 1094 y Fc(END)20 b(MODULE)f(df1dim_mod)0
1242 y Fo(SUBROUTINE)14 b(dlinmin\(p,)o(xi,)o(fre)o(t\))0 1279
y(USE)j(nrtype;)e(USE)h(nrutil,)f(ONLY)i(:)g(assert_eq)0 1317
y(USE)g(nr,)f(ONLY)g(:)i(mnbrak,db)o(ren)o(t)0 1354 y(USE)f(df1dim_mo)o(d)0
1392 y(IMPLICIT)e(NONE)0 1429 y(REAL\(SP\),)f(INTENT\(OUT\))g(::)j(fret)0
1466 y(REAL\(SP\),)d(DIMENSION\(:)o(\),)g(TARGET)i(::)h(p,xi)0
1504 y(REAL\(SP\),)d(PARAMETER)h(::)i(TOL=1.0e-4)o(_s)o(p)58
1541 y Fn(Given)11 b(an)g Fl(N)t Fn(-dimensional)f(p)q(oint)h
Fm(p)g Fn(and)g(an)g Fl(N)t Fn(-dimensional)f(direction)h Fm(xi)o
Fn(,)g(b)q(oth)f(vecto)o(rs)g(of)g(length)58 1578 y Fl(N)t
Fn(,)i(moves)f(and)i(resets)d Fm(p)i Fn(to)f(where)h(the)g(\014xed-name)g
(function)g Fm(func)f Fn(tak)o(es)g(on)h(a)g(minimum)i(along)58
1616 y(the)h(direction)h Fm(xi)f Fn(from)g Fm(p)p Fn(,)h(and)g(replaces)f
Fm(xi)g Fn(b)o(y)h(the)f(actual)h(vecto)o(r)e(displacement)i(that)f
Fm(p)g Fn(w)o(as)58 1653 y(moved.)i(Also)10 b(returns)g(as)g
Fm(fret)f Fn(the)h(value)h(of)f Fm(func)f Fn(at)h(the)g(returned)h(lo)q
(cation)f Fm(p)o Fn(.)18 b(This)11 b(is)f(actually)58 1690
y(all)i(accomplished)f(b)o(y)h(calling)f(the)g(routines)g Fm(mnbrak)e
Fn(and)i Fm(dbrent)n Fn(.)17 b Fm(dfunc)10 b Fn(is)h(a)g(\014xed-name)g
(user-)58 1728 y(supplied)i(function)e(that)h(computes)e(the)i(gradient)f(of)
h Fm(func)n Fn(.)58 1765 y(P)o(a)o(rameter:)k(T)m(olerance)f(passed)e(to)i
Fm(dbrent)m Fn(.)0 1803 y Fo(REAL\(SP\))g(::)i(ax,bx,fa,)o(fb,)o(fx,)o(xmi)o
(n,x)o(x)0 1840 y(ncom=asser)o(t_e)o(q\(s)o(ize)o(\(p)o(\),s)o(ize)o(\(xi)o
(\),')o(dl)o(inm)o(in')o(\))0 1877 y(pcom=>p)369 b Fn(Communicate)12
b(the)g(global)h(va)o(riables)g(to)f Fo(f1dim)o Fn(.)0 1915
y Fo(xicom=>xi)0 1952 y(ax=0.0)387 b Fn(Initial)15 b(guess)d(fo)o(r)i(b)o
(rack)o(ets.)0 1989 y Fo(xx=1.0)0 2027 y(call)i(mnbrak\(ax,x)o(x,b)o(x,)o
(fa,)o(fx,)o(fb,)o(f1d)o(im)o(\))0 2064 y(fret=dbren)o(t\(a)o(x,x)o(x,b)o(x,)
o(f1d)o(im,)o(df1)o(dim)o(,T)o(OL,)o(xmi)o(n\))0 2101 y(xi=xmin*xi)315
b Fn(Construct)11 b(the)i(vecto)o(r)f(results)h(to)f(return.)0
2139 y Fo(p=p+xi)0 2176 y(END)17 b(SUBROUTIN)o(E)e(dlinmin)187
2251 y @beginspecial @setspecial
 /oshow {true charpath gsave 1 setgray fill grestore stroke} def gsave
0.5 setgray -40 -20 translate .8 .8 scale /NewCenturySchlbk-Bold findfont
40 scalefont setfont 2 1 scale 0 0 moveto (f) show /Helvetica-Narrow
findfont 24 scalefont setfont 0.5 1 scale 23 1 moveto (90) show grestore 
@endspecial 49 x(USE)h(df1dim_mod)38
b Fk(See)13 b(discussion)d(of)i Fi(USE)21 b(f1dim)p 975 2300
22 4 v 22 w(mod)9 b Fk(on)i(p.)h(1212.)574 2424 y Fh(?)92 b(?)g(?)p
eop
%%Page: 1214 14
bop 0 50 a Fk(1214)188 b Fj(Chapter)11 b(B10.)54 b(Minimization)11
b(or)g(Maximization)f(of)h(Functions)p 0 68 1395 2 v 0 143
a @beginspecial @setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 37 x Fo(SUBROUTINE)j(frprmn\(p,f)o
(tol)o(,it)o(er,)o(fre)o(t\))0 218 y(USE)j(nrtype;)e(USE)h(nrutil,)f(ONLY)i
(:)g(nrerror)0 255 y(USE)g(nr,)f(ONLY)g(:)i(linmin)0 293 y(IMPLICIT)d(NONE)0
330 y(INTEGER\(I4)o(B\),)f(INTENT\(OUT)o(\))h(::)i(iter)0 367
y(REAL\(SP\),)d(INTENT\(IN\))g(::)j(ftol)0 405 y(REAL\(SP\),)d(INTENT\(OUT\))
g(::)j(fret)0 442 y(REAL\(SP\),)d(DIMENSION\(:)o(\),)g(INTENT\(INOU)o(T\))g
(::)j(p)0 479 y(INTERFACE)66 517 y(FUNCTION)e(func\(p\))66
554 y(USE)i(nrtype)66 591 y(IMPLICIT)e(NONE)66 629 y(REAL\(SP\),)g
(DIMENSION\()o(:\),)f(INTENT\(IN\))g(::)j(p)66 666 y(REAL\(SP\))e(::)i(func)
66 703 y(END)g(FUNCTION)e(func)66 757 y(FUNCTION)g(dfunc\(p\))66
795 y(USE)i(nrtype)66 832 y(IMPLICIT)e(NONE)66 870 y(REAL\(SP\),)g
(DIMENSION\()o(:\),)f(INTENT\(IN\))g(::)j(p)66 907 y(REAL\(SP\),)e
(DIMENSION\()o(siz)o(e\()o(p\)\))f(::)j(dfunc)66 944 y(END)g(FUNCTION)e
(dfunc)0 982 y(END)i(INTERFACE)0 1019 y(INTEGER\(I4)o(B\),)d(PARAMETER)g(::)j
(ITMAX=200)0 1056 y(REAL\(SP\),)d(PARAMETER)h(::)i(EPS=1.0e-1)o(0_)o(sp)58
1094 y Fn(Given)d(a)f(sta)o(rting)g(p)q(oint)h Fm(p)g Fn(that)f(is)h(a)f
(vecto)o(r)g(of)g(length)h Fl(N)t Fn(,)f(Fletcher-Reeves-P)o(olak-Ribiere)e
(min-)58 1131 y(imization)16 b(is)f(p)q(erfo)o(rmed)f(on)h(a)g(function)g
Fm(func)n Fn(,)h(using)f(its)f(gradient)h(as)g(calculated)g(b)o(y)g(a)g
(routine)58 1168 y Fm(dfunc)n Fn(.)j(The)10 b(convergence)f(tolerance)g(on)h
(the)g(function)g(value)h(is)f(input)h(as)f Fm(ftol)n Fn(.)18
b(Returned)9 b(quan-)58 1206 y(tities)17 b(a)o(re)g Fm(p)g
Fn(\(the)g(lo)q(cation)h(of)f(the)g(minimum\),)i Fm(iter)d
Fn(\(the)h(numb)q(er)h(of)f(iterations)g(that)g(w)o(ere)58
1243 y(p)q(erfo)o(rmed\),)11 b(and)h Fm(fret)e Fn(\(the)h(minimum)i(value)f
(of)f(the)g(function\).)17 b(The)12 b(routine)g Fm(linmin)d
Fn(is)i(called)58 1280 y(to)g(p)q(erfo)o(rm)g(line)i(minimizations.)58
1318 y(P)o(a)o(rameters:)j Fm(ITMAX)11 b Fn(is)i(the)f(maximum)i(allo)o(w)o
(ed)g(numb)q(er)f(of)g(iterations;)f Fm(EPS)g Fn(is)h(a)g(small)g(numb)q(er)
58 1355 y(to)f(rectify)h(the)g(sp)q(ecial)f(case)g(of)h(converging)f(to)g
(exactly)h(zero)g(function)g(value.)0 1393 y Fo(INTEGER\(I4)o(B\))h(::)j(its)
0 1430 y(REAL\(SP\))e(::)i(dgg,fp,ga)o(m,g)o(g)0 1467 y(REAL\(SP\),)d
(DIMENSION\(s)o(ize)o(\(p\))o(\))h(::)i(g,h,xi)0 1505 y(fp=func\(p\))435
b Fn(Initializations.)0 1542 y Fo(xi=dfunc\(p)o(\))0 1579 y(g=-xi)0
1617 y(h=g)0 1654 y(xi=h)0 1691 y(do)17 b(its=1,ITMA)o(X)365
b Fn(Lo)q(op)13 b(over)h(iterations.)66 1729 y Fo(iter=its)66
1766 y(call)j(linmin\(p,)o(xi,)o(fre)o(t\))157 b Fn(Next)12
b(statement)f(is)i(the)f(no)o(rmal)h(return:)66 1804 y Fo(if)k(\(2.0_sp*abs)o
(\(fr)o(et-)o(fp\))d(<=)j(ftol*\(abs\()o(fr)o(et\))o(+ab)o(s\(f)o(p\)+)o(EP)o
(S\)\))d(RETURN)66 1841 y(fp=fret)66 1878 y(xi=dfunc\(p\))66
1916 y(gg=dot_prod)o(uct)o(\(g,)o(g\))-66 1953 y(!)114 b(dgg=dot_pro)o(duc)o
(t\(x)o(i,x)o(i\))157 b Fn(This)13 b(statement)e(fo)o(r)h(Fletcher-Reeves.)66
1990 y Fo(dgg=dot_pro)o(duc)o(t\(x)o(i+g)o(,xi)o(\))122 b Fn(This)13
b(statement)e(fo)o(r)i(P)o(olak-Ribiere.)66 2028 y Fo(if)k(\(gg)g(==)g(0.0\))
f(RETURN)176 b Fn(Unlik)o(ely)m(.)19 b(If)c(gradient)g(is)g(exactly)h(zero)e
(then)h(w)o(e)g(a)o(re)g(al-)675 2065 y(ready)f(done.)-782
b Fo(gam=dgg/gg)66 2102 y(g=-xi)66 2140 y(h=g+gam*h)66 2177
y(xi=h)0 2214 y(end)17 b(do)0 2252 y(call)f(nrerror\('fr)o(prm)o(n:)e
(maximum)h(iterations)f(exceeded'\))0 2289 y(END)j(SUBROUTIN)o(E)e(frprmn)574
2449 y Fh(?)92 b(?)g(?)p eop
%%Page: 1215 15
bop 154 50 a Fj(Chapter)10 b(B10.)37 b(Minimization)11 b(or)g(Maximization)f
(of)h(Functions)188 b Fk(1215)p 0 68 1395 2 v 0 143 a @beginspecial
@setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 37 x Fo(SUBROUTINE)14 b(dfpmin\(p,g)o(tol)o(,it)o
(er,)o(fre)o(t,)o(fun)o(c,d)o(fun)o(c\))0 218 y(USE)j(nrtype;)e(USE)h
(nrutil,)f(ONLY)i(:)g(nrerror,ou)o(ter)o(pro)o(d,)o(uni)o(t_m)o(atr)o(ix,)o
(va)o(bs)0 255 y(USE)g(nr,)f(ONLY)g(:)i(lnsrch)0 293 y(IMPLICIT)d(NONE)0
330 y(INTEGER\(I4)o(B\),)f(INTENT\(OUT)o(\))h(::)i(iter)0 367
y(REAL\(SP\),)d(INTENT\(IN\))g(::)j(gtol)0 405 y(REAL\(SP\),)d(INTENT\(OUT\))
g(::)j(fret)0 442 y(REAL\(SP\),)d(DIMENSION\(:)o(\),)g(INTENT\(INOU)o(T\))g
(::)j(p)0 479 y(INTERFACE)66 517 y(FUNCTION)e(func\(p\))66
554 y(USE)i(nrtype)66 591 y(IMPLICIT)e(NONE)66 629 y(REAL\(SP\),)g
(DIMENSION\()o(:\),)f(INTENT\(IN\))g(::)j(p)66 666 y(REAL\(SP\))e(::)i(func)
66 703 y(END)g(FUNCTION)e(func)66 757 y(FUNCTION)g(dfunc\(p\))66
795 y(USE)i(nrtype)66 832 y(IMPLICIT)e(NONE)66 870 y(REAL\(SP\),)g
(DIMENSION\()o(:\),)f(INTENT\(IN\))g(::)j(p)66 907 y(REAL\(SP\),)e
(DIMENSION\()o(siz)o(e\()o(p\)\))f(::)j(dfunc)66 944 y(END)g(FUNCTION)e
(dfunc)0 982 y(END)i(INTERFACE)0 1019 y(INTEGER\(I4)o(B\),)d(PARAMETER)g(::)j
(ITMAX=200)0 1056 y(REAL\(SP\),)d(PARAMETER)h(::)i(STPMX=100.)o(0_)o(sp,)o
(EPS)o(=ep)o(sil)o(on)o(\(p\))o(,TO)o(LX=)o(4.0)o(_s)o(p*E)o(PS)58
1094 y Fn(Given)10 b(a)g(sta)o(rting)f(p)q(oint)g Fm(p)h Fn(that)f(is)h(a)f
(vecto)o(r)g(of)g(length)h Fl(N)t Fn(,)f(the)h(Bro)o(yden-Fletcher-Goldfa)o
(rb-Shanno)58 1131 y(va)o(riant)i(of)e(Davidon-Fletcher-P)o(o)o(w)o(ell)h
(minimization)i(is)d(p)q(erfo)o(rmed)h(on)f(a)h(function)g
Fm(func)n Fn(,)g(using)g(its)58 1168 y(gradient)k(as)f(calculated)h(b)o(y)g
(a)f(routine)h Fm(dfunc)n Fn(.)i(The)e(convergence)e(requirement)i(on)f
(zeroing)h(the)58 1206 y(gradient)d(is)f(input)i(as)e Fm(gtol)n
Fn(.)18 b(Returned)11 b(quantities)h(a)o(re)f Fm(p)g Fn(\(the)g(lo)q(cation)h
(of)f(the)g(minimum\),)h Fm(iter)58 1243 y Fn(\(the)k(numb)q(er)i(of)e
(iterations)g(that)h(w)o(ere)f(p)q(erfo)o(rmed\),)h(and)h Fm(fret)d
Fn(\(the)h(minimum)i(value)g(of)e(the)58 1280 y(function\).)h(The)12
b(routine)g Fm(lnsrch)d Fn(is)j(called)g(to)f(p)q(erfo)o(rm)g(app)o(ro)o
(ximate)h(line)h(minimizations.)58 1318 y(P)o(a)o(rameters:)j
Fm(ITMAX)f Fn(is)h(the)g(maximum)i(allo)o(w)o(ed)f(numb)q(er)g(of)f
(iterations;)j Fm(STPMX)14 b Fn(is)j(the)f(scaled)58 1355 y(maximum)f(step)e
(length)g(allo)o(w)o(ed)i(in)f(line)g(sea)o(rches;)f Fm(EPS)g
Fn(is)h(the)f(machine)h(p)o(recision;)g Fm(TOLX)e Fn(is)i(the)58
1393 y(convergence)g(criterion)h(on)g Fl(x)g Fn(values.)0 1430
y Fo(INTEGER\(I4)o(B\))f(::)j(its)0 1467 y(LOGICAL)e(::)i(check)0
1505 y(REAL\(SP\))e(::)i(den,fac,f)o(ad,)o(fae)o(,fp)o(,st)o(pm)o(ax,)o(sum)o
(dg,)o(sum)o(xi)0 1542 y(REAL\(SP\),)d(DIMENSION\(s)o(ize)o(\(p\))o(\))h(::)i
(dg,g,hdg,)o(pne)o(w,x)o(i)0 1579 y(REAL\(SP\),)d(DIMENSION\(s)o(ize)o(\(p\))
o(,si)o(ze\()o(p\))o(\))h(::)i(hessin)0 1617 y(fp=func\(p\))555
b Fn(Calculate)14 b(sta)o(rting)f(function)h(value)h(and)f(gradi-)795
1654 y(ent.)-852 b Fo(g=dfunc\(p\))0 1691 y(call)16 b(unit_matrix)o(\(he)o
(ss)o(in\))308 b Fn(Initialize)12 b(inverse)e(Hessian)f(to)h(the)g(unit)h
(matrix.)0 1729 y Fo(xi=-g)645 b Fn(Initial)14 b(line)g(direction.)0
1766 y Fo(stpmax=STP)o(MX*)o(max)o(\(va)o(bs)o(\(p\))o(,re)o(al\()o(siz)o
(e\()o(p\),)o(sp\))o(\))0 1804 y(do)j(its=1,ITMA)o(X)485 b
Fn(Main)13 b(lo)q(op)f(over)h(the)f(iterations.)66 1841 y Fo(iter=its)66
1878 y(call)17 b(lnsrch\(p,)o(fp,)o(g,x)o(i,p)o(ne)o(w,f)o(ret)o(,st)o(pma)o
(x,)o(che)o(ck,)o(fun)o(c\))100 1916 y Fn(The)10 b(new)h(function)f
(evaluation)h(o)q(ccurs)e(in)j Fo(lnsrch)m Fn(;)f(save)f(the)g(function)h
(value)g(in)g Fo(fp)f Fn(fo)o(r)g(the)g(next)100 1953 y(line)k(sea)o(rch.)i
(It)d(is)h(usually)g(safe)f(to)g(igno)o(re)g(the)g(value)h(of)f
Fo(check)n Fn(.)66 1990 y Fo(fp=fret)66 2028 y(xi=pnew-p)507
b Fn(Up)q(date)13 b(the)f(line)i(direction,)66 2065 y Fo(p=pnew)561
b Fn(and)13 b(the)g(current)g(p)q(oint.)66 2102 y Fo(if)k(\(maxval\(abs)o
(\(xi)o(\)/m)o(ax\()o(ab)o(s\(p)o(\),1)o(.0_)o(sp\))o(\))d(<)k(TOLX\))e
(RETURN)100 2140 y Fn(T)m(est)e(fo)o(r)h(convergence)f(on)h
Fg(\001)p Fl(x)p Fn(.)66 2177 y Fo(dg=g)597 b Fn(Save)13 b(the)f(old)i
(gradient,)66 2214 y Fo(g=dfunc\(p\))489 b Fn(and)13 b(get)f(the)h(new)f
(gradient.)66 2252 y Fo(den=max\(fre)o(t,1)o(.0_)o(sp\))66
2289 y(if)17 b(\(maxval\(abs)o(\(g\))o(*ma)o(x\(a)o(bs)o(\(p\))o(,1.)o(0_s)o
(p\)/)o(de)o(n\))d(<)k(gtol\))e(RETURN)100 2327 y Fn(T)m(est)d(fo)o(r)i
(convergence)e(on)h(zero)h(gradient.)66 2364 y Fo(dg=g-dg)543
b Fn(Compute)12 b(di\013erence)f(of)h(gradients,)66 2401 y
Fo(hdg=matmul\()o(hes)o(sin)o(,dg)o(\))295 b Fn(and)13 b(di\013erence)e
(times)h(current)f(matrix.)66 2439 y Fo(fac=dot_pro)o(duc)o(t\(d)o(g,x)o(i\))
277 b Fn(Calculate)9 b(dot)h(p)o(ro)q(ducts)f(fo)o(r)g(the)g(denominato)o
(rs.)66 2476 y Fo(fae=dot_pro)o(duc)o(t\(d)o(g,h)o(dg\))66
2513 y(sumdg=dot_p)o(rod)o(uct)o(\(dg)o(,dg)o(\))p eop
%%Page: 1216 16
bop 0 50 a Fk(1216)188 b Fj(Chapter)11 b(B10.)54 b(Minimization)11
b(or)g(Maximization)f(of)h(Functions)p 0 68 1395 2 v 0 143
a @beginspecial @setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 66 180 a Fo(sumxi=dot_p)o(rod)o
(uct)o(\(xi)o(,xi)o(\))66 218 y(if)17 b(\(fac)g(>)g(sqrt\(EPS*s)o(umd)o(g*)o
(sum)o(xi\))o(\))e(then)134 b Fn(Skip)19 b(up)q(date)f(if)g
Fo(fac)f Fn(not)h(su\016ciently)915 255 y(p)q(ositive.)-904
b Fo(fac=1.0_sp)o(/fa)o(c)133 293 y(fad=1.0_sp)o(/fa)o(e)133
330 y(dg=fac*xi-)o(fad)o(*h)o(dg)299 b Fn(V)o(ecto)o(r)7 b(that)i(mak)o(es)f
(BF)o(GS)g(di\013erent)h(from)f(DFP)m(.)133 367 y Fo(hessin=hes)o(sin)o(+f)o
(ac*)o(out)o(erp)o(rod)o(\(x)o(i,x)o(i\)-)o(&)84 b Fn(The)12
b(BF)o(GS)f(up)q(dating)i(fo)o(rmula.)199 405 y Fo(fad*outerpr)o(od\()o(hdg)o
(,h)o(dg\))o(+fa)o(e*o)o(ute)o(rp)o(rod)o(\(dg)o(,dg)o(\))66
442 y(end)k(if)66 479 y(xi=-matmul\()o(hes)o(sin)o(,g\))312
b Fn(No)o(w)12 b(calculate)f(the)h(next)g(direction)g(to)g(go,)0
517 y Fo(end)17 b(do)628 b Fn(and)13 b(go)e(back)i(fo)o(r)f(another)f
(iteration.)0 554 y Fo(call)16 b(nrerror\('df)o(pmi)o(n:)e(too)j(many)f
(iterations)o('\))0 591 y(END)h(SUBROUTIN)o(E)e(dfpmin)187
685 y @beginspecial @setspecial
 /oshow {true charpath gsave 1 setgray fill grestore stroke} def gsave
0.5 setgray -40 -20 translate .8 .8 scale /NewCenturySchlbk-Bold findfont
40 scalefont setfont 2 1 scale 0 0 moveto (f) show /Helvetica-Narrow
findfont 24 scalefont setfont 0.5 1 scale 23 1 moveto (90) show grestore 
@endspecial(call)h(unit_matri)o(x\(h)o(ess)
o(in\))38 b Fk(The)17 b Fi(unit)p 821 685 22 4 v 22 w(matrix)d
Fk(routine)h(in)h Fi(nrutil)f Fk(does)187 734 y(exactly)k(what)g(its)g(name)i
(suggests.)42 b(The)20 b(routine)e Fi(dfpmin)h Fk(makes)h(use)g(of)187
784 y Fi(outerprod)13 b Fk(from)h Fi(nrutil)o Fk(,)i(as)f(well)f(as)h(the)g
(matrix)f(intrinsics)e Fi(matmul)i Fk(and)0 834 y Fi(dot)p
66 834 V 22 w(product)n Fk(,)i(to)e(simplify)f(and)h(parallelize)h(the)f
(coding.)574 911 y Fh(?)92 b(?)g(?)0 978 y Fo(SUBROUTINE)14
b(simplx\(a,m)o(1,m)o(2,m)o(3,i)o(cas)o(e,)o(izr)o(ov,)o(ipo)o(sv\))0
1015 y(USE)j(nrtype;)e(USE)h(nrutil,)f(ONLY)i(:)g(arth,asser)o(t_e)o(q,i)o
(fi)o(rst)o(loc)o(,im)o(axl)o(oc)o(,&)66 1053 y(nrerror,out)o(erp)o(rod)o
(,sw)o(ap)0 1090 y(IMPLICIT)e(NONE)0 1128 y(REAL\(SP\),)f(DIMENSION\(:)o
(,:\))o(,)h(INTENT\(IN)o(OUT)o(\))g(::)i(a)0 1165 y(INTEGER\(I4)o(B\),)d
(INTENT\(IN\))g(::)j(m1,m2,m3)0 1202 y(INTEGER\(I4)o(B\),)d(INTENT\(OUT)o(\))
h(::)i(icase)0 1240 y(INTEGER\(I4)o(B\),)d(DIMENSION\()o(:\),)g(INTENT\(OUT)o
(\))h(::)i(izrov,ipo)o(sv)0 1277 y(REAL\(SP\),)d(PARAMETER)h(::)i(EPS=1.0e-6)
o(_s)o(p)58 1314 y Fn(Simplex)c(metho)q(d)f(fo)o(r)g(linea)o(r)i(p)o
(rogramming.)j(Input)c(pa)o(rameters)e Fm(a)p Fn(,)i Fm(m1)o
Fn(,)f Fm(m2)p Fn(,)g(and)h Fm(m3)o Fn(,)g(and)g(output)58
1352 y(pa)o(rameters)c Fm(a)o Fn(,)h Fm(icase)n Fn(,)g Fm(izrov)n
Fn(,)g(and)g Fm(iposv)d Fn(a)o(re)j(describ)q(ed)f(ab)q(ove)g(the)g(routine)h
(in)g(V)o(ol.)f(1.)17 b(Dimen-)58 1389 y(sions)11 b(a)o(re)h
Fg(\()p Fl(M)e Fg(+)e(2\))g Ff(\002)g Fg(\()p Fl(N)j Fg(+)d(1\))j
Fn(fo)o(r)g Fm(a)p Fn(,)g Fl(M)k Fn(fo)o(r)c Fm(iposv)o Fn(,)g
Fl(N)k Fn(fo)o(r)c Fm(izrov)n Fn(,)h(with)g Fm(m1)7 b Fg(+)h
Fm(m2)f Fg(+)h Fm(m3)h Fg(=)i Fl(M)t Fn(.)58 1426 y(P)o(a)o(rameter:)16
b Fm(EPS)e Fn(is)h(the)g(absolute)g(p)o(recision,)g(which)h(should)f(b)q(e)g
(adjusted)g(to)g(the)g(scale)f(of)h(y)o(our)58 1464 y(va)o(riables.)0
1501 y Fo(INTEGER\(I4)o(B\))f(::)j(ip,k,kh,kp,)o(nl1)o(,m,)o(n)0
1539 y(INTEGER\(I4)o(B\),)d(DIMENSION\()o(siz)o(e\(a)o(,2\))o(\))g(::)j(l1)0
1576 y(INTEGER\(I4)o(B\),)d(DIMENSION\()o(m2\))g(::)j(l3)0
1613 y(REAL\(SP\))e(::)i(bmax)0 1651 y(LOGICAL\(LG)o(T\))d(::)j(init)0
1688 y(m=assert_e)o(q\(s)o(ize)o(\(a,)o(1\))o(-2,)o(siz)o(e\(i)o(pos)o(v\))o
(,'s)o(imp)o(lx:)d(m'\))0 1725 y(n=assert_e)o(q\(s)o(ize)o(\(a,)o(2\))o(-1,)o
(siz)o(e\(i)o(zro)o(v\))o(,'s)o(imp)o(lx:)g(n'\))0 1763 y(if)j(\(m)g(/=)g
(m1+m2+m3\))d(call)i(nrerror\('si)o(mpl)o(x:)e(bad)j(input)f(constraint)e
(counts'\))0 1800 y(if)j(\(any\(a\(2:m)o(+1,)o(1\))d(<)j(0.0\)\))f(call)h
(nrerror\(')o(bad)d(input)i(tableau)f(in)i(simplx'\))33 1837
y Fn(Constants)d Fl(b)210 1842 y Fb(i)238 1837 y Fn(must)h(b)q(e)g
(nonnegative.)0 1875 y Fo(nl1=n)0 1912 y(l1\(1:n\)=ar)o(th\()o(1,1)o(,n\))33
1949 y Fn(Initialize)h(index)e(list)g(of)g(columns)f(admissible)i(fo)o(r)e
(exchange.)0 1987 y Fo(izrov\(:\)=l)o(1\(1)o(:n\))449 b Fn(Initially)14
b(mak)o(e)e(all)h(va)o(riables)f(right-hand.)0 2024 y Fo(iposv\(:\)=n)o(+ar)o
(th\()o(1,1)o(,m)o(\))33 2062 y Fn(Initial)i(left-hand)g(va)o(riables.)k
Fo(m1)12 b Fn(t)o(yp)q(e)h(constraints)f(a)o(re)h(rep)o(resented)g(b)o(y)g
(having)h(their)g(slack)f(va)o(riable)33 2099 y(initially)19
b(left-hand,)e(with)g(no)g(a)o(rti\014cial)g(va)o(riable.)h
Fo(m2)e Fn(t)o(yp)q(e)g(constraints)f(have)i(their)g(slack)f(va)o(riable)33
2136 y(initially)i(left-hand,)f(with)f(a)f(minus)i(sign,)f(and)g(their)g(a)o
(rti\014cial)g(va)o(riable)h(handled)f(implicitly)i(during)33
2174 y(their)12 b(\014rst)g(exchange.)k Fo(m3)c Fn(t)o(yp)q(e)g(constraints)e
(have)j(their)f(a)o(rti\014cial)g(va)o(riable)h(initially)i(left-hand.)0
2211 y Fo(init=.true)o(.)0 2248 y(phase1:)g(do)66 2286 y(if)i(\(init\))f
(then)420 b Fn(Initial)14 b(pass)f(only)m(.)133 2323 y Fo(if)k(\(m2+m3)e(==)i
(0\))g(exit)f(phase1)124 b Fn(Origin)9 b(is)f(a)f(feasible)h(solution.)17
b(Go)7 b(to)h(phase)f(t)o(w)o(o.)133 2360 y Fo(init=.fals)o(e.)133
2398 y(l3\(1:m2\)=1)166 2435 y Fn(Initialize)13 b(list)f(of)f
Fo(m2)f Fn(constraints)h(whose)f(slack)i(va)o(riables)g(have)f(never)h(b)q
(een)f(exchanged)g(out)166 2473 y(of)k(the)g(initial)j(basis.)133
2510 y Fo(a\(m+2,1:n+)o(1\)=)o(-s)o(um\()o(a\(m)o(1+2)o(:m+)o(1,)o(1:n)o
(+1\))o(,di)o(m=1)o(\))98 b Fn(Compute)7 b(the)g(auxilia)o(ry)j(objec-)1035
2547 y(tive)i(function.)-1164 b Fo(end)17 b(if)p eop
%%Page: 1217 17
bop 154 50 a Fj(Chapter)10 b(B10.)37 b(Minimization)11 b(or)g(Maximization)f
(of)h(Functions)188 b Fk(1217)p 0 68 1395 2 v 0 143 a @beginspecial
@setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 66 180 a Fo(if)17 b(\(nl1)g(>)g(0\))g(then)133
218 y(kp=l1\(imax)o(loc)o(\(a)o(\(m+)o(2,l)o(1\(1)o(:nl)o(1\))o(+1\))o(\)\))
119 b Fn(Find)11 b(the)f(maximum)h(co)q(e\016cient)e(of)h(the)915
255 y(auxilia)o(ry)k(objective)e(function.)-1187 b Fo(bmax=a\(m+2)o(,kp)o(+1)
o(\))66 293 y(else)133 330 y(bmax=0.0)66 367 y(end)17 b(if)66
405 y(phase1a:)e(do)133 442 y(if)i(\(bmax)f(<=)h(EPS)f(.and.)g(a\(m+2,1\))f
(<)i(-EPS\))f(then)232 479 y Fn(Auxilia)o(ry)h(objective)e(function)g(is)g
(still)g(negative)g(and)g(can't)f(b)q(e)h(imp)o(roved,)h(hence)f(no)232
517 y(feasible)g(solution)g(exists.)199 554 y Fo(icase=-1)199
591 y(RETURN)133 629 y(else)h(if)h(\(bmax)f(<=)h(EPS)f(.and.)g(a\(m+2,1\))f
(<=)i(EPS\))f(then)232 666 y Fn(Auxilia)o(ry)d(objective)d(function)h(is)g
(zero)g(and)g(can't)f(b)q(e)h(imp)o(roved.)18 b(This)11 b(signals)f(that)h(w)
o(e)232 703 y(have)j(a)f(feasible)g(sta)o(rting)g(vecto)o(r.)j(Clean)d(out)g
(the)g(a)o(rti\014cial)h(va)o(riables)g(co)o(rresp)q(onding)232
741 y(to)e(any)g(remaining)h(equalit)o(y)g(constraints)e(and)h(then)g
(eventually)h(exit)f(phase)g(one.)199 778 y Fo(do)17 b(ip=m1+m2+1,)o(m)266
816 y(if)g(\(iposv\(ip)o(\))e(==)i(ip+n\))e(then)112 b Fn(F)o(ound)8
b(an)g(a)o(rti\014cial)h(va)o(riable)g(fo)o(r)e(an)h(equal-)915
853 y(it)o(y)13 b(constraint.)-789 b Fo(if)17 b(\(nl1)f(>)i(0\))e(then)399
890 y(kp=l1\(ima)o(xlo)o(c\()o(abs)o(\(a\()o(ip+)o(1,l)o(1\()o(1:n)o(l1\))o
(+1\))o(\)\)\))399 928 y(bmax=a\(ip)o(+1,)o(kp)o(+1\))332 965
y(else)399 1002 y(bmax=0.0)332 1040 y(end)h(if)332 1077 y(if)g(\(bmax)f(>)h
(EPS\))f(exit)h(phase1a)86 b Fn(Exchange)8 b(with)g(column)g(co)o(rresp)q
(ond-)975 1114 y(ing)17 b(to)g(maximum)h(pivot)f(ele-)975 1152
y(ment)12 b(in)i(ro)o(w.)266 1114 y Fo(end)i(if)199 1152 y(end)h(do)199
1189 y(where)f(\(spread\(l3\()o(1:)o(m2\))o(,2,)o(n+1)o(\))f(==)h(1\))h(&)266
1227 y(a\(m1+2:m1)o(+m2)o(+1,)o(1:n)o(+1\))o(=-)o(a\(m)o(1+2)o(:m1)o(+m2)o
(+1)o(,1:)o(n+1)o(\))299 1264 y Fn(Change)8 b(sign)g(of)g(ro)o(w)g(fo)o(r)g
(any)h Fo(m2)f Fn(constraints)f(still)i(p)o(resent)f(from)g(the)g(initial)i
(basis.)199 1301 y Fo(exit)16 b(phase1)340 b Fn(Go)13 b(to)f(phase)h(t)o(w)o
(o.)133 1339 y Fo(end)j(if)133 1376 y(call)g(simp1)424 b Fn(Lo)q(cate)11
b(a)h(pivot)h(element)e(\(phase)h(one\).)133 1413 y Fo(if)17
b(\(ip)f(==)h(0\))g(then)301 b Fn(Maximum)17 b(of)g(auxilia)o(ry)h(objective)
f(function)g(is)795 1451 y(unb)q(ounded,)i(so)d(no)h(feasible)g(solution)g
(ex-)795 1488 y(ists.)199 1451 y Fo(icase=-1)199 1488 y(RETURN)133
1525 y(end)f(if)133 1563 y(exit)g(phase1a)66 1600 y(end)h(do)g(phase1a)66
1637 y(call)g(simp2\(m+1)o(,n\))365 b Fn(Exchange)12 b(a)f(left-)h(and)g(a)f
(right-hand)i(va)o(riable.)66 1675 y Fo(if)k(\(iposv\(ip\))d(>=)j
(n+m1+m2+1\))d(then)103 b Fn(Exchanged)18 b(out)f(an)h(a)o(rti\014cial)g(va)o
(riable)g(fo)o(r)f(an)795 1712 y(equalit)o(y)i(constraint.)d(Mak)o(e)i(sure)f
(it)h(sta)o(ys)795 1750 y(out)12 b(b)o(y)g(removing)g(it)g(from)g(the)f
Fo(l1)g Fn(list.)133 1712 y Fo(k=ifirstlo)o(c\(l)o(1\()o(1:n)o(l1\))j(==)j
(kp\))133 1750 y(nl1=nl1-1)133 1787 y(l1\(k:nl1\)=)o(l1\()o(k+)o(1:n)o(l1+)o
(1\))66 1824 y(else)133 1862 y(kh=iposv\(i)o(p\)-)o(m1)o(-n)133
1899 y(if)g(\(kh)f(>=)h(1\))g(then)301 b Fn(Exchanged)12 b(out)g(an)g
Fo(m2)f Fn(t)o(yp)q(e)h(constraint.)199 1936 y Fo(if)17 b(\(l3\(kh\))e(/=)i
(0\))g(then)164 b Fn(If)16 b(it's)g(the)g(\014rst)g(time,)i(co)o(rrect)d(the)
h(pivot)h(col-)795 1974 y(umn)c(fo)o(r)f(the)g(minus)h(sign)g(and)g(the)f
(implicit)915 2011 y(a)o(rti\014cial)h(va)o(riable.)266 1974
y Fo(l3\(kh\)=0)266 2011 y(a\(m+2,kp+)o(1\)=)o(a\(m)o(+2,)o(kp+)o(1\))o(+1.)o
(0_s)o(p)266 2048 y(a\(1:m+2,k)o(p+1)o(\)=-)o(a\(1)o(:m+)o(2,)o(kp+)o(1\))199
2086 y(end)k(if)133 2123 y(end)f(if)66 2161 y(end)h(if)66 2198
y(call)g(swap\(izro)o(v\(k)o(p\),)o(ipo)o(sv)o(\(ip)o(\)\))136
b Fn(Up)q(date)10 b(lists)f(of)h(left-)f(and)h(right-hand)g(va)o(riables.)0
2235 y Fo(end)17 b(do)f(phase1)504 b Fn(If)12 b(still)h(in)g(phase)e(one,)h
(go)g(back)g(again.)0 2273 y Fo(phase2:)j(do)100 2310 y Fn(W)o(e)e(have)h(an)
g(initial)i(feasible)d(solution.)k(No)o(w)d(optimize)g(it.)66
2347 y Fo(if)j(\(nl1)g(>)g(0\))g(then)133 2385 y(kp=l1\(imax)o(loc)o(\(a)o
(\(1,)o(l1\()o(1:n)o(l1\))o(+1)o(\)\)\))94 b Fn(T)m(est)12
b(the)g(z-ro)o(w)g(fo)o(r)g(doneness.)133 2422 y Fo(bmax=a\(1,k)o(p+1)o(\))66
2459 y(else)133 2497 y(bmax=0.0)66 2534 y(end)17 b(if)p eop
%%Page: 1218 18
bop 0 50 a Fk(1218)193 b Fj(Chapter)10 b(B10.)52 b(Minimization)11
b(or)g(Maximization)f(of)g(Functions)p 0 68 1395 2 v 0 143
a @beginspecial @setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 66 180 a Fo(if)17
b(\(bmax)f(<=)h(EPS\))f(then)297 b Fn(Done.)18 b(Solution)8
b(found.)17 b(Return)8 b(with)h(the)e(go)q(o)q(d)795 218 y(news.)-744
b Fo(icase=0)133 255 y(RETURN)66 293 y(end)17 b(if)66 330 y(call)g(simp1)490
b Fn(Lo)q(cate)11 b(a)h(pivot)h(element)e(\(phase)h(t)o(w)o(o\).)66
367 y Fo(if)17 b(\(ip)g(==)g(0\))g(then)367 b Fn(Objective)8
b(function)g(is)g(unb)q(ounded.)18 b(Rep)q(o)o(rt)7 b(and)795
405 y(return.)-761 b Fo(icase=1)133 442 y(RETURN)66 479 y(end)17
b(if)66 517 y(call)g(simp2\(m,n)o(\))401 b Fn(Exchange)12 b(a)f(left-)h(and)g
(a)g(right-hand)g(va)o(riable,)66 554 y Fo(call)17 b(swap\(izro)o(v\(k)o
(p\),)o(ipo)o(sv)o(\(ip)o(\)\))136 b Fn(up)q(date)9 b(lists)g(of)g(left-)f
(and)i(right-hand)f(va)o(riables,)0 591 y Fo(end)17 b(do)f(phase2)504
b Fn(and)13 b(return)f(fo)o(r)g(another)g(iteration.)0 629
y Fo(CONTAINS)0 683 y(SUBROUTINE)i(simp1)58 720 y Fn(Lo)q(cate)f(a)h(pivot)g
(element,)f(taking)h(degeneracy)f(into)h(account.)0 757 y Fo(IMPLICIT)h(NONE)
0 795 y(INTEGER\(I4)o(B\))f(::)j(i,k)0 832 y(REAL\(SP\))e(::)i(q,q0,q1,q)o(p)
0 870 y(ip=0)0 907 y(i=ifirstlo)o(c\(a)o(\(2:)o(m+1)o(,k)o(p+1)o(\))e(<)i
(-EPS\))0 944 y(if)g(\(i)g(>)g(m\))g(RETURN)433 b Fn(No)11
b(p)q(ossible)h(pivots.)17 b(Return)12 b(with)g(message.)0
982 y Fo(q1=-a\(i+1,)o(1\)/)o(a\(i)o(+1,)o(kp)o(+1\))0 1019
y(ip=i)0 1056 y(do)17 b(i=ip+1,m)66 1094 y(if)g(\(a\(i+1,kp+1)o(\))e(<)i
(-EPS\))f(then)133 1131 y(q=-a\(i+1,1)o(\)/a)o(\(i)o(+1,)o(kp+)o(1\))133
1168 y(if)h(\(q)g(<)g(q1\))g(then)199 1206 y(ip=i)199 1243
y(q1=q)133 1280 y(else)f(if)h(\(q)g(==)g(q1\))f(then)213 b
Fn(W)o(e)13 b(have)g(a)g(degeneracy)m(.)199 1318 y Fo(do)k(k=1,n)266
1355 y(qp=-a\(ip+)o(1,k)o(+1\))o(/a\()o(ip+)o(1,)o(kp+)o(1\))266
1393 y(q0=-a\(i+1)o(,k+)o(1\)/)o(a\(i)o(+1,)o(kp)o(+1\))266
1430 y(if)g(\(q0)f(/=)h(qp\))g(exit)199 1467 y(end)g(do)199
1505 y(if)g(\(q0)g(<)g(qp\))g(ip=i)133 1542 y(end)f(if)66 1579
y(end)h(if)0 1617 y(end)g(do)0 1654 y(END)g(SUBROUTIN)o(E)e(simp1)0
1708 y(SUBROUTINE)f(simp2\(i1,k)o(1\))0 1745 y(IMPLICIT)h(NONE)0
1783 y(INTEGER\(I4)o(B\),)f(INTENT\(IN\))g(::)j(i1,k1)58 1820
y Fn(Matrix)c(op)q(erations)f(to)f(exchange)h(a)h(left-hand)f(and)h
(right-hand)g(va)o(riable)h(\(see)d(text\).)0 1857 y Fo(INTEGER\(I4)o(B\))j
(::)j(ip1,kp1)0 1895 y(REAL\(SP\))e(::)i(piv)0 1932 y(INTEGER\(I4)o(B\),)d
(DIMENSION\()o(k1\))g(::)j(icol)0 1970 y(INTEGER\(I4)o(B\),)d(DIMENSION\()o
(i1\))g(::)j(irow)0 2007 y(INTEGER\(I4)o(B\),)d(DIMENSION\()o(max)o(\(i1)o
(,k1)o(\)+)o(1\))g(::)j(itmp)0 2044 y(ip1=ip+1)0 2082 y(kp1=kp+1)0
2119 y(piv=1.0_sp)o(/a\()o(ip1)o(,kp)o(1\))0 2156 y(itmp\(1:k1+)o(1\)=)o(art)
o(h\(1)o(,1)o(,k1)o(+1\))0 2194 y(icol=pack\()o(itm)o(p\(1)o(:k1)o(+1)o(\),i)
o(tmp)o(\(1:)o(k1+)o(1\))d(/=)j(kp1\))0 2231 y(itmp\(1:i1+)o(1\)=)o(art)o
(h\(1)o(,1)o(,i1)o(+1\))0 2268 y(irow=pack\()o(itm)o(p\(1)o(:i1)o(+1)o(\),i)o
(tmp)o(\(1:)o(i1+)o(1\))d(/=)j(ip1\))0 2306 y(a\(irow,kp1)o(\)=a)o(\(ir)o
(ow,)o(kp)o(1\)*)o(piv)0 2343 y(a\(irow,ico)o(l\)=)o(a\(i)o(row)o(,i)o(col)o
(\)-o)o(ute)o(rpr)o(od)o(\(a\()o(iro)o(w,k)o(p1\))o(,a)o(\(ip)o(1,i)o(col)o
(\)\))0 2381 y(a\(ip1,icol)o(\)=-)o(a\(i)o(p1,)o(ic)o(ol\))o(*pi)o(v)0
2418 y(a\(ip1,kp1\))o(=pi)o(v)0 2455 y(END)g(SUBROUTIN)o(E)e(simp2)0
2493 y(END)i(SUBROUTIN)o(E)e(simplx)p eop
%%Page: 1219 19
bop 154 50 a Fj(Chapter)10 b(B10.)37 b(Minimization)11 b(or)g(Maximization)f
(of)h(Functions)188 b Fk(1219)p 0 68 1395 2 v 0 143 a @beginspecial
@setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 187 189 a @beginspecial @setspecial
 /oshow {true charpath gsave 1 setgray fill grestore stroke} def gsave
0.5 setgray -40 -20 translate .8 .8 scale /NewCenturySchlbk-Bold findfont
40 scalefont setfont 2 1 scale 0 0 moveto (f) show /Helvetica-Narrow
findfont 24 scalefont setfont 0.5 1 scale 23 1 moveto (90) show grestore

@endspecial Fo(main_proce)o(dur)o(e:)14 b(do)41 b Fk(The)11
b(routine)e Fi(simplx)g Fk(makes)i(extensive)f(use)h(of)f(named)187
239 y(do-loops)f(to)h(control)f(the)i(program)f(\257ow)m(.)16
b(The)c(various)e Fi(exit)f Fk(statements)i(have)187 288 y(the)i(names)h(of)f
(the)g(do-loops)f(attached)h(to)g(them)g(so)g(we)h(can)g(easily)f(tell)f
(where)0 338 y(control)g(is)h(being)f(transferred)h(to.)24
b(W)m(e)13 b(believe)g(that)g(it)f(is)h(almost)g(never)g(necessary)i(to)d
(use)0 388 y Fi(goto)7 b Fk(statements:)14 b(Code)8 b(will)e(always)j(be)f
(clearer)h(with)e(well-constructed)g(block)g(structures.)101
464 y Fo(phase1a:)14 b(do...end)h(do)i(phase1a)39 b Fk(This)11
b(is)g(not)g(a)h(real)f(do-loop:)k(It)c(is)g(executed)h(only)0
514 y(once,)i(as)f(you)f(can)h(see)g(from)f(the)h(unconditional)c
Fi(exit)j Fk(before)h(the)f Fi(end)21 b(do)o Fk(.)h(W)m(e)13
b(use)g(this)0 563 y(construction)h(to)h(de\256ne)i(a)f(block)f(of)h(code)g
(that)g(is)f(traversed)h(once)h(but)e(that)g(has)h(several)0
613 y(possible)j(exit)g(points.)53 714 y Fo(where)d(\(spread\(l3)o(\(1)o(:m1)
o(2-m)o(1\),)o(2,n)o(+1)o(\))f(==)i(1\))g(&)106 764 y(a\(m1+2:m12)o(+1,)o(1:)
o(n+1)o(\)=-)o(a\(m)o(1+2)o(:m)o(12+)o(1,1)o(:n+)o(1\))0 826
y Fk(These)i(lines)f(are)h(equivalent)e(to)136 897 y Fo(do)g(i=m1+1,m12)189
935 y(if)g(\(l3\(i-m1\))d(==)j(1\))g(a\(i+1,1:n+1)o(\)=)o(-a\()o(i+1)o(,1:)o
(n+1)o(\))136 972 y(end)g(do)574 1074 y Fh(?)92 b(?)g(?)0 1240
y Fo(SUBROUTINE)14 b(anneal\(x,y)o(,io)o(rde)o(r\))0 1277 y(USE)j(nrtype;)e
(USE)h(nrutil,)f(ONLY)i(:)g(arth,asser)o(t_e)o(q,s)o(wa)o(p)0
1314 y(USE)g(nr,)f(ONLY)g(:)i(ran1)0 1352 y(IMPLICIT)d(NONE)0
1389 y(INTEGER\(I4)o(B\),)f(DIMENSION\()o(:\),)g(INTENT\(INO)o(UT\))g(::)j
(iorder)0 1426 y(REAL\(SP\),)d(DIMENSION\(:)o(\),)g(INTENT\(IN\))g(::)j(x,y)
58 1464 y Fn(This)c(algo)o(rithm)g(\014nds)g(the)f(sho)o(rtest)f(round-trip)j
(path)f(to)f Fl(N)k Fn(cities)d(whose)f(co)q(o)o(rdinates)f(a)o(re)i(in)g
(the)58 1501 y(length)d Fl(N)k Fn(a)o(rra)o(ys)c Fm(x)p Fn(,)g
Fm(y)p Fn(.)17 b(The)10 b(length)g Fl(N)k Fn(a)o(rra)o(y)d
Fm(iorder)c Fn(sp)q(eci\014es)i(the)h(o)o(rder)g(in)h(which)g(the)e(cities)h
(a)o(re)58 1539 y(visited.)18 b(On)12 b(input,)h(the)e(elements)g(of)g
Fm(iorder)f Fn(ma)o(y)i(b)q(e)g(set)f(to)g(any)h(p)q(ermutation)g(of)f(the)h
(numb)q(ers)58 1576 y Fg(1)6 b Fl(:)f(:)h(:)g(N)t Fn(.)17 b(This)c(routine)g
(will)h(return)f(the)g(b)q(est)f(alternative)h(path)h(it)f(can)g(\014nd.)0
1613 y Fo(INTEGER\(I4)o(B\),)h(DIMENSION\()o(6\))g(::)j(n)0
1651 y(INTEGER\(I4)o(B\))d(::)j(i1,i2,j,k,n)o(lim)o(it,)o(nc)o(ity)o(,nn)o
(,no)o(ver)o(,n)o(suc)o(c)0 1688 y(REAL\(SP\))e(::)i(de,harves)o(t,p)o(ath)o
(,t,)o(tfa)o(ct)o(r)0 1725 y(LOGICAL\(LG)o(T\))d(::)j(ans)0
1763 y(ncity=asse)o(rt_)o(eq\()o(siz)o(e\()o(x\),)o(siz)o(e\(y)o(\),s)o(iz)o
(e\(i)o(ord)o(er\))o(,'a)o(nn)o(eal)o('\))0 1800 y(nover=100*)o(nci)o(ty)347
b Fn(Maximum)9 b(numb)q(er)g(of)f(paths)g(tried)h(at)f(any)h(temp)q(erature,)
0 1837 y Fo(nlimit=10*)o(nci)o(ty)347 b Fn(and)12 b(of)g(successful)e(path)i
(changes)e(b)q(efo)o(re)h(continuing.)0 1875 y Fo(tfactr=0.9)o(_sp)382
b Fn(Annealing)17 b(schedule:)g Fo(t)f Fn(is)g(reduced)g(b)o(y)h(this)f
(facto)o(r)g(on)675 1912 y(each)e(step.)-827 b Fo(t=0.5_sp)0
1949 y(path=sum\(a)o(len)o(_v\()o(x\(i)o(or)o(der)o(\(1:)o(nci)o(ty-)o(1\))o
(\),x)o(\(io)o(rde)o(r\(2)o(:n)o(cit)o(y\)\))o(,&)66 1987 y(y\(iorder\(1:)o
(nci)o(ty-)o(1\)\))o(,y\()o(io)o(rde)o(r\(2)o(:nc)o(ity)o(\)\))o(\)\))122
b Fn(Calculate)12 b(initial)h(path)f(length.)0 2024 y Fo(i1=iorder\()o(nci)o
(ty\))509 b Fn(Close)17 b(the)g(lo)q(op)h(b)o(y)g(t)o(ying)g(path)g(ends)f
(to-)855 2062 y(gether.)-958 b Fo(i2=iorder\()o(1\))0 2099
y(path=path+)o(ale)o(n\(x)o(\(i1)o(\),)o(x\(i)o(2\),)o(y\(i)o(1\),)o(y\()o
(i2\))o(\))0 2136 y(do)17 b(j=1,100)616 b Fn(T)m(ry)13 b(up)f(to)g(100)f
(temp)q(erature)g(steps.)66 2174 y Fo(nsucc=0)66 2211 y(do)17
b(k=1,nover)133 2248 y(do)199 2286 y(call)f(ran1\(harvest)o(\))199
2323 y(n\(1\)=1+int\()o(nci)o(ty*)o(ha)o(rve)o(st\))271 b Fn(Cho)q(ose)6
b(b)q(eginning)j(of)e(segment)f Fl(:)g(:)g(:)199 2360 y Fo(call)16
b(ran1\(harvest)o(\))199 2398 y(n\(2\)=1+int\()o(\(nc)o(ity)o(-1)o(\)*h)o
(arv)o(est)o(\))201 b Fl(:)6 b(:)f(:)h Fn(and)13 b(end)f(of)g(segment.)199
2435 y Fo(if)17 b(\(n\(2\))f(>=)h(n\(1\)\))f(n\(2\)=n\(2\)+)o(1)199
2473 y(nn=1+mod\(\(n)o(\(1\))o(-n\()o(2\))o(+nc)o(ity)o(-1\))o(,nc)o(it)o
(y\))95 b(nn)9 b Fn(is)h(the)f(numb)q(er)i(of)e(cities)g(not)h(on)975
2510 y(the)i(segment.)-968 b Fo(if)17 b(\(nn)g(>=)g(3\))g(exit)133
2547 y(end)f(do)p eop
%%Page: 1220 20
bop 0 50 a Fk(1220)188 b Fj(Chapter)11 b(B10.)54 b(Minimization)11
b(or)g(Maximization)f(of)h(Functions)p 0 68 1395 2 v 0 143
a @beginspecial @setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 133 180 a Fo(call)16
b(ran1\(harve)o(st\))166 218 y Fn(Decide)e(whether)g(to)f(do)h(a)f(reversal)h
(o)o(r)g(a)f(transp)q(o)o(rt.)133 255 y Fo(if)k(\(harvest)e(<)i(0.5_sp\))e
(then)202 b Fn(Do)13 b(a)h(transp)q(o)o(rt.)199 293 y Fo(call)i
(ran1\(harvest)o(\))199 330 y(n\(3\)=n\(2\)+i)o(nt\()o(abs)o(\(n)o(n-2)o
(\)*h)o(arv)o(est)o(\)+)o(1)199 367 y(n\(3\)=1+mod\()o(n\(3)o(\)-1)o(,n)o
(cit)o(y\))169 b Fn(T)m(ransp)q(o)o(rt)8 b(to)g(a)h(lo)q(cation)f(not)g(on)h
(the)f(path.)199 405 y Fo(call)16 b(trncst\(x,y,i)o(or)o(der)o(,n,)o(de\))98
b Fn(Calculate)13 b(cost.)199 442 y Fo(call)j(metrop\(de,t,)o(an)o(s\))222
b Fn(Consult)12 b(the)h(o)o(racle.)199 479 y Fo(if)k(\(ans\))f(then)266
517 y(nsucc=nsu)o(cc+)o(1)266 554 y(path=path)o(+de)266 591
y(call)g(trnspt\(ior)o(der)o(,n\))155 b Fn(Ca)o(rry)13 b(out)f(the)g(transp)q
(o)o(rt.)199 629 y Fo(end)17 b(if)133 666 y(else)590 b Fn(Do)13
b(a)g(path)g(reversal.)199 703 y Fo(call)j(revcst\(x,y,i)o(or)o(der)o(,n,)o
(de\))98 b Fn(Calculate)13 b(cost.)199 741 y Fo(call)j(metrop\(de,t,)o(an)o
(s\))222 b Fn(Consult)12 b(the)h(o)o(racle.)199 778 y Fo(if)k(\(ans\))f(then)
266 816 y(nsucc=nsu)o(cc+)o(1)266 853 y(path=path)o(+de)266
890 y(call)g(revers\(ior)o(der)o(,n\))155 b Fn(Ca)o(rry)13
b(out)f(the)g(reversal.)199 928 y Fo(end)17 b(if)133 965 y(end)f(if)133
1002 y(if)h(\(nsucc)e(>=)i(nlimit\))e(exit)220 b Fn(Finish)11
b(ea)o(rly)g(if)g(w)o(e)f(have)g(enough)g(successful)855 1040
y(changes.)-916 b Fo(end)17 b(do)66 1077 y(write\(*,*\))66
1114 y(write\(*,*\))d('T)j(=',t,')f(Path)g(Length)g(=',path)66
1152 y(write\(*,*\))e('Successful)g(Moves:)i(',nsucc)66 1189
y(t=t*tfactr)549 b Fn(Annealing)13 b(schedule.)66 1227 y Fo(if)k(\(nsucc)f
(==)h(0\))g(RETURN)338 b Fn(If)12 b(no)h(success,)d(w)o(e)i(a)o(re)g(done.)0
1264 y Fo(end)17 b(do)0 1301 y(CONTAINS)0 1355 y(FUNCTION)e(alen\(x1,x2)o(,y)
o(1,y)o(2\))0 1393 y(IMPLICIT)g(NONE)0 1430 y(REAL\(SP\),)f(INTENT\(IN\))g
(::)j(x1,x2,y1,y2)0 1467 y(REAL\(SP\))e(::)i(alen)58 1505 y
Fn(Computes)d(distance)g(b)q(et)o(w)o(een)g(t)o(w)o(o)h(cities.)0
1542 y Fo(alen=sqrt\()o(\(x2)o(-x1)o(\)**)o(2+)o(\(y2)o(-y1)o(\)**)o(2\))0
1579 y(END)i(FUNCTION)d(alen)0 1633 y(FUNCTION)h(alen_v\(x1,)o(x2)o(,y1)o
(,y2)o(\))0 1671 y(IMPLICIT)g(NONE)0 1708 y(REAL\(SP\),)f(DIMENSION\(:)o(\),)
g(INTENT\(IN\))g(::)j(x1,x2,y1,y2)0 1745 y(REAL\(SP\),)d(DIMENSION\(s)o(ize)o
(\(x1)o(\)\))g(::)j(alen_v)58 1783 y Fn(Computes)c(distances)h(b)q(et)o(w)o
(een)g(pairs)h(of)f(cities.)0 1820 y Fo(alen_v=sqr)o(t\(\()o(x2-)o(x1\))o(**)
o(2+\()o(y2-)o(y1\))o(**2)o(\))0 1857 y(END)j(FUNCTION)d(alen_v)0
1911 y(SUBROUTINE)g(metrop\(de,)o(t,a)o(ns\))0 1949 y(IMPLICIT)h(NONE)0
1986 y(REAL\(SP\),)f(INTENT\(IN\))g(::)j(de,t)0 2024 y(LOGICAL\(LG)o(T\),)d
(INTENT\(OUT)o(\))h(::)i(ans)58 2061 y Fn(Metrop)q(olis)10
b(algo)o(rithm.)18 b Fm(ans)10 b Fn(is)h(a)g(logical)h(va)o(riable)g(that)f
(issues)f(a)h(verdict)g(on)g(whether)g(to)g(accept)f(a)58 2098
y(recon\014guration)g(that)g(leads)h(to)f(a)h(change)f Fm(de)g
Fn(in)h(the)f(objective)h(function.)17 b(If)11 b Fm(de<0)n
Fn(,)g Fm(ans=.true)o(.)m Fn(,)58 2136 y(while)h(if)e Fm(de>0)o
Fn(,)g Fm(ans)g Fn(is)h(only)g Fm(.true.)d Fn(with)j(p)o(robabilit)o(y)h
Fm(exp\(-de/t\))l Fn(,)f(where)f Fm(t)h Fn(is)f(a)h(temp)q(erature)58
2173 y(determined)k(b)o(y)g(the)g(annealing)h(schedule.)0 2210
y Fo(call)g(ran1\(harves)o(t\))0 2248 y(ans=\(de)f(<)i(0.0\))g(.or.)f
(\(harvest)f(<)i(exp\(-de/t\))o(\))0 2285 y(END)g(SUBROUTIN)o(E)e(metrop)0
2339 y(SUBROUTINE)f(revcst\(x,y)o(,io)o(rde)o(r,n)o(,de)o(\))0
2376 y(IMPLICIT)h(NONE)0 2414 y(REAL\(SP\),)f(DIMENSION\(:)o(\),)g
(INTENT\(IN\))g(::)j(x,y)0 2451 y(INTEGER\(I4)o(B\),)d(DIMENSION\()o(:\),)g
(INTENT\(IN\))g(::)j(iorder)0 2488 y(INTEGER\(I4)o(B\),)d(DIMENSION\()o(:\),)
g(INTENT\(INO)o(UT\))g(::)j(n)0 2526 y(REAL\(SP\),)d(INTENT\(OUT\))g(::)j(de)
p eop
%%Page: 1221 21
bop 154 50 a Fj(Chapter)10 b(B10.)37 b(Minimization)11 b(or)g(Maximization)f
(of)h(Functions)188 b Fk(1221)p 0 68 1395 2 v 0 143 a @beginspecial
@setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 58 180 a Fn(This)15 b(sub)o(routine)g(returns)f
(the)g(value)i(of)e(the)g(cost)f(function)i(fo)o(r)f(a)h(p)o(rop)q(osed)f
(path)h(reversal.)i(The)58 218 y(a)o(rra)o(ys)10 b Fm(x)g Fn(and)h
Fm(y)e Fn(give)i(the)e(co)q(o)o(rdinates)g(of)h(these)f(cities.)17
b Fm(iorder)8 b Fn(holds)i(the)g(p)o(resent)f(itinera)o(ry)m(.)19
b(The)58 255 y(\014rst)10 b(t)o(w)o(o)f(values)i Fm(n\(1\))e
Fn(and)h Fm(n\(2\))f Fn(of)h(a)o(rra)o(y)g Fm(n)g Fn(give)h(the)f(sta)o
(rting)f(and)i(ending)g(cities)e(along)i(the)f(path)58 293
y(segment)j(which)i(is)f(to)g(b)q(e)g(reversed.)i(On)f(output,)f
Fm(de)g Fn(is)g(the)g(cost)e(of)i(making)h(the)f(reversal.)j(The)58
330 y(actual)d(reversal)g(is)h(not)f(p)q(erfo)o(rmed)f(b)o(y)i(this)g
(routine.)0 367 y Fo(INTEGER\(I4)o(B\))f(::)j(ncity)0 405 y(REAL\(SP\),)d
(DIMENSION\(4)o(\))h(::)i(xx,yy)0 442 y(ncity=size)o(\(x\))0
479 y(n\(3\)=1+mod)o(\(\(n)o(\(1\))o(+nc)o(it)o(y-2)o(\),n)o(cit)o(y\))167
b Fn(Find)14 b(the)e(cit)o(y)h(b)q(efo)o(re)e Fo(n\(1\))h Fl(:)5
b(:)h(:)0 517 y Fo(n\(4\)=1+mod)o(\(n\()o(2\),)o(nci)o(ty)o(\))344
b Fl(:)6 b(:)f(:)h Fn(and)13 b(the)g(cit)o(y)g(after)e Fo(n\(2\))o
Fn(.)0 554 y Fo(xx\(1:4\)=x\()o(ior)o(der)o(\(n\()o(1:)o(4\)\))o(\))291
b Fn(Find)10 b(co)q(o)o(rdinates)e(fo)o(r)g(the)h(four)f(cities)h(involved.)0
591 y Fo(yy\(1:4\)=y\()o(ior)o(der)o(\(n\()o(1:)o(4\)\))o(\))0
629 y(de=-alen\(x)o(x\(1)o(\),x)o(x\(3)o(\),)o(yy\()o(1\),)o(yy\()o(3\)\))o
(&)132 b Fn(Calculate)12 b(cost)f(of)g(disconnecting)h(the)g(segment)795
666 y(at)d(b)q(oth)h(ends)f(and)h(reconnecting)f(in)h(the)g(op-)795
703 y(p)q(osite)j(o)o(rder.)66 666 y Fo(-alen\(xx\(2\))o(,xx)o(\(4\))o(,yy)o
(\(2\))o(,y)o(y\(4)o(\)\)&)66 703 y(+alen\(xx\(1\))o(,xx)o(\(4\))o(,yy)o
(\(1\))o(,y)o(y\(4)o(\)\)&)66 741 y(+alen\(xx\(2\))o(,xx)o(\(3\))o(,yy)o
(\(2\))o(,y)o(y\(3)o(\)\))0 778 y(END)k(SUBROUTIN)o(E)e(revcst)0
832 y(SUBROUTINE)f(revers\(ior)o(der)o(,n\))0 870 y(IMPLICIT)h(NONE)0
907 y(INTEGER\(I4)o(B\),)f(DIMENSION\()o(:\),)g(INTENT\(INO)o(UT\))g(::)j
(iorder)0 944 y(INTEGER\(I4)o(B\),)d(DIMENSION\()o(:\),)g(INTENT\(IN\))g(::)j
(n)58 982 y Fn(This)11 b(routine)g(p)q(erfo)o(rms)e(a)i(path)f(segment)f
(reversal.)17 b Fm(iorder)9 b Fn(is)h(an)h(input)g(a)o(rra)o(y)g(giving)g
(the)g(p)o(resent)58 1019 y(itinera)o(ry)m(.)18 b(The)d(vecto)o(r)e
Fm(n)i Fn(has)f(as)g(its)g(\014rst)g(four)g(elements)f(the)h(\014rst)g(and)h
(last)f(cities)g Fm(n\(1\))n Fn(,)h Fm(n\(2\))58 1056 y Fn(of)e(the)g(path)h
(segment)e(to)h(b)q(e)h(reversed,)f(and)h(the)f(t)o(w)o(o)g(cities)g
Fm(n\(3\))g Fn(and)h Fm(n\(4\))e Fn(that)h(immediately)58 1094
y(p)o(recede)i(and)h(follo)o(w)g(this)g(segment.)g Fm(n\(3\))e
Fn(and)i Fm(n\(4\))e Fn(a)o(re)i(found)f(b)o(y)i(sub)o(routine)e
Fm(revcst)n Fn(.)i(On)58 1131 y(output,)12 b Fm(iorder)f Fn(contains)h(the)g
(segment)f(from)h Fm(n\(1\))f Fn(to)h Fm(n\(2\))f Fn(in)i(reversed)f(o)o
(rder.)0 1168 y Fo(INTEGER\(I4)o(B\))i(::)j(j,k,l,nn,nc)o(ity)0
1206 y(ncity=size)o(\(io)o(rde)o(r\))0 1243 y(nn=\(1+mod\()o(n\(2)o(\)-n)o
(\(1\))o(+n)o(cit)o(y,n)o(cit)o(y\)\))o(/2)114 b Fn(This)13
b(many)h(cities)e(must)g(b)q(e)h(sw)o(app)q(ed)g(to)f(e\013ect)795
1280 y(the)h(reversal.)-976 b Fo(do)17 b(j=1,nn)66 1318 y(k=1+mod\(\(n\()o
(1\)+)o(j-2)o(\),n)o(cit)o(y\))224 b Fn(Sta)o(rt)13 b(at)h(the)g(ends)g(of)g
(the)g(segment)f(and)i(sw)o(ap)795 1355 y(pairs)h(of)f(cities,)i(moving)f(to)
o(w)o(a)o(rd)g(the)f(cen-)795 1393 y(ter.)66 1355 y Fo(l=1+mod\(\(n\()o(2\)-)
o(j+n)o(cit)o(y\),)o(nc)o(ity)o(\))66 1393 y(call)i(swap\(iord)o(er\()o(k\),)
o(ior)o(de)o(r\(l)o(\)\))0 1430 y(end)g(do)0 1467 y(END)g(SUBROUTIN)o(E)e
(revers)0 1521 y(SUBROUTINE)f(trncst\(x,y)o(,io)o(rde)o(r,n)o(,de)o(\))0
1559 y(IMPLICIT)h(NONE)0 1596 y(REAL\(SP\),)f(DIMENSION\(:)o(\),)g
(INTENT\(IN\))g(::)j(x,y)0 1633 y(INTEGER\(I4)o(B\),)d(DIMENSION\()o(:\),)g
(INTENT\(IN\))g(::)j(iorder)0 1671 y(INTEGER\(I4)o(B\),)d(DIMENSION\()o(:\),)
g(INTENT\(INO)o(UT\))g(::)j(n)0 1708 y(REAL\(SP\),)d(INTENT\(OUT\))g(::)j(de)
58 1745 y Fn(This)9 b(sub)o(routine)g(returns)f(the)g(value)i(of)e(the)g
(cost)f(function)i(fo)o(r)f(a)h(p)o(rop)q(osed)f(path)h(segment)e(transp)q(o)
o(rt.)58 1783 y(Arra)o(ys)13 b Fm(x)g Fn(and)h Fm(y)f Fn(give)g(the)g(cit)o
(y)h(co)q(o)o(rdinates.)i Fm(iorder)11 b Fn(is)i(an)h(a)o(rra)o(y)g(giving)g
(the)f(p)o(resent)f(itinera)o(ry)m(.)58 1820 y(The)j(\014rst)f(three)g
(elements)g(of)g(a)o(rra)o(y)h Fm(n)g Fn(give)g(the)f(sta)o(rting)g(and)h
(ending)h(cities)e(of)g(the)h(path)g(to)f(b)q(e)58 1857 y(transp)q(o)o(rted,)
d(and)i(the)f(p)q(oint)g(among)g(the)g(remaining)h(cities)f(after)f(which)i
(it)f(is)h(to)e(b)q(e)i(inserted.)j(On)58 1895 y(output,)10
b Fm(de)g Fn(is)h(the)f(cost)f(of)h(the)g(change.)17 b(The)10
b(actual)h(transp)q(o)o(rt)e(is)i(not)f(p)q(erfo)o(rmed)g(b)o(y)h(this)f
(routine.)0 1932 y Fo(INTEGER\(I4)o(B\))k(::)j(ncity)0 1970
y(REAL\(SP\),)d(DIMENSION\(6)o(\))h(::)i(xx,yy)0 2007 y(ncity=size)o(\(x\))0
2044 y(n\(4\)=1+mod)o(\(n\()o(3\),)o(nci)o(ty)o(\))344 b Fn(Find)14
b(the)e(cit)o(y)g(follo)o(wing)h Fo(n\(3\))e Fl(:)6 b(:)f(:)0
2082 y Fo(n\(5\)=1+mod)o(\(\(n)o(\(1\))o(+nc)o(it)o(y-2)o(\),n)o(cit)o(y\))
167 b Fl(:)6 b(:)f(:)h Fn(and)13 b(the)f(one)g(p)o(receding)g
Fo(n\(1\))e Fl(:)c(:)g(:)0 2119 y Fo(n\(6\)=1+mod)o(\(n\()o(2\),)o(nci)o(ty)o
(\))344 b Fl(:)6 b(:)f(:)h Fn(and)13 b(the)f(one)g(follo)o(wing)h
Fo(n\(2\))o Fn(.)0 2156 y Fo(xx\(1:6\)=x\()o(ior)o(der)o(\(n\()o(1:)o(6\)\))o
(\))291 b Fn(Determine)16 b(co)q(o)o(rdinates)f(fo)o(r)g(the)h(six)g(cities)f
(in-)795 2194 y(volved.)-897 b Fo(yy\(1:6\)=y\()o(ior)o(der)o(\(n\()o(1:)o
(6\)\))o(\))0 2231 y(de=-alen\(x)o(x\(2)o(\),x)o(x\(6)o(\),)o(yy\()o(2\),)o
(yy\()o(6\)\))o(&)132 b Fn(Calculate)11 b(the)h(cost)e(of)h(disconnecting)g
(the)g(path)795 2268 y(segment)i(from)h Fo(n\(1\))f Fn(to)h
Fo(n\(2\))o Fn(,)h(op)q(ening)g(a)795 2306 y(space)c(b)q(et)o(w)o(een)h
Fo(n\(3\))f Fn(and)i Fo(n\(4\))o Fn(,)f(connect-)795 2343 y(ing)i(the)g
(segment)f(in)h(the)g(space,)g(and)g(con-)795 2381 y(necting)e
Fo(n\(5\))g Fn(to)g Fo(n\(6\))o Fn(.)66 2268 y Fo(-alen\(xx\(1\))o(,xx)o
(\(5\))o(,yy)o(\(1\))o(,y)o(y\(5)o(\)\)&)66 2306 y(-alen\(xx\(3\))o(,xx)o
(\(4\))o(,yy)o(\(3\))o(,y)o(y\(4)o(\)\)&)66 2343 y(+alen\(xx\(1\))o(,xx)o
(\(3\))o(,yy)o(\(1\))o(,y)o(y\(3)o(\)\)&)66 2381 y(+alen\(xx\(2\))o(,xx)o
(\(4\))o(,yy)o(\(2\))o(,y)o(y\(4)o(\)\)&)66 2418 y(+alen\(xx\(5\))o(,xx)o
(\(6\))o(,yy)o(\(5\))o(,y)o(y\(6)o(\)\))0 2455 y(END)17 b(SUBROUTIN)o(E)e
(trncst)0 2509 y(SUBROUTINE)f(trnspt\(ior)o(der)o(,n\))0 2547
y(IMPLICIT)h(NONE)p eop
%%Page: 1222 22
bop 0 50 a Fk(1222)188 b Fj(Chapter)11 b(B10.)54 b(Minimization)11
b(or)g(Maximization)f(of)h(Functions)p 0 68 1395 2 v 0 143
a @beginspecial @setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 37 x Fo(INTEGER\(I4)o(B\),)j
(DIMENSION\()o(:\),)g(INTENT\(INO)o(UT\))g(::)j(iorder)0 218
y(INTEGER\(I4)o(B\),)d(DIMENSION\()o(:\),)g(INTENT\(IN\))g(::)j(n)58
255 y Fn(This)f(routine)g(do)q(es)f(the)g(actual)h(path)f(transp)q(o)o(rt,)h
(once)f Fm(metrop)e Fn(has)j(app)o(roved.)i Fm(iorder)13 b
Fn(is)j(an)58 293 y(input)e(a)o(rra)o(y)g(giving)g(the)f(p)o(resent)g
(itinera)o(ry)m(.)18 b(The)13 b(a)o(rra)o(y)h Fm(n)f Fn(has)g(as)g(its)g(six)
h(elements)e(the)h(b)q(eginning)58 330 y Fm(n\(1\))h Fn(and)i(end)g
Fm(n\(2\))e Fn(of)h(the)g(path)h(to)f(b)q(e)g(transp)q(o)o(rted,)h(the)f
(adjacent)g(cities)g Fm(n\(3\))f Fn(and)i Fm(n\(4\))58 367
y Fn(b)q(et)o(w)o(een)d(which)i(the)e(path)h(is)g(to)f(b)q(e)g(placed,)i(and)
f(the)f(cities)g Fm(n\(5\))g Fn(and)h Fm(n\(6\))e Fn(that)h(p)o(recede)g(and)
58 405 y(follo)o(w)f(the)f(path.)18 b Fm(n\(4\))n Fn(,)12 b
Fm(n\(5\))n Fn(,)g(and)g Fm(n\(6\))e Fn(a)o(re)h(calculated)h(b)o(y)g(sub)o
(routine)g Fm(trncst)n Fn(.)17 b(On)12 b(output,)58 442 y Fm(iorder)f
Fn(is)i(mo)q(di\014ed)g(to)g(re\015ect)f(the)h(movement)f(of)h(the)g(path)g
(segment.)0 479 y Fo(INTEGER\(I4)o(B\))h(::)j(m1,m2,m3,nn)o(,nc)o(ity)0
517 y(INTEGER\(I4)o(B\),)d(DIMENSION\()o(siz)o(e\(i)o(ord)o(er)o(\)\))g(::)j
(jorder)0 554 y(ncity=size)o(\(io)o(rde)o(r\))0 591 y(m1=1+mod\(\()o(n\(2)o
(\)-n)o(\(1\))o(+n)o(cit)o(y\),)o(nci)o(ty\))149 b Fn(Find)11
b(numb)q(er)e(of)g(cities)g(from)g Fo(n\(1\))f Fn(to)h Fo(n\(2\))f
Fl(:)e(:)f(:)0 629 y Fo(m2=1+mod\(\()o(n\(5)o(\)-n)o(\(4\))o(+n)o(cit)o(y\),)
o(nci)o(ty\))149 b Fl(:)6 b(:)f(:)h Fn(and)13 b(the)e(numb)q(er)i(from)e
Fo(n\(4\))g Fn(to)g Fo(n\(5\))0 666 y(m3=1+mod\(\()o(n\(3)o(\)-n)o(\(6\))o
(+n)o(cit)o(y\),)o(nci)o(ty\))149 b Fl(:)6 b(:)f(:)h Fn(and)12
b(the)g(numb)q(er)g(from)g Fo(n\(6\))f Fn(to)g Fo(n\(3\))n
Fn(.)0 703 y Fo(jorder\(1:m)o(1\)=)o(ior)o(der)o(\(1)o(+mo)o(d\(\()o(art)o
(h\(1)o(,1)o(,m1)o(\)+n)o(\(1\))o(-2\))o(,n)o(cit)o(y\)\))61
b Fn(Cop)o(y)8 b(the)f(chosen)g(segment.)0 741 y Fo(nn=m1)0
778 y(jorder\(nn+)o(1:n)o(n+m)o(2\)=)o(io)o(rde)o(r\(1)o(+mo)o(d\(\()o(ar)o
(th\()o(1,1)o(,m2)o(\)+n)o(\(4)o(\)-2)o(\),n)o(cit)o(y\)\))33
816 y Fn(Then)15 b(cop)o(y)g(the)f(segment)f(from)h Fo(n\(4\))f
Fn(to)h Fo(n\(5\))o Fn(.)0 853 y Fo(nn=nn+m2)0 890 y(jorder\(nn+)o(1:n)o(n+m)
o(3\)=)o(io)o(rde)o(r\(1)o(+mo)o(d\(\()o(ar)o(th\()o(1,1)o(,m3)o(\)+n)o(\(6)o
(\)-2)o(\),n)o(cit)o(y\)\))33 928 y Fn(Finally)m(,)k(the)c(segment)f(from)i
Fo(n\(6\))e Fn(to)h Fo(n\(3\))o Fn(.)0 965 y Fo(iorder\(1:n)o(cit)o(y\)=)o
(jor)o(de)o(r\(1)o(:nc)o(ity)o(\))185 b Fn(Cop)o(y)12 b Fo(jorder)e
Fn(back)j(into)g Fo(iorder)m Fn(.)0 1002 y Fo(END)k(SUBROUTIN)o(E)e(trnspt)0
1040 y(END)i(SUBROUTIN)o(E)e(anneal)574 1190 y Fh(?)92 b(?)g(?)0
1314 y Fo(SUBROUTINE)14 b(amebsa\(p,y)o(,pb)o(,yb)o(,ft)o(ol,)o(fu)o(nc,)o
(ite)o(r,t)o(emp)o(tr)o(\))0 1352 y(USE)j(nrtype;)e(USE)h(nrutil,)f(ONLY)i(:)
g(assert_eq,)o(ima)o(xlo)o(c,)o(imi)o(nlo)o(c,s)o(wap)0 1389
y(USE)g(nr,)f(ONLY)g(:)i(ran1)0 1426 y(IMPLICIT)d(NONE)0 1464
y(INTEGER\(I4)o(B\),)f(INTENT\(INO)o(UT\))g(::)j(iter)0 1501
y(REAL\(SP\),)d(INTENT\(INOU)o(T\))g(::)j(yb)0 1539 y(REAL\(SP\),)d
(INTENT\(IN\))g(::)j(ftol,temptr)0 1576 y(REAL\(SP\),)d(DIMENSION\(:)o(\),)g
(INTENT\(INOU)o(T\))g(::)j(y,pb)0 1613 y(REAL\(SP\),)d(DIMENSION\(:)o(,:\))o
(,)h(INTENT\(IN)o(OUT)o(\))g(::)i(p)0 1651 y(INTERFACE)66 1688
y(FUNCTION)e(func\(x\))66 1725 y(USE)i(nrtype)66 1763 y(IMPLICIT)e(NONE)66
1800 y(REAL\(SP\),)g(DIMENSION\()o(:\),)f(INTENT\(IN\))g(::)j(x)66
1837 y(REAL\(SP\))e(::)i(func)66 1875 y(END)g(FUNCTION)e(func)0
1912 y(END)i(INTERFACE)0 1949 y(INTEGER\(I4)o(B\),)d(PARAMETER)g(::)j
(NMAX=200)58 1987 y Fn(Minimization)10 b(of)e(the)g Fl(N)t
Fn(-dimensional)h(function)f Fm(func)f Fn(b)o(y)i(simulated)g(annealing)g
(combined)g(with)g(the)58 2024 y(do)o(wnhill)i(simplex)g(metho)q(d)e(of)g
(Nelder)g(and)h(Mead.)17 b(The)10 b Fg(\()p Fl(N)d Fg(+)t(1\))t
Ff(\002)t Fl(N)12 b Fn(matrix)e Fm(p)f Fn(is)h(input.)18 b(Its)9
b Fl(N)e Fg(+)t(1)58 2062 y Fn(ro)o(ws)12 b(a)o(re)g Fl(N)t
Fn(-dimensional)h(vecto)o(rs)e(that)i(a)o(re)f(the)g(vertices)g(of)g(the)h
(sta)o(rting)f(simplex.)18 b(Also)11 b(input)j(is)58 2099 y(the)9
b(vecto)o(r)f Fm(y)h Fn(of)g(length)g Fl(N)e Fg(+)s(1)p Fn(,)i(whose)f(comp)q
(onents)g(must)h(b)q(e)g(p)o(reinitialized)j(to)c(the)h(values)h(of)e
Fm(func)58 2136 y Fn(evaluated)h(at)g(the)g Fl(N)d Fg(+)r(1)j
Fn(vertices)g(\(ro)o(ws\))e(of)i Fm(p)o Fn(;)h Fm(ftol)o Fn(,)f(the)g
(fractional)g(convergence)e(tolerance)h(to)h(b)q(e)58 2174
y(achieved)k(in)g(the)f(function)g(value)h(fo)o(r)f(an)h(ea)o(rly)g(return;)f
Fm(iter)o Fn(,)g(and)h Fm(temptr)n Fn(.)k(The)c(routine)f(mak)o(es)58
2211 y Fm(iter)f Fn(function)g(evaluations)h(at)g(an)g(annealing)h(temp)q
(erature)e Fm(temptr)n Fn(,)g(then)h(returns.)17 b(Y)m(ou)12
b(should)58 2248 y(then)d(decrease)e Fm(temptr)f Fn(acco)o(rding)j(to)f(y)o
(our)h(annealing)g(schedule,)g(reset)e Fm(iter)o Fn(,)i(and)g(call)g(the)g
(routine)58 2286 y(again)h(\(leaving)g(other)g(a)o(rguments)f(unaltered)h(b)q
(et)o(w)o(een)f(calls\).)17 b(If)10 b Fm(iter)e Fn(is)i(returned)g(with)g(a)g
(p)q(ositive)58 2323 y(value,)i(then)f(ea)o(rly)h(convergence)e(and)h(return)
h(o)q(ccurred.)k(If)11 b(y)o(ou)h(initialize)h Fm(yb)e Fn(to)f(a)i(very)f(la)
o(rge)g(value)58 2360 y(on)i(the)g(\014rst)f(call,)i(then)f
Fm(yb)f Fn(and)h Fm(pb)g Fn(\(an)f(a)o(rra)o(y)i(of)e(length)h
Fl(N)t Fn(\))g(will)h(subsequently)f(return)g(the)g(b)q(est)58
2398 y(function)f(value)g(and)g(p)q(oint)h(ever)e(encountered)g(\(even)g(if)h
(it)g(is)g(no)g(longer)f(a)h(p)q(oint)g(in)h(the)e(simplex\).)0
2435 y Fo(INTEGER\(I4)o(B\))j(::)j(ihi,ndim)309 b Fn(Global)14
b(va)o(riables.)0 2473 y Fo(REAL\(SP\))h(::)i(yhi)0 2510 y(REAL\(SP\),)d
(DIMENSION\(s)o(ize)o(\(p,)o(2\)\))g(::)j(psum)0 2547 y(call)f(amebsa_priv)o
(ate)p eop
%%Page: 1223 23
bop 154 50 a Fj(Chapter)10 b(B10.)37 b(Minimization)11 b(or)g(Maximization)f
(of)h(Functions)188 b Fk(1223)p 0 68 1395 2 v 0 143 a @beginspecial
@setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 37 x Fo(CONTAINS)0 234 y(SUBROUTINE)14
b(amebsa_pri)o(vat)o(e)0 272 y(INTEGER\(I4)o(B\))g(::)j(i,ilo,inhi)0
309 y(REAL\(SP\))e(::)i(rtol,ylo,)o(ynh)o(i,y)o(sav)o(e,y)o(tr)o(y)0
346 y(REAL\(SP\),)d(DIMENSION\(s)o(ize)o(\(y\))o(\))h(::)i(yt,harves)o(t)0
384 y(ndim=asser)o(t_e)o(q\(s)o(ize)o(\(p)o(,2\))o(,si)o(ze\()o(p,1)o(\)-)o
(1,s)o(ize)o(\(y\))o(-1,)o(si)o(ze\()o(pb\))o(,'a)o(meb)o(sa)o('\))0
421 y(psum\(:\)=su)o(m\(p)o(\(:,)o(:\),)o(di)o(m=1)o(\))0 459
y(do)699 b Fn(Iteration)13 b(lo)q(op.)66 496 y Fo(call)k(ran1\(harv)o(est)o
(\))66 533 y(yt\(:\)=y\(:\)-)o(tem)o(ptr)o(*lo)o(g\(h)o(ar)o(ves)o(t\))100
571 y Fn(Whenever)12 b(w)o(e)h(\\lo)q(ok)f(at")g(a)h(vertex,)f(it)h(gets)e(a)
i(random)g(thermal)g(\015uctuation.)66 608 y Fo(ilo=iminloc)o(\(yt)o(\(:\))o
(\))348 b Fn(Determine)8 b(which)h(p)q(oint)g(is)f(the)g(highest)g(\(w)o(o)o
(rst\),)795 645 y(next-highest,)j(and)i(lo)o(w)o(est)e(\(b)q(est\).)-1198
b Fo(ylo=yt\(ilo\))66 683 y(ihi=imaxloc)o(\(yt)o(\(:\))o(\))66
720 y(yhi=yt\(ihi\))66 757 y(yt\(ihi\)=ylo)66 795 y(inhi=imaxlo)o(c\(y)o
(t\(:)o(\)\))66 832 y(ynhi=yt\(inh)o(i\))66 870 y(rtol=2.0_sp)o(*ab)o(s\(y)o
(hi-)o(ylo)o(\)/)o(\(ab)o(s\(y)o(hi\))o(+ab)o(s\()o(ylo)o(\)\))100
907 y Fn(Compute)11 b(the)h(fractional)g(range)g(from)f(highest)h(to)g(lo)o
(w)o(est)f(and)i(return)f(if)h(satisfacto)o(ry)m(.)66 944 y
Fo(if)k(\(rtol)f(<)h(ftol)g(.or.)f(iter)g(<)h(0\))g(then)110
b Fn(If)12 b(returning,)g(put)h(b)q(est)e(p)q(oint)h(and)h(value)g(in)855
982 y(slot)g(1.)-816 b Fo(call)16 b(swap\(y\(1\),)o(y\(i)o(lo\))o(\))133
1019 y(call)g(swap\(p\(1,:)o(\),p)o(\(il)o(o,:)o(\)\))133 1056
y(RETURN)66 1094 y(end)h(if)100 1131 y Fn(Begin)11 b(a)h(new)h(iteration.)k
(First)12 b(extrap)q(olate)g(b)o(y)g(a)g(facto)o(r)f Ff(\000)p
Fg(1)i Fn(through)f(the)f(face)h(of)f(the)h(simplex)100 1168
y(across)f(from)h(the)g(high)h(p)q(oint,)g(i.e.,)f(re\015ect)g(the)g(simplex)
h(from)f(the)h(high)g(p)q(oint.)66 1206 y Fo(ytry=amotsa)o(\(-1)o(.0_)o(sp\))
66 1243 y(iter=iter-1)66 1280 y(if)k(\(ytry)f(<=)h(ylo\))f(then)297
b Fn(Gives)12 b(a)g(result)f(b)q(etter)h(than)g(the)g(b)q(est)f(p)q(oint,)h
(so)795 1318 y(try)g(an)g(additional)i(extrap)q(olation)e(b)o(y)g(a)g(fac-)
795 1355 y(to)o(r)h(of)g Fg(2)p Fn(.)133 1318 y Fo(ytry=amots)o(a\(2)o(.0)o
(_sp)o(\))133 1355 y(iter=iter-)o(1)66 1393 y(else)k(if)g(\(ytry)e(>=)i
(ynhi\))f(then)191 b Fn(The)9 b(re\015ected)g(p)q(oint)g(is)h(w)o(o)o(rse)e
(than)i(the)f(second-)795 1430 y(highest,)f(so)g(lo)q(ok)g(fo)o(r)g(an)g
(intermediate)h(lo)o(w)o(er)795 1467 y(p)q(oint,)g(i.e.,)g(do)f(a)g
(one-dimensional)h(contrac-)795 1505 y(tion.)133 1430 y Fo(ysave=yhi)133
1467 y(ytry=amots)o(a\(0)o(.5)o(_sp)o(\))133 1505 y(iter=iter-)o(1)133
1542 y(if)17 b(\(ytry)f(>=)h(ysave\))e(then)232 1579 y Fn(Can't)g(seem)g(to)g
(get)g(rid)h(of)f(that)g(high)h(p)q(oint.)i(Better)c(contract)g(a)o(round)i
(the)g(lo)o(w)o(est)232 1617 y(\(b)q(est\))f(p)q(oint.)199
1654 y Fo(p\(:,:\)=0.5_)o(sp*)o(\(p\()o(:,)o(:\)+)o(spr)o(ead)o(\(p\()o(il)o
(o,:)o(\),1)o(,si)o(ze\()o(p,)o(1\)\))o(\))199 1691 y(do)i(i=1,ndim+1)266
1729 y(if)g(\(i)g(/=)f(ilo\))h(y\(i\)=func)o(\(p\()o(i,:)o(\)\))199
1766 y(end)g(do)199 1804 y(iter=iter-n)o(dim)285 b Fn(Keep)11
b(track)h(of)g(function)g(evaluations.)199 1841 y Fo(psum\(:\)=sum)o(\(p\()o
(:,:)o(\),)o(dim)o(=1\))133 1878 y(end)k(if)66 1916 y(end)h(if)0
1953 y(end)g(do)0 1990 y(END)g(SUBROUTIN)o(E)e(amebsa_pr)o(iva)o(te)0
2044 y(FUNCTION)g(amotsa\(fac)o(\))0 2082 y(IMPLICIT)g(NONE)0
2119 y(REAL\(SP\),)f(INTENT\(IN\))g(::)j(fac)0 2156 y(REAL\(SP\))e(::)i
(amotsa)58 2194 y Fn(Extrap)q(olates)c(b)o(y)h(a)f(facto)o(r)g
Fm(fac)f Fn(through)h(the)g(face)g(of)g(the)g(simplex)h(across)e(from)h(the)g
(high)h(p)q(oint,)58 2231 y(tries)f(it,)h(and)g(replaces)e(the)i(high)g(p)q
(oint)f(if)h(the)f(new)g(p)q(oint)h(is)g(b)q(etter.)0 2268
y Fo(REAL\(SP\))h(::)i(fac1,fac2)o(,yf)o(lu,)o(ytr)o(y,h)o(ar)o(v)0
2306 y(REAL\(SP\),)d(DIMENSION\(s)o(ize)o(\(p,)o(2\)\))g(::)j(ptry)0
2343 y(fac1=\(1.0_)o(sp-)o(fac)o(\)/n)o(di)o(m)0 2381 y(fac2=fac1-)o(fac)0
2418 y(ptry\(:\)=ps)o(um\()o(:\)*)o(fac)o(1-)o(p\(i)o(hi,)o(:\)*)o(fac)o(2)0
2455 y(ytry=func\()o(ptr)o(y\))0 2493 y(if)g(\(ytry)f(<=)h(yb\))f(then)381
b Fn(Save)13 b(the)g(b)q(est-ever.)66 2530 y Fo(pb\(:\)=ptry\()o(:\))p
eop
%%Page: 1224 24
bop 0 50 a Fk(1224)193 b Fj(Chapter)10 b(B10.)52 b(Minimization)11
b(or)g(Maximization)f(of)g(Functions)p 0 68 1395 2 v 0 143
a @beginspecial @setspecial
 gsave 0.0 setgray 394 -72 translate -90 rotate /Helvetica findfont
7 scalefont setfont 0 0 moveto (Sample page from NUMERICAL RECIPES IN FORTRAN 90: The Art of PARALLEL Scientific Computing (ISBN 0-521-57439-0))
show 0 -8 moveto (Copyright (C) 1986-1996 by Cambridge University Press.
Programs Copyright (C) 1986-1996 by Numerical Recipes Software. ) show
0 -16 moveto (Permission is granted for internet users to make one paper copy for their own personal use. Further reproduction, or any copying of machine-)
show 0 -24 moveto (readable files (including this one) to any server
computer, is strictly prohibited. To order Numerical Recipes books,
diskettes, or CDROMs) show 0 -32 moveto (visit website http://www.nr.com or call 1-800-872-7423 (North America only),
or send email to trade@cup.cam.ac.uk (outside North America).) show
grestore 
@endspecial 66 180 a Fo(yb=ytry)0
218 y(end)17 b(if)0 255 y(call)f(ran1\(harv\))0 293 y(yflu=ytry+)o(tem)o(ptr)
o(*lo)o(g\()o(har)o(v\))273 b Fn(W)o(e)8 b Fa(added)f Fn(a)h(thermal)h
(\015uctuation)f(to)g(all)h(the)f(cur-)795 330 y(rent)13 b(vertices,)f(but)h
(w)o(e)g Fa(subtract)f Fn(it)h(here,)g(so)795 367 y(as)h(to)g(give)g(the)g
(simplex)h(a)f(thermal)g(Bro)o(w-)795 405 y(nian)g(motion:)j(It)c
Fa(likes)f Fn(to)h(accept)f(any)h(sug-)795 442 y(gested)f(change.)0
330 y Fo(if)17 b(\(yflu)f(<)h(yhi\))f(then)66 367 y(y\(ihi\)=ytry)66
405 y(yhi=yflu)66 442 y(psum\(:\)=psu)o(m\(:)o(\)-p)o(\(ih)o(i,:)o(\)+)o(ptr)
o(y\(:)o(\))66 479 y(p\(ihi,:\)=pt)o(ry\()o(:\))0 517 y(end)h(if)0
554 y(amotsa=yfl)o(u)0 591 y(END)g(FUNCTION)d(amotsa)0 629
y(END)j(SUBROUTIN)o(E)e(amebsa)187 770 y @beginspecial @setspecial
 /oshow {true charpath gsave 1 setgray fill grestore stroke} def gsave
0.5 setgray -40 -20 translate .8 .8 scale /NewCenturySchlbk-Bold findfont
40 scalefont setfont 2 1 scale 0 0 moveto (f) show /Helvetica-Narrow
findfont 24 scalefont setfont 0.5 1 scale 23 1 moveto (90) show grestore

@endspecial Fk(See)g(the)f(discussion)g(of)g Fi(amoeba)f Fk(on)h(p.)h(1209)e
(for)h(why)g(the)g(routine)f(is)i(coded)187 820 y(this)k(way)m(.)p
eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
